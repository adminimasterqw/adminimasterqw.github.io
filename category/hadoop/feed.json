{
    "version": "https://jsonfeed.org/version/1",
    "title": "Andrésen • All posts by \"hadoop\" category",
    "description": "",
    "home_page_url": "https://methiony.work",
    "items": [
        {
            "id": "https://methiony.work/2020/11/26/Platform-construction/Hadoop/course-2/Hadoop%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/",
            "url": "https://methiony.work/2020/11/26/Platform-construction/Hadoop/course-2/Hadoop%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/",
            "title": "Hadoop高可用集群搭建",
            "date_published": "2020-11-26T07:42:16.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hadoop高可用集群搭建\"><a class=\"anchor\" href=\"#hadoop高可用集群搭建\">#</a> Hadoop 高可用集群搭建</h1>\n<h2 id=\"1-环境准备\"><a class=\"anchor\" href=\"#1-环境准备\">#</a> 1、环境准备</h2>\n<p>用其他工具将 hadoop-2.6.0、zookeeper-3.4.5、jdk1.8.0_271 放入 node01 主机 /usr/local/src 目录下</p>\n<h3 id=\"主机配置环境如下表\"><a class=\"anchor\" href=\"#主机配置环境如下表\">#</a> 主机配置环境如下表</h3>\n<table>\n<thead>\n<tr>\n<th>主机名</th>\n<th>IP</th>\n<th>系统</th>\n<th>软件版本</th>\n<th>安装目录</th>\n<th>数据目录</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>node01</td>\n<td>192.168.2.131</td>\n<td>Centos 7</td>\n<td>hadoop-2.6.0、jdk1.8、zookeeper-3.4.5</td>\n<td>/usr/local/src/hadoop</td>\n<td>/data/hadoop</td>\n</tr>\n<tr>\n<td>node02</td>\n<td>192.168.2.132</td>\n<td>Centos 7</td>\n<td>hadoop-2.6.0、jdk1.8、zookeeper-3.4.5</td>\n<td>/usr/local/src/hadoop</td>\n<td>/data/hadoop</td>\n</tr>\n<tr>\n<td>node03</td>\n<td>192.168.2.133</td>\n<td>Centos 7</td>\n<td>hadoop-2.6.0、jdk1.8、zookeeper-3.4.5</td>\n<td>/usr/local/src/hadoop</td>\n<td>/data/hadoop</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"集群规划\"><a class=\"anchor\" href=\"#集群规划\">#</a> 集群规划</h3>\n<table>\n<thead>\n<tr>\n<th>node01</th>\n<th>node02</th>\n<th>node03</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>NodeManager</td>\n<td>NodeManager</td>\n<td>NodeManager</td>\n</tr>\n<tr>\n<td>NameNode</td>\n<td>NameNode</td>\n<td></td>\n</tr>\n<tr>\n<td>DataNode</td>\n<td>DataNode</td>\n<td>DataNode</td>\n</tr>\n<tr>\n<td>DFSZKFailoverController</td>\n<td>DFSZKFailoverController</td>\n<td></td>\n</tr>\n<tr>\n<td>JournalNode</td>\n<td>JournalNode</td>\n<td>JournalNode</td>\n</tr>\n<tr>\n<td>ResourceManager</td>\n<td>ResourceManager</td>\n<td></td>\n</tr>\n<tr>\n<td>QuorumPeerMain</td>\n<td>QuorumPeerMain</td>\n<td>QuorumPeerMain</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"配置主机名以及解析3台\"><a class=\"anchor\" href=\"#配置主机名以及解析3台\">#</a> 配置主机名以及解析（3 台）</h3>\n<p>配置主机名</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># hostnamectl set-hostname node01</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token comment\"># hostnamectl set-hostname node02</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token comment\"># hostnamectl set-hostname node03</span></pre></td></tr></table></figure><p>配置域名解析（主机配置就行）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># vi /etc/hosts</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>127<span class=\"token punctuation\">.</span>0<span class=\"token punctuation\">.</span>0<span class=\"token punctuation\">.</span>1   localhost localhost<span class=\"token punctuation\">.</span>localdomain localhost4 localhost4<span class=\"token punctuation\">.</span>localdomain4</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>::1         localhost localhost<span class=\"token punctuation\">.</span>localdomain localhost6 localhost6<span class=\"token punctuation\">.</span>localdomain6</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>131 node01</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>132 node02</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>133 node03</pre></td></tr></table></figure><h3 id=\"配置主机ip地址我的网卡是ifcfg-ens33\"><a class=\"anchor\" href=\"#配置主机ip地址我的网卡是ifcfg-ens33\">#</a> 配置主机 IP 地址（我的网卡是 ifcfg-ens33）</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># vi /etc/sysconfig/network-scripts/ifcfg-ens33</span></pre></td></tr></table></figure><p>node01 配置信息</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>BOOTPROTO=static</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ONBOOT=yes</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>文件末尾追加</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>IPADDR=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>131</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>GATEWAY=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>2</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>NETMASK=255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>0</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>DNS1=8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8</pre></td></tr></table></figure><p>node02 配置信息</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>BOOTPROTO=static</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ONBOOT=yes</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>文件末尾追加</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>IPADDR=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>132</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>GATEWAY=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>2</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>NETMASK=255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>0</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>DNS1=8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8</pre></td></tr></table></figure><p>node02 配置信息</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>BOOTPROTO=static</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ONBOOT=yes</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>文件末尾追加</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>IPADDR=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>133</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>GATEWAY=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>2</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>NETMASK=255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>0</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>DNS1=8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8</pre></td></tr></table></figure><h3 id=\"关闭防火墙\"><a class=\"anchor\" href=\"#关闭防火墙\">#</a> 关闭防火墙</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># systemctl stop firewalld.service </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#关闭防火墙</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># systemctl disable firewalld.service </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#禁止开机启动</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># firewall-cmd --state </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#查看防火墙状态</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>not running</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token comment\"># systemctl stop firewalld.service </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#关闭防火墙</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token comment\"># systemctl disable firewalld.service </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#禁止开机启动</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># firewall-cmd --state </span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">#查看防火墙状态</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>not running</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token comment\"># systemctl stop firewalld.service </span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">#关闭防火墙</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token comment\"># systemctl disable firewalld.service </span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#禁止开机启动</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># firewall-cmd --state </span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">#查看防火墙状态</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>not running</pre></td></tr></table></figure><h3 id=\"关闭selinux\"><a class=\"anchor\" href=\"#关闭selinux\">#</a> 关闭 selinux</h3>\n<p>进入到 /etc/selinux/config 文件，将 SELINUX=enforcing 改为 SELINUX=disabled。</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#  vi  /etc/selinux/config</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token comment\">#  vi  /etc/selinux/config</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token comment\">#  vi  /etc/selinux/config</span></pre></td></tr></table></figure><p>重启</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr></table></figure><h3 id=\"设置免密登录\"><a class=\"anchor\" href=\"#设置免密登录\">#</a> 设置免密登录</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#第一步，ssh-keygen -t rsa 生成密钥对</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh-keygen -t rsa</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 连续三次回车，即在本地生成了公钥和私钥，不设置密码，默认存储在～/.ssh 目录下</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#第二步，用 ssh-copy-id 拷贝将公钥复制到远程机器中</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh-copy-id -i .ssh/id_rsa.pub root@node01</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh-copy-id -i .ssh/id_rsa.pub  root@node02</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh-copy-id -i .ssh/id_rsa.pub  root@node03</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#第三步，测试免密码登陆</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh node02</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh node03</span></pre></td></tr></table></figure><h2 id=\"2-搭建环境\"><a class=\"anchor\" href=\"#2-搭建环境\">#</a> 2、搭建环境</h2>\n<h3 id=\"1-安装jdk已安装可以跳过\"><a class=\"anchor\" href=\"#1-安装jdk已安装可以跳过\">#</a> 1、安装 jdk（已安装可以跳过）</h3>\n<p>解压 jdk</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#tar -zxvf jdk-8u271-linux-x64.tar.gz</span></pre></td></tr></table></figure><p>配置环境变量 (/etc/profile)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#vi /etc/profile</span></pre></td></tr></table></figure><p>添加</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export JAVA_HOME=<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>jdk1<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0_271 </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export PATH=:<span class=\"token variable\">$JAVA_HOME</span><span class=\"token operator\">/</span>bin:<span class=\"token variable\">$PATH</span></pre></td></tr></table></figure><p>执行下面命令，让环境变量生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><p>验证 jdk 安装是否成功</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#java -version</span></pre></td></tr></table></figure><p>拷贝分发到 node1、node2</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#scp -r jdk1.8.0_271 node2:$PWD</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#scp -r jdk1.8.0_271 node3:$PWD</span></pre></td></tr></table></figure><h3 id=\"2-安装zookeeper已安装可以跳过\"><a class=\"anchor\" href=\"#2-安装zookeeper已安装可以跳过\">#</a> 2、安装 zookeeper（已安装可以跳过）</h3>\n<p>解压</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\"># tar -zxvf zookeeper-3.4.5.tar.gz</span></pre></td></tr></table></figure><p>配置修改</p>\n<p>/usr/local/src/zookeeper-3.4.5/conf 这个路径下的 zoo_sample.cfg 修改为 zoo.cfg (如果存在 zoo.cfg 文件则不需要拷贝 zoo_sample.cfg)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 conf]</span><span class=\"token comment\"># mv zoo_sample.cfg zoo.cfg</span></pre></td></tr></table></figure><p>打开 zoo.cfg 文件，修改 dataDir 路径，添加主机</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dataDir=<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>4<span class=\"token punctuation\">.</span>5<span class=\"token operator\">/</span>zkData</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>文件内容末尾添加内容</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>server<span class=\"token punctuation\">.</span>1=master:2888:3888</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>server<span class=\"token punctuation\">.</span>2=node1:2888:3888</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>server<span class=\"token punctuation\">.</span>3=node2:2888:3888</pre></td></tr></table></figure><p>在 /usr/local/src/zookeeper-3.4.5 / 这个目录上创建 zkData 文件夹</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 zookeeper-3.4.5]</span><span class=\"token comment\"># mkdir zkData</span></pre></td></tr></table></figure><p>在 /usr/local/src/zookeeper-3.4.5/zkData 这个目录上创建 myid 文件</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 zkData]</span><span class=\"token comment\"># touch myid</span></pre></td></tr></table></figure><p>编辑 myid 文件 (其他机器上修改对应的 server 的数字)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 zkData]</span><span class=\"token comment\"># vi myid</span></pre></td></tr></table></figure><pre><code>1\n</code></pre>\n<p>拷贝分发到 node1、node2</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\"># scp -r zookeeper-3.4.5 node2:$PWD</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\"># scp -r zookeeper-3.4.5 node3:$PWD</span></pre></td></tr></table></figure><p>修改 node02、node03 的 myid 文件</p>\n<h3 id=\"3-安装hadoop\"><a class=\"anchor\" href=\"#3-安装hadoop\">#</a> 3、安装 Hadoop</h3>\n<h4 id=\"1-解压hadoop\"><a class=\"anchor\" href=\"#1-解压hadoop\">#</a> 1、解压 hadoop</h4>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#tar -zxvf hadoop-2.6.0.tar.gz</span></pre></td></tr></table></figure><p>配置环境变量 (/etc/profile)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#vi /etc/profile</span></pre></td></tr></table></figure><p>添加</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export HADOOP_HOME=<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>2<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>0</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export PATH=:<span class=\"token variable\">$HADOOP_HOME</span><span class=\"token operator\">/</span>bin:<span class=\"token variable\">$HADOOP_HOME</span><span class=\"token operator\">/</span>sbin:<span class=\"token variable\">$PATH</span></pre></td></tr></table></figure><p>执行下面命令，让环境变量生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 /]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><h4 id=\"2-修改hadoop的配置文件\"><a class=\"anchor\" href=\"#2-修改hadoop的配置文件\">#</a> 2、修改 hadoop 的配置文件</h4>\n<p>进入需改文件的目录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01~]</span><span class=\"token comment\">#cd /usr/local/src/hadoop-2.6.0/etc/hadoop</span></pre></td></tr></table></figure><p>需要修改的文件</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>core<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\thadoop<span class=\"token operator\">-</span>env<span class=\"token punctuation\">.</span>sh\thdfs<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\t</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mapred<span class=\"token operator\">-</span>env<span class=\"token punctuation\">.</span>sh\tmapred<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\tyarn<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml</pre></td></tr></table></figure><h5 id=\"core-sitexml\"><a class=\"anchor\" href=\"#core-sitexml\">#</a> core-site.xml</h5>\n<p>修改 core-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 hdfs 连接地址，集群模式（高可用）--></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>fs.defaultFS<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>hdfs://cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 ZooKeeper 集群的地址和端口。注意，数量一定是奇数，且不少于三个节点 --></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>ha.zookeeper.quorum<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node01:2181,node02:2181,node03:2181<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"hdfs-sitexml\"><a class=\"anchor\" href=\"#hdfs-sitexml\">#</a> hdfs-site.xml</h5>\n<p>修改 hdfs-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 HDFS 副本的数量，不能超过机器节点数 --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.replication<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 为 namenode 集群定义一个 services name --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.nameservices<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- nameservice 包含哪些 namenode，为各个 namenode 起名 --></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.ha.namenodes.cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>nn01,nn02<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre> \t<span class=\"token comment\">&lt;!-- 名为 nn01 的 namenode 的 rpc 地址和端口号，rpc 用来和 datanode 通讯 --></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.rpc-address.cluster.nn01<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node01:9000<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre> \t<span class=\"token comment\">&lt;!-- 名为 nn01 的 namenode 的 http 地址和端口号，用来和 web 客户端通讯 --></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.http-address.cluster.nn01<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node01:50070<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre> \t<span class=\"token comment\">&lt;!-- 名为 nn02 的 namenode 的 rpc 地址和端口号，rpc 用来和 datanode 通讯 --></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.rpc-address.cluster.nn02<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node02:9000<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre> \t<span class=\"token comment\">&lt;!-- 名为 nn02 的 namenode 的 http 地址和端口号，用来和 web 客户端通讯 --></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.http-address.cluster.nn02<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node02:50070<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  \t<span class=\"token comment\">&lt;!-- namenode 间用于共享编辑日志的 journal 节点列表 --></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.shared.edits.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>qjournal://node01:8485;node02:8485;node03:8485/cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token comment\">&lt;!-- journalnode 上用于存放 edits 日志的目录 --></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.journalnode.edits.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/data/hadoop/journaldata<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  \t<span class=\"token comment\">&lt;!-- 指定该集群出现故障时，是否自动切换到另一台 namenode --></span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.ha.automatic-failover.enabled.cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 配置失败自动切换实现方式 --></span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.client.failover.proxy.provider.cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre> \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  \t<span class=\"token comment\">&lt;!-- 一旦需要 NameNode 切换，使用 ssh 方式进行操作 --></span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.ha.fencing.methods<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>sshfence(root:9431)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>  \t<span class=\"token comment\">&lt;!-- 如果使用 ssh 进行故障切换，使用 ssh 通信时用的密钥存储的位置 --></span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.ha.fencing.ssh.private-key-files<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/root/.ssh/id_rsa<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- connect-timeout 超时时间 --></span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.ha.fencing.ssh.connect-timeout<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>30000<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>   \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.name.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>   \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/data/hadoop/tmp/dfs/name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>   \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>   \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>   \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.data.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>   \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/data/hadoop/tmp/dfs/data<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>   \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"yarn-sitexml\"><a class=\"anchor\" href=\"#yarn-sitexml\">#</a> yarn-site.xml</h5>\n<p>修改 yarn-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 启用 Resource Manager HA 高可用性 --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.ha.enabled<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 resourcemanager 的名字 --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.cluster-id<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>yrc<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 使用了 2 个 resourcemanager, 分别指定 Resourcemanager 的地址 --></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.ha.rm-ids<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>rm1,rm2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 rm1 的地址 --></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.hostname.rm1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node01<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 rm2 的地址  --></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.hostname.rm2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node02<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 zookeeper 集群机器 --></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.zk-address<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node01:2181,node02:2181,node03:2181<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- NodeManager 上运行的附属服务，默认是 mapreduce_shuffle --></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.nodemanager.aux-services<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>mapreduce_shuffle<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"mapred-sitexml\"><a class=\"anchor\" href=\"#mapred-sitexml\">#</a> mapred-site.xml</h5>\n<p>修改 mapred-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 采用 yarn 作为 mapreduce 的资源调度框架 --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>mapreduce.framework.name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>yarn<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"hadoop-envsh\"><a class=\"anchor\" href=\"#hadoop-envsh\">#</a> <span class=\"exturl\" data-url=\"aHR0cDovL2hhZG9vcC1lbnYuc2g=\">hadoop-env.sh</span>、<span class=\"exturl\" data-url=\"aHR0cDovL21hcHJlZC1lbnYuc2g=\">mapred-env.sh</span></h5>\n<p>然后，<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1oYWRvb3AtZW52LXl1NnA1NHIwbmE1NjF0LnNo\">分别修改 hadoop-env.sh</span>、mapred-env.sh 文件，添加 Java 环境变量</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2hhZG9vcC1lbnYuc2g=\">hadoop-env.sh</span></p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># The java implementation to use.</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export JAVA_HOME=/usr/local/src/jdk1.8.0_271</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre># 指定hadoop相关的pid存放位置</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>export HADOOP_PID_DIR=/usr/local/src/hadoop-/pids</pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cDovL21hcHJlZC1lbnYuc2g=\">mapred-env.sh</span></p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># The java implementation to use.</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export JAVA_HOME=/usr/local/src/jdk1.8.0_271</pre></td></tr></table></figure><h5 id=\"配置hadoop环境变量\"><a class=\"anchor\" href=\"#配置hadoop环境变量\">#</a> 配置 hadoop 环境变量</h5>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#vi /etc/profile.d/hadoop.sh</span></pre></td></tr></table></figure><figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export HADOOP_HOME=/usr/local/src/hadoop-2.6.0</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export LD_LIBRARY_PATH=$HADOOP_HOME/lib/native</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>export HADOOP_COMMON_LIB_NATIVE_DIR=/usr/local/src/hadoop-2.6.0/lib/native</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>export HADOOP_OPTS=\"-Djava.library.path=/usr/local/src/hadoop-2.6.0/lib\"</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>export PATH=$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH</pre></td></tr></table></figure><figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#source /etc/profile.d/hadoop.sh</span></pre></td></tr></table></figure><p>修改集群配置文件 slaves（没有则新建）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#vi slaves</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>node01</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>node02</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>node03</pre></td></tr></table></figure><p>最后创建需要的相关目录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#mkdir -p data/hadoop</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#cd data/hadoop</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#mkdir journaldata</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#mkdir -p tmp/dfs/name</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#mkdir -p tmp/dfs/data</span></pre></td></tr></table></figure><h4 id=\"3-拷贝复制到其它机器\"><a class=\"anchor\" href=\"#3-拷贝复制到其它机器\">#</a> 3、拷贝复制到其它机器</h4>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r hadoop-2.6.0 node02:$PWD</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r hadoop-2.6.0 node03:$PWD</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r /etc/profile root@node02:/etc/profile</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r /etc/profile root@node03:/etc/profile</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r /etc/profile.d/hadoop.sh root@node02:/etc/profile.d/hadoop.sh</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r /etc/profile.d/hadoop.sh root@node03:/etc/profile.d/hadoop.sh</span></pre></td></tr></table></figure><p>生效环境变量</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop]</span><span class=\"token comment\">#source /etc/profile.d/hadoop.sh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop]</span><span class=\"token comment\">#source /etc/profile.d/hadoop.sh</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token namespace\">[root@node02 /]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@node03 /]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><h4 id=\"4-启动hadoop\"><a class=\"anchor\" href=\"#4-启动hadoop\">#</a> 4、启动 hadoop</h4>\n<h5 id=\"执行格式化操作\"><a class=\"anchor\" href=\"#执行格式化操作\">#</a> 执行格式化操作</h5>\n<p>1、启动 journalnode，三台机器都要这一步操作（仅第一次启动 hadoop 时，需要这一步操作，之后不再需要手动启动 journalnode）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#cd /usr/local/src/hadoop-2.6.0/sbin</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 sbin]</span><span class=\"token comment\">#sh hadoop-daemon.sh start journalnode</span></pre></td></tr></table></figure><p>2、在 node01 上执行格式化操作，格式化 namenode 和 zkfc</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#hdfs namenode -format</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#hdfs zkfc -formatZK</span></pre></td></tr></table></figure><p>3、namenode 主从信息同步，在 node02 节点上执行同步命令</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#bin/hdfs namenode -bootstrapStandby</span></pre></td></tr></table></figure><p>上述步骤完成后，接下来我们就可以启动 hadoop 了</p>\n<h5 id=\"启动命令\"><a class=\"anchor\" href=\"#启动命令\">#</a> 启动命令</h5>\n<p>在 node01 机器上执行下面的命令</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/start-all.sh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/hadoop-daemon.sh start zkfc</span></pre></td></tr></table></figure><p>在 node02 机器上执行下面的命令</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/yarn-daemon.sh start resourcemanager</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/hadoop-daemon.sh start zkfc</span></pre></td></tr></table></figure><h5 id=\"停止命令\"><a class=\"anchor\" href=\"#停止命令\">#</a> 停止命令</h5>\n<p>在 node01 机器上执行下面的命令</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/stop-all.sh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/hadoop-daemon.sh stop zkfc</span></pre></td></tr></table></figure><p>在 node02 机器上执行下面的命令</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/yarn-daemon.sh stop resourcemanager</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/hadoop-daemon.sh stop zkfc</span></pre></td></tr></table></figure><h5 id=\"查看每台节点的进程\"><a class=\"anchor\" href=\"#查看每台节点的进程\">#</a> 查看每台节点的进程</h5>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#jps</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> NodeManager</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> QuorumPeerMain</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> DFSZKFailoverController</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> DataNode</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> JournalNode</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> NameNode</pre></td></tr><tr><td data-num=\"8\"></td><td><pre> ResourceManager</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop-2.6.0]</span><span class=\"token comment\">#jps</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> JournalNode</pre></td></tr><tr><td data-num=\"12\"></td><td><pre> NameNode</pre></td></tr><tr><td data-num=\"13\"></td><td><pre> QuorumPeerMain</pre></td></tr><tr><td data-num=\"14\"></td><td><pre> DFSZKFailoverController</pre></td></tr><tr><td data-num=\"15\"></td><td><pre> ResourceManager</pre></td></tr><tr><td data-num=\"16\"></td><td><pre> DataNode</pre></td></tr><tr><td data-num=\"17\"></td><td><pre> NodeManager</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token namespace\">[root@node03 hadoop-2.6.0]</span><span class=\"token comment\">#jps</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre> QuorumPeerMain</pre></td></tr><tr><td data-num=\"21\"></td><td><pre> NodeManager</pre></td></tr><tr><td data-num=\"22\"></td><td><pre> DataNode</pre></td></tr><tr><td data-num=\"23\"></td><td><pre> JournalNode</pre></td></tr></table></figure><h2 id=\"3-通过web界面查看hadoop信息\"><a class=\"anchor\" href=\"#3-通过web界面查看hadoop信息\">#</a> 3、通过 Web 界面查看 hadoop 信息</h2>\n<p>1、浏览器访问 http://192.168.2.131:50070\t(active 节点，即 namenode 主节点)</p>\n<p>2、浏览器访问 http://192.168.2.132:50070\t(standby 节点，即 namenode 备节点)</p>\n<p>3、查看 yarn 的 web 控制台，浏览器访问 http://192.168.2.131:8088</p>\n<h2 id=\"4-测试namenode高可用\"><a class=\"anchor\" href=\"#4-测试namenode高可用\">#</a> 4、测试 namenode 高可用</h2>\n<p>1、在 node01 上 kill 掉 namenode 进程，然后通过浏览器查看 node02 的状态，发现状态变为 active，说明高可用测试成功</p>\n<p>2、重新启动 node01 的 namenode 进程，sh <span class=\"exturl\" data-url=\"aHR0cDovL3N0YXJ0LWRmcy5zaA==\">start-dfs.sh</span>, 浏览器访问 node01，此时 node01 的状态为 standby</p>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/25/Platform-construction/Hadoop/course-2/HDFS%E7%9A%84API%E6%93%8D%E4%BD%9C/",
            "url": "https://methiony.work/2020/11/25/Platform-construction/Hadoop/course-2/HDFS%E7%9A%84API%E6%93%8D%E4%BD%9C/",
            "title": "HDFS的API操作",
            "date_published": "2020-11-25T13:00:10.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/25/Platform-construction/Hadoop/course-2/HDFS%E7%9A%84%E6%96%87%E4%BB%B6%E5%8F%8A%E5%85%83%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/",
            "url": "https://methiony.work/2020/11/25/Platform-construction/Hadoop/course-2/HDFS%E7%9A%84%E6%96%87%E4%BB%B6%E5%8F%8A%E5%85%83%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/",
            "title": "HDFS的文件及元数据管理",
            "date_published": "2020-11-25T10:55:15.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hdfs的文件及元数据管理\"><a class=\"anchor\" href=\"#hdfs的文件及元数据管理\">#</a> HDFS 的文件及元数据管理</h1>\n<h2 id=\"1-hdfs的文件操作过程\"><a class=\"anchor\" href=\"#1-hdfs的文件操作过程\">#</a> 1、HDFS 的文件操作过程</h2>\n<h3 id=\"文件写入过程\"><a class=\"anchor\" href=\"#文件写入过程\">#</a> 文件写入过程</h3>\n<p><img data-src=\"hdfs%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E8%BF%87%E7%A8%8B.png\" alt=\"屏幕截图 2020-11-25 191055\" /></p>\n<p>1、 client 发起文件上传请求，通过 RPC 与 NameNode 建立通讯，NameNode 检查目标文件是否已存在，父目录是否存在，返回是否可以上传；<br />\n2、 client 请求第一个 block 该传输到哪些 DataNode 服务器上；<br />\n3、 NameNode 根据配置文件中指定的备份数量及机架感知原理进行文件分配，返回可用的 DataNode 的地址如：A，B，C；<br />\n注：Hadoop 在设计时考虑到数据的安全与高效，数据文件默认在 HDFS 上存放三份，存储策略为本地一份，同机架内其它某一节点上一份，不同机架的某一节点上一份。<br />\n4、 client 请求 3 台 DataNode 中的一台 A 上传数据（本质上是一个 RPC 调用，建立 pipeline），A 收到请求会继续调用 B，然后 B 调用 C，将整个 pipeline 建立完成，后逐级返回 client；<br />\n5、 client 开始往 A 上传第一个 block（先从磁盘读取数据放到一个本地内存缓存），以 packet 为单位（默认 64K），A 收到一个 packet 就会传给 B，B 传给 C；A 每传一个 packet 会放入一个应答队列等待应答。<br />\n6、 数据被分割成一个个 packet 数据包在 pipeline 上依次传输，在 pipeline 反方向上，逐个发送 ack（命令正确应答），最终由 pipeline 中第一个 DataNode 节点 A 将 pipelineack 发送给 client;<br />\n7、 当一个 block 传输完成之后，client 再次请求 NameNode 上传第二个 block 到服务器。</p>\n<h3 id=\"文件读取过程\"><a class=\"anchor\" href=\"#文件读取过程\">#</a> 文件读取过程</h3>\n<p><img data-src=\"C:%5CUsers%5CMethiony%5CPictures%5Chdfs%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96.png\" alt=\"hdfs文件读取\" /></p>\n<p>1、 Client 向 NameNode 发起 RPC 请求，来确定请求文件 block 所在的位置；<br />\n2、 NameNode 会视情况返回文件的部分或者全部 block 列表，对于每个 block，NameNode 都会返回含有该 block 副本的 DataNode 地址； 这些返回的 DN 地址，会按照集群拓扑结构得出 DataNode 与客户端的距离，然后进行排序，排序两个规则：网络拓扑结构中距离 Client 近的排靠前；心跳机制中超时汇报的 DN 状态为 STALE，这样的排靠后；<br />\n3、 Client 选取排序靠前的 DataNode 来读取 block，如果客户端本身就是 DataNode, 那么将从本地直接获取数据 (短路读取特性)；<br />\n4、 底层上本质是建立 Socket Stream（FSDataInputStream），重复的调用父类 DataInputStream 的 read 方法，直到这个块上的数据读取完毕；<br />\n5、 当读完列表的 block 后，若文件读取还没有结束，客户端会继续向 NameNode 获取下一批的 block 列表；<br />\n6、 读取完一个 block 都会进行 checksum 验证，如果读取 DataNode 时出现错误，客户端会通知 NameNode，然后再从下一个拥有该 block 副本的 DataNode 继续读。<br />\n7、 read 方法是并行的读取 block 信息，不是一块一块的读取；NameNode 只是返回 Client 请求包含块的 DataNode 地址，并不是返回请求块的数据；<br />\n8、 最终读取来所有的 block 会合并成一个完整的最终文件。</p>\n<h2 id=\"2-hdfs的元数据管理\"><a class=\"anchor\" href=\"#2-hdfs的元数据管理\">#</a> 2、HDFS 的元数据管理</h2>\n<p>在 Hadoop 集群中，NameNode 所有元数据信息保存在 Fslmage 和 Eidts 文件中，元数据信息的保存目录在 hdfs-site.xml 中配置</p>\n<p>fsimage：NameNode 中元数据的镜像，存放了一份比较完整的元数据信息</p>\n<p>edits：存放客户端最近一段时间的操作日志</p>\n<p>SecondaryNameNode 辅助管理 fsimage 和 edits 文件</p>\n<h3 id=\"fsimage中的文件信息查看\"><a class=\"anchor\" href=\"#fsimage中的文件信息查看\">#</a> fsimage 中的文件信息查看</h3>\n<p>使用 hdfs oiv</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cd <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>namenodeDatas<span class=\"token operator\">/</span>current<span class=\"token operator\">/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hdfs oiv <span class=\"token operator\">-</span>i fsimage_0000000000000000010</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">-</span>p XML <span class=\"token operator\">-</span>o my_fsimage<span class=\"token punctuation\">.</span>xml</pre></td></tr></table></figure><h3 id=\"edits中的文件信息查看\"><a class=\"anchor\" href=\"#edits中的文件信息查看\">#</a> edits 中的文件信息查看</h3>\n<p>使用 hdfs oev</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cd <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>nn<span class=\"token operator\">/</span>edits<span class=\"token operator\">/</span>current<span class=\"token operator\">/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hdfs oev <span class=\"token operator\">-</span>i edits_0000000000000000001<span class=\"token operator\">-</span>0000000000000000009</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">-</span>p XML <span class=\"token operator\">-</span>o myedit<span class=\"token punctuation\">.</span>xml</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/24/Platform-construction/Hadoop/course-2/Hadoop%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/",
            "url": "https://methiony.work/2020/11/24/Platform-construction/Hadoop/course-2/Hadoop%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/",
            "title": "Hadoop基本介绍及相关知识",
            "date_published": "2020-11-24T03:28:23.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hadoop的介绍及相关知识\"><a class=\"anchor\" href=\"#hadoop的介绍及相关知识\">#</a> Hadoop 的介绍及相关知识</h1>\n<p>狭义上，Hadoop 就是单独指代 Hadoop 这个软件</p>\n<p>HDFS：分布式文件系统</p>\n<p>MapReduce：分布式计算系统</p>\n<p>Yarn：分布式样集群资源管理</p>\n<p>广义上，Hadoop 指代大数据的一个生态圈，包括其他</p>\n<h2 id=\"1-hadoop核心-hdfs\"><a class=\"anchor\" href=\"#1-hadoop核心-hdfs\">#</a> 1、Hadoop 核心 - HDFS</h2>\n<h3 id=\"1-介绍\"><a class=\"anchor\" href=\"#1-介绍\">#</a> 1、介绍：</h3>\n<p>大量数据跨机器存储，统一管理分布在集群上的文件系统，也就是分布式文件系统</p>\n<h3 id=\"2-架构\"><a class=\"anchor\" href=\"#2-架构\">#</a> 2、架构</h3>\n<p>HDFS 是一个主 / 从（Mater/Slave）体系结构</p>\n<p>HDFS 由四部分组成，HDFS Client、NameNode、DataNode 和 Secondary NameNode</p>\n<h3 id=\"3-namenode作用\"><a class=\"anchor\" href=\"#3-namenode作用\">#</a> 3、NameNode 作用</h3>\n<p>NameNode 在内存中保存着整个文件系统的名称空间和文件数据块的地址映射，整个 HDFS 可存储的文件受限于 NameNode 的内存大小</p>\n<p>1、NameNode 元数据信息：文件名，文件目录结构，文件属性，每个文件的块列表，列表中块于块所在 DataNode 之间的地址映射关系；内存加载文件系统中文件于数据块的引用关系，会定期保存到本地磁盘（fsimage 文件和 edits 文件）</p>\n<p>2、NameNode 文件操作：负责文件元数据的操作，Datanode 负责文件的读写请求，数据流不经过 NameNode，但会询问于 datanode 的联系</p>\n<p>3、Namenode 副本：文件数据块由 NameNode 决定放在某个 DataNode 上，根据全局情况放置副本决定</p>\n<p>4、心跳机制：NameNode 与 DataNode 之间存在心跳信息，NameNode 周期性接收心跳和块的状态报告信息，若接收到信息，则认为正常，反之，对已经宕机的 datanode 上的数据块重新复制</p>\n<h3 id=\"4-datanode作用\"><a class=\"anchor\" href=\"#4-datanode作用\">#</a> 4、Datanode 作用</h3>\n<p>提供真实文件数据的存储服务</p>\n<p>1、Data Node 以数据块的形式存储 HDFS 文件</p>\n<p>2、响应 HDFS 客户端读写请求</p>\n<p>3、周期性向 NameNode 汇报心跳、数据块、缓存数据块信息</p>\n<h3 id=\"5-hdfs的副本机制和机架感知\"><a class=\"anchor\" href=\"#5-hdfs的副本机制和机架感知\">#</a> 5、HDFS 的副本机制和机架感知</h3>\n<p>副本机制：所有文件都以 block 块的方式存放在 HDFS 文件系统当中</p>\n<p>机架感知：把文件切分成副本放在不同机架中，保证数据容错能力</p>\n<h3 id=\"6-hdfs的命令行使用\"><a class=\"anchor\" href=\"#6-hdfs的命令行使用\">#</a> 6、HDFS 的命令行使用</h3>\n<h4 id=\"基础命令\"><a class=\"anchor\" href=\"#基础命令\">#</a> 基础命令</h4>\n<table>\n<thead>\n<tr>\n<th>序号</th>\n<th>命令</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>-help</td>\n<td>输出这个命令参数</td>\n</tr>\n<tr>\n<td>2</td>\n<td>-ls</td>\n<td>显示目录信息</td>\n</tr>\n<tr>\n<td>3</td>\n<td>-mkdir</td>\n<td>在 HDFS 上创建目录</td>\n</tr>\n<tr>\n<td>4</td>\n<td>-moveFromLocal</td>\n<td>从本地剪切粘贴到 HDFS</td>\n</tr>\n<tr>\n<td>5</td>\n<td>-appendToFile</td>\n<td>追加一个文件到已经存在的文件末尾</td>\n</tr>\n<tr>\n<td>6</td>\n<td>-cat</td>\n<td>显示文件内容</td>\n</tr>\n<tr>\n<td>7</td>\n<td>-chgrp 、-chmod、-chown</td>\n<td>Linux 文件系统中的用法一样，修改文件所属权限</td>\n</tr>\n<tr>\n<td>8</td>\n<td>-copyFromLocal</td>\n<td>从本地文件系统中拷贝文件到 HDFS 路径去</td>\n</tr>\n<tr>\n<td>9</td>\n<td>-copyToLocal</td>\n<td>从 HDFS 拷贝到本地</td>\n</tr>\n<tr>\n<td>10</td>\n<td>-cp</td>\n<td>从 HDFS 的一个路径拷贝到 HDFS 的另一个路径</td>\n</tr>\n<tr>\n<td>11</td>\n<td>-mv</td>\n<td>在 HDFS 目录中移动文件</td>\n</tr>\n<tr>\n<td>12</td>\n<td>-get</td>\n<td>等同于 copyToLocal，就是从 HDFS 下载文件到本地</td>\n</tr>\n<tr>\n<td>13</td>\n<td>-getmerge</td>\n<td>合并下载多个文件</td>\n</tr>\n<tr>\n<td>14</td>\n<td>-put</td>\n<td>等同于 copyFromLocal</td>\n</tr>\n<tr>\n<td>15</td>\n<td>-tail</td>\n<td>显示一个文件的末尾</td>\n</tr>\n<tr>\n<td>16</td>\n<td>-rm</td>\n<td>删除文件或文件夹</td>\n</tr>\n<tr>\n<td>17</td>\n<td>-rmdir</td>\n<td>删除空目录</td>\n</tr>\n<tr>\n<td>18</td>\n<td>-du</td>\n<td>统计文件夹的大小信息</td>\n</tr>\n<tr>\n<td>19</td>\n<td>-setrep</td>\n<td>设置 HDFS 中文件的副本数量</td>\n</tr>\n<tr>\n<td>20</td>\n<td>- expunge</td>\n<td>清空 HDFS 垃圾桶</td>\n</tr>\n</tbody>\n</table>\n<p>格式：</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfs 命令行 path</pre></td></tr></table></figure><h4 id=\"高级命令\"><a class=\"anchor\" href=\"#高级命令\">#</a> 高级命令</h4>\n<h5 id=\"1-hdfs的文件限额配置\"><a class=\"anchor\" href=\"#1-hdfs的文件限额配置\">#</a> 1、HDFS 的文件限额配置</h5>\n<p>HDFS 的配额指定针对的是目录，而非账号，可以让每个账号仅操作某一个目录，然后对目录进行配置</p>\n<p>HDFS 限额配置允许以文件大小、文件个数来限制我们在某个目录下上传文件数量或文件内容总量</p>\n<p>查看配额信息，path 指代文件路径</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfs <span class=\"token operator\">-</span>count <span class=\"token operator\">-</span>q <span class=\"token operator\">-</span>h path</pre></td></tr></table></figure><h6 id=\"数量限额\"><a class=\"anchor\" href=\"#数量限额\">#</a> 数量限额</h6>\n<p>设置最大上传文件个数为 2, 注意自身也包括一个，所以只能上传一个</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>setQuota 2 path</pre></td></tr></table></figure><p>清楚文件数量限额配置</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>clrQuota path</pre></td></tr></table></figure><h6 id=\"空间大小限额\"><a class=\"anchor\" href=\"#空间大小限额\">#</a> 空间大小限额</h6>\n<p>设置空间配额时，设置空间大小至少为 block_size*3 大小</p>\n<p>限制空间大小为 4kb</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>setSpaceQuota 4k path</pre></td></tr></table></figure><p>生成任意大小文件命令</p>\n<p>生成一个 2M 的文件（bs*count）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dd <span class=\"token keyword\">if</span>=<span class=\"token operator\">/</span>dev<span class=\"token operator\">/</span>zero of=1<span class=\"token punctuation\">.</span>txt bs=2M count=1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>dd <span class=\"token keyword\">if</span>=<span class=\"token operator\">/</span>dev<span class=\"token operator\">/</span>zero of=1<span class=\"token punctuation\">.</span>txt bs=1M count=2</pre></td></tr></table></figure><p>清除配置</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>clrSpaceQuota path</pre></td></tr></table></figure><h5 id=\"2-hdfs的安全模式\"><a class=\"anchor\" href=\"#2-hdfs的安全模式\">#</a> 2、hdfs 的安全模式</h5>\n<p>安全模式是 Hadoop 的一种保护机制，用于保证集群中的数据块的安全性</p>\n<p>在安全模式状态下，文件系统只接受读数据请求，而不接受删除、修改等变更请求当整个系统达到安全标准，hdfs 自动离开安全模式</p>\n<p>安全模式操作命令</p>\n<p>查看安全模式状态</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>safemode get</pre></td></tr></table></figure><p>进入安全模式</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>safemode enter</pre></td></tr></table></figure><p>离开安全模式</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>safemode leave</pre></td></tr></table></figure><h2 id=\"2-hdfs的基准测试\"><a class=\"anchor\" href=\"#2-hdfs的基准测试\">#</a> 2、Hdfs 的基准测试</h2>\n<p>1、测试写入速度</p>\n<p>向 HDFS 文件系统中写入数据，10 个文件，每个文件 10MB，文件存放到 /benchmarks/TestDFSIO 中</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hadoop jar <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>share<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">/</span>mapreduce<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>mapreduce<span class=\"token operator\">-</span>client<span class=\"token operator\">-</span>jobclient<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token punctuation\">.</span>jar  TestDFSIO <span class=\"token operator\">-</span><span class=\"token function\">write</span> <span class=\"token operator\">-</span>nrFiles 10 <span class=\"token operator\">-</span>fileSize 10MB</pre></td></tr></table></figure><p>完成之后查看写入速度结果</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfs <span class=\"token operator\">-</span>text <span class=\"token operator\">/</span>benchmarks<span class=\"token operator\">/</span>TestDFSIO<span class=\"token operator\">/</span>io_write<span class=\"token operator\">/</span>part<span class=\"token operator\">-</span>00000</pre></td></tr></table></figure><p>2、测试读取速度</p>\n<p>测试 hdfs 的读取文件性能，在 hdfs 文件系统中读入 10 个文件，每个 10MB</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hadoop jar <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>share<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">/</span>mapreduce<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>mapreduce<span class=\"token operator\">-</span>client<span class=\"token operator\">-</span>jobclient<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token punctuation\">.</span>jar  TestDFSIO <span class=\"token operator\">-</span>read <span class=\"token operator\">-</span>nrFiles 10 <span class=\"token operator\">-</span>fileSize 10MB</pre></td></tr></table></figure><p>查看读取结果</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfs <span class=\"token operator\">-</span>text <span class=\"token operator\">/</span>benchmarks<span class=\"token operator\">/</span>TestDFSIO<span class=\"token operator\">/</span>io_write<span class=\"token operator\">/</span>part<span class=\"token operator\">-</span>00000</pre></td></tr></table></figure><p>3、清楚测试数据</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hadoop jar <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>share<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">/</span>mapreduce<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>mapreduce<span class=\"token operator\">-</span>client<span class=\"token operator\">-</span>jobclient<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token punctuation\">.</span>jar  TestDFSIO <span class=\"token operator\">-</span>clean</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/21/Platform-construction/Hadoop/course-2/Hadoop%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/",
            "url": "https://methiony.work/2020/11/21/Platform-construction/Hadoop/course-2/Hadoop%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/",
            "title": "Hadoop分布式集群搭建",
            "date_published": "2020-11-21T11:19:50.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hadoop分布式集群搭建\"><a class=\"anchor\" href=\"#hadoop分布式集群搭建\">#</a> Hadoop 分布式集群搭建</h1>\n<h2 id=\"1-环境准备\"><a class=\"anchor\" href=\"#1-环境准备\">#</a> 1、环境准备</h2>\n<p>首先准备了三台虚拟机（为了避免环境的干扰，都是新建的虚拟机），分别分配了 1G 内存、20G 硬盘、2 核 CPU，然后安装了 CentOS-7-x86_64-DVD-2009 操作系统，并配置了静态 IP 地址。</p>\n<p><strong>集群规划：</strong></p>\n<p>搭建的是 NameNode 与 ResourceManager 单节点架构。节点具体分别如下：</p>\n<table>\n<thead>\n<tr>\n<th>服务器名称</th>\n<th>IP 地址</th>\n<th>NameNode</th>\n<th>SecondaryNameNode</th>\n<th>dataNode</th>\n<th>ResourceManager</th>\n<th>NodeManager</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>master</td>\n<td>192.168.2.128</td>\n<td>是</td>\n<td>是</td>\n<td>是</td>\n<td>是</td>\n<td>是</td>\n</tr>\n<tr>\n<td>node01</td>\n<td>192.168.2.129</td>\n<td>否</td>\n<td>否</td>\n<td>是</td>\n<td>否</td>\n<td>是</td>\n</tr>\n<tr>\n<td>node02</td>\n<td>192.168.2.130</td>\n<td>否</td>\n<td>否</td>\n<td>是</td>\n<td>否</td>\n<td>是</td>\n</tr>\n</tbody>\n</table>\n<p><strong>文件系统核心模块：</strong><br />\nNameNode：集群当中的主节点，主要用于管理集群当中的各种数据<br />\n secondaryNameNode：主要能用于 hadoop 当中元数据信息的辅助管理<br />\n DataNode：集群当中的从节点，主要用于存储集群当中的各种数据<br />\n<strong>数据计算核心模块：</strong><br />\nResourceManager：接收用户的计算请求任务，并负责集群的资源分配<br />\n NodeManager：负责执行主节点 APPmaster 分配的任务</p>\n<h2 id=\"2-环境配置\"><a class=\"anchor\" href=\"#2-环境配置\">#</a> 2、环境配置</h2>\n<p>1、关闭防火墙</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token comment\"># systemctl stop firewalld.service </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#关闭防火墙</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token comment\"># systemctl disable firewalld.service </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#禁止开机启动</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># firewall-cmd --state </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#查看防火墙状态</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>not running</pre></td></tr></table></figure><p>2、设置主机名称</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#在 192.168.2.128 机器上执行 * </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># hostnamectl set-hostname  master</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token comment\">#在 192.168.2.129 机器上执行 * </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># hostnamectl set-hostname node01</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token comment\">#在 192.168.2.130 机器上执行 * </span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># hostnamectl set-hostname node02</span></pre></td></tr></table></figure><p>3、三台虚拟机重启</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#在 192.168.2.128 机器上执行 * </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token comment\">#在 192.168.2.129 机器上执行 * </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token comment\">#在 192.168.2.130 机器上执行 * </span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr></table></figure><p>4、关闭 selinux</p>\n<p>进入到 /etc/selinux/config 文件，将 SELINUX=enforcing 改为 SELINUX=disabled。</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master ~]</span><span class=\"token comment\">#  vi  /etc/selinux/config</span></pre></td></tr></table></figure><p>5、设置免密登录</p>\n<p>首先在 master 主机上使用 ssh-keygen 命令来生成秘钥，一路按回车键</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@master~<span class=\"token punctuation\">]</span><span class=\"token comment\">#ssh-keygen -t rsa</span></pre></td></tr></table></figure><p>通过 ssh-copy-id 命令设置免密钥登录<br />\n其中，master、node01、node02 表示需要设置免密登录的服务器地址。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ssh-copy-id -i ~/.ssh/id_rsa.pub root@master</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ssh-copy-id -i ~/.ssh/id_rsa.pub root@node01</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ssh-copy-id -i ~/.ssh/id_rsa.pub root@node02</pre></td></tr></table></figure><p>其他机器也必须进行设置</p>\n<h2 id=\"3-安装jdk\"><a class=\"anchor\" href=\"#3-安装jdk\">#</a> 3、安装 JDK</h2>\n<p>在 master 中新建目录 /opt/bigdata/, 此目录下存放 hadoop 大数据所需要的环境包 (jdk 和 hadoop).</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#mkdir /opt/bigdata</span></pre></td></tr></table></figure><p>1、把下载好的 jdk-8u271-linux-x64.tar.gz 包和 hadoop-3.1.4.tar.gz 上传至 master 主机中，JDK 是安装 Hadoop 的基础环境，所以需要优先安装好 JDK 环境</p>\n<p>2、解压 jdk 并复制到 /opt/bigdata 目录下</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#tar -zxvf jdk-8u271-linux-x64.tar.gz -C</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata</pre></td></tr></table></figure><p>3、配置环境变量 (/etc/profile)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#vi /etc/profile</span></pre></td></tr></table></figure><p>添加</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export JAVA_HOME=<span class=\"token operator\">/</span>export<span class=\"token operator\">/</span>servers<span class=\"token operator\">/</span>jdk1<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0_271 </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export PATH=:<span class=\"token variable\">$JAVA_HOME</span><span class=\"token operator\">/</span>bin:<span class=\"token variable\">$PATH</span></pre></td></tr></table></figure><p>执行下面命令，让环境变量生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><p>验证 jdk 安装是否成功</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#java -version</span></pre></td></tr></table></figure><h2 id=\"4-安装hadoop\"><a class=\"anchor\" href=\"#4-安装hadoop\">#</a> 4、安装 hadoop</h2>\n<p>1、解压 hadoop，并把解压文件复制到 /opt/bigdata 目录中</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#tar -zxvf hadoop-3.1.4.tar.gz -C /opt/bigdata</span></pre></td></tr></table></figure><p>2、配置环境变量 (/etc/profile)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#vi /etc/profile</span></pre></td></tr></table></figure><p>添加</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export HADOOP_HOME=<span class=\"token operator\">/</span>export<span class=\"token operator\">/</span>servers<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export PATH=:<span class=\"token variable\">$HADOOP_HOME</span><span class=\"token operator\">/</span>bin:<span class=\"token variable\">$HADOOP_HOME</span><span class=\"token operator\">/</span>sbin:<span class=\"token variable\">$PATH</span></pre></td></tr></table></figure><p>执行下面命令，让环境变量生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><p>3、修改 hadoop 的配置文件</p>\n<p>进入需改文件的目录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#cd /opt/bigdata/hadoop-3.1.4/etc/hadoop</span></pre></td></tr></table></figure><p>需要修改的文件</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>core<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\thadoop<span class=\"token operator\">-</span>env<span class=\"token punctuation\">.</span>sh\thdfs<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\t</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mapred<span class=\"token operator\">-</span>env<span class=\"token punctuation\">.</span>sh\tmapred<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\tyarn<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml</pre></td></tr></table></figure><p>首先，修改 core-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span> \t</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!--  指定集群的文件系统类型：分布式文件系统 --></span> \t</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span> \t\t</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>fs.default.name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span> \t\t</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 因为前面已经配置了服务器名称映射 IP，所以这里可以使用服务器名称进行配置 --></span> \t\t</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>hdfs://master:8020<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span> \t</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token comment\">&lt;!--  指定临时文件存储目录 --></span> \t</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>hadoop.tmp.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span> \t\t\t\t\t     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/opt/bigdata/hadoop3.1.4/hadoopDatas/tempDatas<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span> \t</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">&lt;!--  缓冲区大小，实际工作中根据服务器性能动态调整 --></span> \t</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span> \t\t</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>io.file.buffer.size<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span> \t\t</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>4096<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span> \t</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span>  \t</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">&lt;!--  开启 hdfs 的垃圾桶机制，删除掉的数据可以从垃圾桶中回收，单位分钟 --></span> \t</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span> </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>fs.trash.interval<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span> </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>10080<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span> \t</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span> </pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>其次，修改 hdfs-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.secondary.http-address<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>master:50090<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 namenode 的访问地址和端口 --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.http-address<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>master:50070<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 namenode 元数据的存放位置 --></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.name.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/namenodeDatas,file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/namenodeDatas2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">&lt;!--  定义 dataNode 数据存储的节点位置，实际工作中，一般先确定磁盘的挂载目录，然后多个目录用，进行分割  --></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.datanode.data.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/datanodeDatas,file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/datanodeDatas2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 namenode 日志文件的存放目录 --></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.edits.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/nn/edits<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.checkpoint.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/snn/name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.checkpoint.edits.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/dfs/snn/edits<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 文件切片的副本个数 --></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.replication<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置 HDFS 的文件权限 --></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.permissions<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置一个文件切片的大小：128M--></span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.blocksize<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>134217728<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>然后，修改 yarn-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 配置 yarn 主节点的位置 --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.hostname<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>master<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.nodemanager.aux-services<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>mapreduce_shuffle<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 开启日志聚合功能 --></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.log-aggregation-enable<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置聚合日志在 hdfs 上的保存时间 --></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.log-aggregation.retain-seconds<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>604800<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置 yarn 集群的内存分配方案 --></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span>    </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.nodemanager.resource.memory-mb<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span>    </pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>20480<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        \t <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.scheduler.minimum-allocation-mb<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>         \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>2048<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.nodemanager.vmem-pmem-ratio<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>2.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>然后，修改 mapred-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 开启 MapReduce 小任务模式 --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>mapreduce.job.ubertask.enable<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置历史任务的主机和端口 --></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>mapreduce.jobhistory.address<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>master:10020<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置网页访问历史任务的主机和端口 --></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>mapreduce.jobhistory.webapp.address<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>master:19888<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>然后，<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1oYWRvb3AtZW52LXl1NnA1NHIwbmE1NjF0LnNo\">分别修改 hadoop-env.sh</span>、mapred-env.sh 文件</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master hadoop]</span><span class=\"token comment\">#vi hadoop-env.sh</span></pre></td></tr></table></figure><figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master hadoop]</span><span class=\"token comment\">#vi mapred-env.sh</span></pre></td></tr></table></figure><p>添加 Java 环境变量</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export JAVA_HOME=<span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>jdk1<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0_271</pre></td></tr></table></figure><p>最后，修改集群配置文件 slaves（没有则新建）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master hadoop]</span><span class=\"token comment\">#vi slaves</span></pre></td></tr></table></figure><p>添加</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>master</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>node01</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>node02</pre></td></tr></table></figure><p>4、创建 hadoop 需要的文件目录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>tempDatas</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>namenodeDatas</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>namenodeDatas2</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>datanodeDatas</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>datanodeDatas2 </pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>nn<span class=\"token operator\">/</span>edits</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>snn<span class=\"token operator\">/</span>name</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>dfs<span class=\"token operator\">/</span>snn<span class=\"token operator\">/</span>edits</pre></td></tr></table></figure><h2 id=\"5-分发jdk-hadoop到node01-node02\"><a class=\"anchor\" href=\"#5-分发jdk-hadoop到node01-node02\">#</a> 5、分发 jdk、hadoop 到 node01、node02</h2>\n<p>首先进入 jdk、hadoop 的安装目录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master hadoop]</span><span class=\"token comment\">#cd /opt/bigdata</span></pre></td></tr></table></figure><p>然后分发 jdk，分别到 node01、node02</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>scp <span class=\"token operator\">-</span>r jdk1<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0_271 node01:<span class=\"token variable\">$PWD</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>scp <span class=\"token operator\">-</span>r jdk1<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0_271 node02:<span class=\"token variable\">$PWD</span></pre></td></tr></table></figure><p>分发 Hadoop，分别到 node01、node02</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>scp <span class=\"token operator\">-</span>r hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4 node01:<span class=\"token variable\">$PWD</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>scp <span class=\"token operator\">-</span>r hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4 node02:<span class=\"token variable\">$PWD</span></pre></td></tr></table></figure><p>分发 master 已经配置好的环境变量文件到 node01、node02 (需要进入到根目录)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>scp <span class=\"token operator\">-</span>r <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>profile root@node01:<span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>profile </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>scp <span class=\"token operator\">-</span>r <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>profile root@node02:<span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>profile</pre></td></tr></table></figure><p>执行下面命令，让环境变量生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01~]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02~]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><p>检查是否生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01~]</span><span class=\"token comment\">#java -version</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02~]</span><span class=\"token comment\">#java -version</span></pre></td></tr></table></figure><h2 id=\"6-启动集群\"><a class=\"anchor\" href=\"#6-启动集群\">#</a> 6、启动集群</h2>\n<p>首先，在 master 主机进行格式化（首次需要执行）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cd  <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span> <span class=\"token comment\">#首先进入 hadoop 根目录</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>bin<span class=\"token operator\">/</span>hdfs namenode <span class=\"token operator\">-</span>format <span class=\"token comment\">#执行格式化命令</span></pre></td></tr></table></figure><p>然后，启动 hdfs 集群</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sbin<span class=\"token operator\">/</span><span class=\"token function\">start-dfs</span><span class=\"token punctuation\">.</span>sh</pre></td></tr></table></figure><p>再启动 yarn 集群</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sbin<span class=\"token operator\">/</span><span class=\"token function\">start-yarn</span><span class=\"token punctuation\">.</span>sh</pre></td></tr></table></figure><p>最后，启动 historyserver，查看历史完成的任务</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sbin<span class=\"token operator\">/</span>mr<span class=\"token operator\">-</span>jobhistory<span class=\"token operator\">-</span>daemon<span class=\"token punctuation\">.</span>sh <span class=\"token function\">start</span> historyserver</pre></td></tr></table></figure><p>使用 jps 查看进程</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#jps</span></pre></td></tr></table></figure><h2 id=\"7-查看可视化界面验证启动是否成功\"><a class=\"anchor\" href=\"#7-查看可视化界面验证启动是否成功\">#</a> 7、查看可视化界面，验证启动是否成功</h2>\n<p>1、首先访问：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMi4xMjg6NTAwNzAvZXhwbG9yZXIuaHRtbCMvJUVGJUJDJThDJUU3JTk0JUE4JUU2JTlEJUE1JUU2JTlGJUE1JUU3JTlDJThCaGRmcw==\">http://192.168.2.128:50070/explorer.html#/，用来查看 hdfs</span></p>\n<p>2、然后访问：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMi4xMjg6ODA4OC9jbHVzdGVyJUVGJUJDJThDJUU2JTlGJUE1JUU3JTlDJThCeWFybiVFOSU5QiU4NiVFNyVCRSVBNA==\">http://192.168.2.128:8088/cluster，查看 yarn 集群</span></p>\n<p>3、最后访问：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMi4xMjg6MTk4ODgvam9iaGlzdG9yeSVFRiVCQyU4QyVFNiU5RiVBNSVFNyU5QyU4QiVFNSU4RSU4NiVFNSU4RiVCMiVFNSVBRSU4QyVFNiU4OCU5MCVFNyU5QSU4NCVFNCVCQiVCQiVFNSU4QSVBMQ==\">http://192.168.2.128:19888/jobhistory，查看历史完成的任务</span></p>\n<p>如果都有页面表示搭建成功！</p>\n",
            "tags": []
        }
    ]
}