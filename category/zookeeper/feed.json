{
    "version": "https://jsonfeed.org/version/1",
    "title": "Andrésen • All posts by \"zookeeper\" category",
    "description": "",
    "home_page_url": "https://methiony.work",
    "items": [
        {
            "id": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
            "url": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
            "title": "Zookeeper基础知识",
            "date_published": "2020-11-23T06:50:40.000Z",
            "content_html": "<h1 id=\"zookeeper基础知识\"><a class=\"anchor\" href=\"#zookeeper基础知识\">#</a> Zookeeper 基础知识</h1>\n<h2 id=\"1-zookeepr的数据类型\"><a class=\"anchor\" href=\"#1-zookeepr的数据类型\">#</a> 1、zookeepr 的数据类型</h2>\n<h3 id=\"与标准文件系统相同之处\"><a class=\"anchor\" href=\"#与标准文件系统相同之处\">#</a> 与标准文件系统相同之处</h3>\n<p>Zookeeper 的数据类型，在结构上拥有一个层次的命名空间，和标准文件系统非常相似，都是采用树形层次结构</p>\n<p>Zookeeper 树中的每个节点称为一个 Znode, 每个节点可以拥有子节点</p>\n<h3 id=\"与标准文件系统不同之处\"><a class=\"anchor\" href=\"#与标准文件系统不同之处\">#</a> 与标准文件系统不同之处</h3>\n<p>Znode 具有文件和目录两种特点。既有文件的数据功能，又有目录作为路径标识的功能，并可以具有子 Znode。znode 具有增、删、改、查等操作</p>\n<p>Znode 存储数据大小有限制。它用来管理调度数据，数据通常以 kb 为单位，数据大小至多 1M，通常小于此值</p>\n<p>Znode 通过路径引用，且为绝对路径，因此为 &quot;/&quot; 开头</p>\n<p>Znode 由 3 部分组成。stat: 状态信息，描述版本、权限等信息\tdata：与该 znode 关联的数据\tchildren：该 znode 下的子节点</p>\n<h2 id=\"znode节点类型\"><a class=\"anchor\" href=\"#znode节点类型\">#</a> Znode 节点类型</h2>\n<p>节点类型在创建时被确定，不能改变</p>\n<p>1、临时节点：在使用期间存在，会话结束后自动删除。不允许拥有子节点</p>\n<p>2、永久节点：只能手动删除，允许拥有子节点</p>\n<p>3、节点具有序列化特性，如果在创建时指定，该 znode 后面会自动追加一个 10 位数字的序列号</p>\n<p>四种类型的 Znode 节点</p>\n<table>\n<thead>\n<tr>\n<th>PERSISTENT:</th>\n<th>永久节点</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>EPHEMERAL:</td>\n<td>临时节点</td>\n</tr>\n<tr>\n<td>PERSISTENT_SEQUENTIAL</td>\n<td>永久节点、序列化</td>\n</tr>\n<tr>\n<td>EPHEMERAL_SEQUENTIAL</td>\n<td>临时节点、序列化</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"zookeeper的shell客户端操作\"><a class=\"anchor\" href=\"#zookeeper的shell客户端操作\">#</a> Zookeeper 的 Shell 客户端操作</h2>\n<h3 id=\"登录zookeeper客户端\"><a class=\"anchor\" href=\"#登录zookeeper客户端\">#</a> 登录 Zookeeper 客户端</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bin<span class=\"token operator\">/</span>zkCli<span class=\"token punctuation\">.</span>sh <span class=\"token operator\">-</span>server master:2181</pre></td></tr></table></figure><h3 id=\"操作实例\"><a class=\"anchor\" href=\"#操作实例\">#</a> 操作实例</h3>\n<p>列出 Path 下的所有 Znode</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token operator\">/</span></pre></td></tr></table></figure><p>创建永久节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">/</span>hello world</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>create <span class=\"token operator\">/</span>hello<span class=\"token operator\">/</span>hello1 world</pre></td></tr></table></figure><p>创建临时节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">-</span>e <span class=\"token operator\">/</span>hello world</pre></td></tr></table></figure><p>创建永久序列化节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">-</span>s <span class=\"token operator\">/</span>hello world</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>create <span class=\"token operator\">-</span>s <span class=\"token operator\">/</span>hello<span class=\"token operator\">/</span>hello1 world</pre></td></tr></table></figure><p>创建临时序列化节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">-</span>e <span class=\"token operator\">-</span>s <span class=\"token operator\">/</span>hello world</pre></td></tr></table></figure><p>修改节点数据</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">set</span> <span class=\"token operator\">/</span>hello zookeeper</pre></td></tr></table></figure><p>删除节点，如果有子 znode 则该命令无效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>delete <span class=\"token operator\">/</span>hello</pre></td></tr></table></figure><p>删除节点，如果有子 znode 则递归删除</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>rmr <span class=\"token operator\">/</span>hello</pre></td></tr></table></figure><p>列出历史记录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>histroy</pre></td></tr></table></figure><h3 id=\"操作命令\"><a class=\"anchor\" href=\"#操作命令\">#</a> 操作命令</h3>\n<p>path: 指 / Znode、data:znode 数据、acl: 权限、watch: 观察</p>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>说明</th>\n<th>参数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>create [-s] [-e] path data acl</td>\n<td>创建 znode</td>\n<td>-s 指顺序节点，-e 指临时节点</td>\n</tr>\n<tr>\n<td>ls  path  [watch]</td>\n<td>列出 path 下所有子 znode</td>\n<td></td>\n</tr>\n<tr>\n<td>get  path  [watch]</td>\n<td>获取 path 对应的 znode 的数据和属性</td>\n<td></td>\n</tr>\n<tr>\n<td>ls2  path  [watch]</td>\n<td>查看 path 所有子 znode 和子 znode 属性</td>\n<td></td>\n</tr>\n<tr>\n<td>set  path  data</td>\n<td>更新节点</td>\n<td></td>\n</tr>\n<tr>\n<td>delete  path</td>\n<td>删除节点，如果有子 znode 则该命令无效</td>\n<td></td>\n</tr>\n<tr>\n<td>rmr  path</td>\n<td>删除节点，如果有子 znode 则递归删除</td>\n<td></td>\n</tr>\n<tr>\n<td>setquota  -n|-b  val  path</td>\n<td>修改 znode 配额</td>\n<td>-n 设置子节点最大个数，-b 设置节点数据最大长度</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"节点属性\"><a class=\"anchor\" href=\"#节点属性\">#</a> 节点属性</h3>\n<p><img data-src=\"C:%5CUsers%5CMethiony%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201123160350874.png\" alt=\"\" /></p>\n<p>cZxid:znode 创建的事务 id</p>\n<p>ctime: 节点创建时的时间戳</p>\n<p>mZxid:Znode 被修改的事务 id, 每次对 znode 的修改都会更新 mZxid, 可以确定更新操作的顺序，如果 zxid1 小于 zxid2，说明 zxid1 操作先于 zxid2 发生，zxid 对于整个 zookeeper 都是唯一的</p>\n<p>mtime: 节点最新一次更新发生时的时间戳</p>\n<p>cversion: 子节点的版本号。当 znode 子节点有变化时，值会增加 1</p>\n<p>dataVersion: 数据版本号，每次对节点进行 set 操作，值会增加 1，避免了数据更新的顺序问题</p>\n<p>aclVersion:ACL 的版本号</p>\n<p>ephemeralOwner: 如果节点为临时节点，ephemeralOwner 值表示与该节点绑定的 session id。如果不是，ephemeralOwner 值为 0</p>\n<h2 id=\"zookeeper的watch机制\"><a class=\"anchor\" href=\"#zookeeper的watch机制\">#</a> Zookeeper 的 watch 机制</h2>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/21/Platform-construction/Zookeeper/course-1/Zookeeper%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/",
            "url": "https://methiony.work/2020/11/21/Platform-construction/Zookeeper/course-1/Zookeeper%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/",
            "title": "Zookeeper快速搭建",
            "date_published": "2020-11-21T09:40:19.000Z",
            "content_html": "<h1 id=\"zookeeper快速搭建\"><a class=\"anchor\" href=\"#zookeeper快速搭建\">#</a> ZooKeeper 快速搭建</h1>\n<h2 id=\"1-zookeeper的安装部署\"><a class=\"anchor\" href=\"#1-zookeeper的安装部署\">#</a> 1、Zookeeper 的安装部署</h2>\n<h3 id=\"拷贝zookeeper安装包到linux系统下\"><a class=\"anchor\" href=\"#拷贝zookeeper安装包到linux系统下\">#</a> 拷贝 Zookeeper 安装包到 Linux 系统下</h3>\n<h3 id=\"解压到指定目录\"><a class=\"anchor\" href=\"#解压到指定目录\">#</a> 解压到指定目录</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master]</span>$ tar <span class=\"token operator\">-</span>zxvf zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>tar<span class=\"token punctuation\">.</span>gz <span class=\"token operator\">-</span>C <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span></pre></td></tr></table></figure><h3 id=\"配置修改\"><a class=\"anchor\" href=\"#配置修改\">#</a> 配置修改</h3>\n<h4 id=\"optbigdatazookeeper-362conf这个路径下的zoo_samplecfg修改为zoocfg如果存在zoocfg文件则不需要拷贝zoo_samplecfg\"><a class=\"anchor\" href=\"#optbigdatazookeeper-362conf这个路径下的zoo_samplecfg修改为zoocfg如果存在zoocfg文件则不需要拷贝zoo_samplecfg\">#</a> /opt/bigdata/zookeeper-3.6.2/conf 这个路径下的 zoo_sample.cfg 修改为 zoo.cfg (如果存在 zoo.cfg 文件则不需要拷贝 zoo_sample.cfg)</h4>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master]</span>$ <span class=\"token function\">mv</span> zoo_sample<span class=\"token punctuation\">.</span>cfg zoo<span class=\"token punctuation\">.</span>cfg</pre></td></tr></table></figure><p>打开 zoo.cfg 文件，修改 dataDir 路径</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dataDir=<span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>2<span class=\"token operator\">/</span>zkData</pre></td></tr></table></figure><p>文件内容末尾添加内容</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>server<span class=\"token punctuation\">.</span>1=master:2888:3888</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>server<span class=\"token punctuation\">.</span>2=node1:2888:3888</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>server<span class=\"token punctuation\">.</span>3=node2:2888:3888</pre></td></tr></table></figure><p>在 /opt/bigdata/zookeeper-3.6.2 / 这个目录上创建 zkData 文件夹</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span>$ mkdir zkData</pre></td></tr></table></figure><h2 id=\"2-zookeeper启动与操作\"><a class=\"anchor\" href=\"#2-zookeeper启动与操作\">#</a> 2、 Zookeeper 启动与操作</h2>\n<h3 id=\"启动zookeeper\"><a class=\"anchor\" href=\"#启动zookeeper\">#</a> 启动 Zookeeper</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token variable\">$bin</span><span class=\"token operator\">/</span>zkServer<span class=\"token punctuation\">.</span>sh <span class=\"token function\">start</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ZooKeeper JMX enabled by default</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">Using</span> config: <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>2<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>conf<span class=\"token operator\">/</span>zoo<span class=\"token punctuation\">.</span>cfg</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Starting zookeeper <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> STARTED     <span class=\"token comment\"># 这时，一般就启动成功了</span></pre></td></tr></table></figure><h3 id=\"查看进程是否启动\"><a class=\"anchor\" href=\"#查看进程是否启动\">#</a> 查看进程是否启动</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token variable\">$jps</span></pre></td></tr></table></figure><h3 id=\"查看状态\"><a class=\"anchor\" href=\"#查看状态\">#</a> 查看状态</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token variable\">$bin</span><span class=\"token operator\">/</span>zkServer<span class=\"token punctuation\">.</span>sh status</pre></td></tr></table></figure><h3 id=\"启动客户端\"><a class=\"anchor\" href=\"#启动客户端\">#</a> 启动客户端</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token variable\">$bin</span><span class=\"token operator\">/</span>zkCli<span class=\"token punctuation\">.</span>sh</pre></td></tr></table></figure><h3 id=\"退出客户端\"><a class=\"anchor\" href=\"#退出客户端\">#</a> 退出客户端</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[zk: localhost:2181(CONNECTED) 0]</span> quit</pre></td></tr></table></figure><h3 id=\"停用zookeeper\"><a class=\"anchor\" href=\"#停用zookeeper\">#</a> 停用 Zookeeper</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token variable\">$bin</span><span class=\"token operator\">/</span>zkServer<span class=\"token punctuation\">.</span>sh stop</pre></td></tr></table></figure>",
            "tags": []
        }
    ]
}