{
    "version": "https://jsonfeed.org/version/1",
    "title": "Andrésen • All posts by \"zookeeper\" category",
    "description": "",
    "home_page_url": "https://methiony.work",
    "items": [
        {
            "id": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E7%9A%84API%E6%93%8D%E4%BD%9C/",
            "url": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E7%9A%84API%E6%93%8D%E4%BD%9C/",
            "title": "Zookeeper的API操作",
            "date_published": "2020-11-23T11:33:46.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记和习题整理<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"zookeeper的javaapi操作\"><a class=\"anchor\" href=\"#zookeeper的javaapi操作\">#</a> Zookeeper 的 javaAPI 操作</h1>\n<p>这里操作 Zookeeper 的 JavaAPI 使用的是 Zookeeper 客户端框架 Curator</p>\n<p>Curator 包含：</p>\n<p>curator-framework：对 zookeeper 的底层 api 的一些封装</p>\n<p>curator-recipes：封装了一些高级特性，如：Cache 事件监听、选举、分布式锁、分布式计数器等</p>\n<h2 id=\"1-创建java工程导入jar包\"><a class=\"anchor\" href=\"#1-创建java工程导入jar包\">#</a> 1、创建 Java 工程，导入 jar 包</h2>\n<p>创建 maven Java 工程，导入 jar 包</p>\n<h3 id=\"添加porn文件\"><a class=\"anchor\" href=\"#添加porn文件\">#</a> 添加 Porn 文件</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependencies<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>curator<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>curator<span class=\"token operator\">-</span>framework<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span><span class=\"token number\">2.12</span><span class=\"token number\">.0</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>curator<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>curator<span class=\"token operator\">-</span>recipes<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span><span class=\"token number\">2.12</span><span class=\"token number\">.0</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>com<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>collections<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>google<span class=\"token operator\">-</span>collections<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span><span class=\"token number\">1.0</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>junit<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>junit<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span>RELEASE<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>org<span class=\"token punctuation\">.</span>slf4j<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>slf4j<span class=\"token operator\">-</span>simple<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span><span class=\"token number\">1.7</span><span class=\"token number\">.25</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependencies<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>build<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>plugins<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>plugin<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>maven<span class=\"token punctuation\">.</span>plugins<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>maven<span class=\"token operator\">-</span>compiler<span class=\"token operator\">-</span>plugin<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span><span class=\"token number\">3.2</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>configuration<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>source<span class=\"token punctuation\">></span></span><span class=\"token number\">1.8</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>source<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>target<span class=\"token punctuation\">></span></span><span class=\"token number\">1.8</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>target<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>encoding<span class=\"token punctuation\">></span></span>UTF<span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>encoding<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>configuration<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>plugin<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>plugins<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>build<span class=\"token operator\">></span></pre></td></tr></table></figure><p>在 Java 工程的 src 目录下创建一个 Java 类</p>\n<h2 id=\"2-创建永久节点\"><a class=\"anchor\" href=\"#2-创建永久节点\">#</a> 2、创建永久节点</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">createZnode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 创建节点</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">creatingParentsIfNeeded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">withMode</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CreateMode</span><span class=\"token punctuation\">.</span>PERSISTENT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello2\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"world\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 关闭客户端</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"3-创建临时节点\"><a class=\"anchor\" href=\"#3-创建临时节点\">#</a> 3、创建临时节点</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">createtmpZnode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 创建节点</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">creatingParentsIfNeeded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">withMode</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CreateMode</span><span class=\"token punctuation\">.</span>EPHEMERAL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello3\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"world\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 休眠时间 5s</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">// 关闭客户端</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"4-修改节点数据\"><a class=\"anchor\" href=\"#4-修改节点数据\">#</a> 4、修改节点数据</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setZnodeData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 修改节点数据</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            client<span class=\"token punctuation\">.</span><span class=\"token function\">setData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"zookeeper\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">// 关闭客户端</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"5-查看节点数据\"><a class=\"anchor\" href=\"#5-查看节点数据\">#</a> 5、查看节点数据</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">getZnodeData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 获取节点数据</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> bytes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            bytes <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token comment\">// 关闭客户端</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"6-删除节点\"><a class=\"anchor\" href=\"#6-删除节点\">#</a> 6、删除节点</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">delZnode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 删除节点</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            client<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">// 关闭客户端</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"7-设置watch机制\"><a class=\"anchor\" href=\"#7-设置watch机制\">#</a> 7、设置 watch 机制</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">watchZnode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 设置节点的 cache, 指定监控的节点</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token class-name\">TreeCache</span> treeCache <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TreeCache</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 自定义一个监听器</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        treeCache<span class=\"token punctuation\">.</span><span class=\"token function\">getListenable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">TreeCacheListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">childEvent</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CuratorFramework</span> curatorFramework<span class=\"token punctuation\">,</span> <span class=\"token class-name\">TreeCacheEvent</span> treeCacheEvent<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token class-name\">ChildData</span> data <span class=\"token operator\">=</span> treeCacheEvent<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>data <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>treeCacheEvent<span class=\"token punctuation\">.</span><span class=\"token function\">getType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                        <span class=\"token keyword\">case</span> NODE_ADDED<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"监控到有新增节点\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                        <span class=\"token keyword\">case</span> NODE_REMOVED<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"监控到节点被移除\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                        <span class=\"token keyword\">case</span> NODE_UPDATED<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"监控到节点被更新\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token comment\">// 开始监听</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            treeCache<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token comment\">// 设置延时</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">500000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E7%9A%84watch%E6%9C%BA%E5%88%B6/",
            "url": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E7%9A%84watch%E6%9C%BA%E5%88%B6/",
            "title": "Zookeeper的watch和选举机制",
            "date_published": "2020-11-23T10:50:38.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记和习题整理<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"zookeeper的watch和选举机制\"><a class=\"anchor\" href=\"#zookeeper的watch和选举机制\">#</a> Zookeeper 的 watch 和选举机制</h1>\n<h2 id=\"1-选举机制\"><a class=\"anchor\" href=\"#1-选举机制\">#</a> 1、选举机制</h2>\n<p>半数机制：集群中半数以上机器存活，集群可用。所以 zookeeper 适合安装奇数台服务器。Zookeeper 工作时，是有一个节点为 Leader，其他则为 Follower，Leader 是通过内部的选举机制临时产生的。</p>\n<p>假设有五台服务器组成的 Zookeeper 集群，它们的 id 为 1-5，没有历史数据，在存放数据量这一点上，都是一样的。假设这些服务器依序启动，它们之间会通过选举机制选出 Leader</p>\n<h3 id=\"过程详解\"><a class=\"anchor\" href=\"#过程详解\">#</a> 过程详解：</h3>\n<p><em>服务器 1 启动</em>，发起一次选举。服务器 1 投自己一票。此时服务器 1, 票数一票，不够半数以上（3 票），选举无法完成，服务器 1 状态保持为 LOOKING；</p>\n<p><em>服务器 2 启动</em>，再发起一次选举。服务器 1 和 2 分别投自己一票并交换选票信息：此时服务器 1 发现服务器 2 的 ID 比自己目前投票推举的（服务器 1）大，更改选票为推举服务器 2。此时服务器 1 票数 0 票，服务器 2 票数 2 票，没有半数以上结果，选举无法完成，服务器 1，2 状态保持 LOOKING</p>\n<p><em>服务器 3 启动</em>，发起一次选举。此时服务器 1 和 2 都会更改选票为服务器 3。此次投票结果：服务器 1 为 0 票，服务器 2 为 0 票，服务器 3 为 3 票。此时服务器 3 的票数已经超过半数，服务器 3 当选 Leader。服务器 1，2 更改状态为 FOLLOWING，服务器 3 更改状态为 LEADING；</p>\n<p><em>服务器 4 启动</em>，发起一次选举。此时服务器 1，2，3 已经不是 LOOKING 状态，不会更改选票信息。交换选票信息结果：服务器 3 为 3 票，服务器 4 为 1 票。此时服务器 4 服从多数，更改选票信息为服务器 3，并更改状态为 FOLLOWING；</p>\n<p><em>服务器 5 启动</em>，同服务器 4 一样。</p>\n<h2 id=\"1-watch机制\"><a class=\"anchor\" href=\"#1-watch机制\">#</a> 1、watch 机制</h2>\n<p>类似于数据库中的触发器，对某个 Znode 设置 Watcher, 当 Znode 发生变化的时候，WatchManager 会调用对应的 Watcher</p>\n<p>当 Znode 发生删除、修改、创建，子节点发生改变的时候，对应的 Watcher 会得到通知</p>\n<h3 id=\"watcher的特点\"><a class=\"anchor\" href=\"#watcher的特点\">#</a> watcher 的特点</h3>\n<p><strong>一次性触发</strong>：一个 watcher 只会被触发一次，如果需要继续监听，则需要再次添加 watcher</p>\n<p><strong>事件封装</strong>：watcher 得到的事件是被封装过的，包括三个内容 keeperState,evenType,path</p>\n<h4 id=\"常见的监听\"><a class=\"anchor\" href=\"#常见的监听\">#</a> 常见的监听：</h4>\n<p>监听节点数据的变化： <code>get path [watch]</code></p>\n<p>监听子节点增减的变化： <code>ls path [watch]</code></p>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
            "url": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
            "title": "Zookeeper基础知识",
            "date_published": "2020-11-23T06:50:40.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记和习题整理<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"zookeeper基础知识\"><a class=\"anchor\" href=\"#zookeeper基础知识\">#</a> Zookeeper 基础知识</h1>\n<h2 id=\"1-zookeepr的数据类型\"><a class=\"anchor\" href=\"#1-zookeepr的数据类型\">#</a> 1、zookeepr 的数据类型</h2>\n<h3 id=\"与标准文件系统相同之处\"><a class=\"anchor\" href=\"#与标准文件系统相同之处\">#</a> 与标准文件系统相同之处</h3>\n<p>Zookeeper 的数据类型，在结构上拥有一个层次的命名空间，和标准文件系统非常相似，都是采用树形层次结构</p>\n<p>Zookeeper 树中的每个节点称为一个 Znode, 每个节点可以拥有子节点</p>\n<h3 id=\"与标准文件系统不同之处\"><a class=\"anchor\" href=\"#与标准文件系统不同之处\">#</a> 与标准文件系统不同之处</h3>\n<p>Znode 具有文件和目录两种特点。既有文件的数据功能，又有目录作为路径标识的功能，并可以具有子 Znode。znode 具有增、删、改、查等操作</p>\n<p>存储数据大小有限制。它用来管理调度数据，数据通常以 kb 为单位，数据大小至多 1M，通常小于此值</p>\n<p>通过路径引用，且为绝对路径，因此为 &quot;/&quot; 开头</p>\n<p>由 3 部分组成。stat: 状态信息，描述版本、权限等信息\tdata：与该 znode 关联的数据\tchildren：该 znode 下的子节点</p>\n<h2 id=\"znode节点类型\"><a class=\"anchor\" href=\"#znode节点类型\">#</a> Znode 节点类型</h2>\n<p>节点类型在创建时被确定，不能改变</p>\n<p>1、临时节点：在使用期间存在，会话结束后自动删除。不允许拥有子节点</p>\n<p>2、永久节点：只能手动删除，允许拥有子节点</p>\n<p>3、节点具有序列化特性，如果在创建时指定，该 znode 后面会自动追加一个 10 位数字的序列号</p>\n<p>四种类型的 Znode 节点</p>\n<table>\n<thead>\n<tr>\n<th>PERSISTENT:</th>\n<th>永久节点</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>EPHEMERAL:</td>\n<td>临时节点</td>\n</tr>\n<tr>\n<td>PERSISTENT_SEQUENTIAL</td>\n<td>永久节点、序列化</td>\n</tr>\n<tr>\n<td>EPHEMERAL_SEQUENTIAL</td>\n<td>临时节点、序列化</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"zookeeper的shell客户端操作\"><a class=\"anchor\" href=\"#zookeeper的shell客户端操作\">#</a> Zookeeper 的 Shell 客户端操作</h2>\n<h3 id=\"登录zookeeper客户端\"><a class=\"anchor\" href=\"#登录zookeeper客户端\">#</a> 登录 Zookeeper 客户端</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bin<span class=\"token operator\">/</span>zkCli<span class=\"token punctuation\">.</span>sh <span class=\"token operator\">-</span>server master:2181</pre></td></tr></table></figure><h3 id=\"操作实例\"><a class=\"anchor\" href=\"#操作实例\">#</a> 操作实例</h3>\n<p>列出 Path 下的所有 Znode</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token operator\">/</span></pre></td></tr></table></figure><p>创建永久节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">/</span>hello world</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>create <span class=\"token operator\">/</span>hello<span class=\"token operator\">/</span>hello1 world</pre></td></tr></table></figure><p>创建临时节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">-</span>e <span class=\"token operator\">/</span>hello world</pre></td></tr></table></figure><p>创建永久序列化节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">-</span>s <span class=\"token operator\">/</span>hello world</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>create <span class=\"token operator\">-</span>s <span class=\"token operator\">/</span>hello<span class=\"token operator\">/</span>hello1 world</pre></td></tr></table></figure><p>创建临时序列化节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">-</span>e <span class=\"token operator\">-</span>s <span class=\"token operator\">/</span>hello world</pre></td></tr></table></figure><p>修改节点数据</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">set</span> <span class=\"token operator\">/</span>hello zookeeper</pre></td></tr></table></figure><p>删除节点，如果有子 znode 则该命令无效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>delete <span class=\"token operator\">/</span>hello</pre></td></tr></table></figure><p>删除节点，如果有子 znode 则递归删除</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>rmr <span class=\"token operator\">/</span>hello</pre></td></tr></table></figure><p>列出历史记录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>histroy</pre></td></tr></table></figure><h3 id=\"操作命令\"><a class=\"anchor\" href=\"#操作命令\">#</a> 操作命令</h3>\n<p>path: 指 / Znode、data:znode 数据、acl: 权限、watch: 观察</p>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>说明</th>\n<th>参数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>create [-s] [-e] path data acl</td>\n<td>创建 znode</td>\n<td>-s 指顺序节点，-e 指临时节点</td>\n</tr>\n<tr>\n<td>ls  path  [watch]</td>\n<td>列出 path 下所有子 znode</td>\n<td></td>\n</tr>\n<tr>\n<td>get  path  [watch]</td>\n<td>获取 path 对应的 znode 的数据和属性</td>\n<td></td>\n</tr>\n<tr>\n<td>ls2  path  [watch]</td>\n<td>查看 path 所有子 znode 和子 znode 属性</td>\n<td></td>\n</tr>\n<tr>\n<td>set  path  data</td>\n<td>更新节点</td>\n<td></td>\n</tr>\n<tr>\n<td>delete  path</td>\n<td>删除节点，如果有子 znode 则该命令无效</td>\n<td></td>\n</tr>\n<tr>\n<td>rmr  path</td>\n<td>删除节点，如果有子 znode 则递归删除</td>\n<td></td>\n</tr>\n<tr>\n<td>setquota  -n|-b  val  path</td>\n<td>修改 znode 配额</td>\n<td>-n 设置子节点最大个数，-b 设置节点数据最大长度</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"节点属性\"><a class=\"anchor\" href=\"#节点属性\">#</a> 节点属性</h3>\n<p><img data-src=\"%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7.png\" alt=\"\" /></p>\n<p>cZxid:znode 创建的事务 id</p>\n<p>ctime: 节点创建时的时间戳</p>\n<p>mZxid:Znode 被修改的事务 id, 每次对 znode 的修改都会更新 mZxid, 可以确定更新操作的顺序，如果 zxid1 小于 zxid2，说明 zxid1 操作先于 zxid2 发生，zxid 对于整个 zookeeper 都是唯一的</p>\n<p>mtime: 节点最新一次更新发生时的时间戳</p>\n<p>cversion: 子节点的版本号。当 znode 子节点有变化时，值会增加 1</p>\n<p>dataVersion: 数据版本号，每次对节点进行 set 操作，值会增加 1，避免了数据更新的顺序问题</p>\n<p>aclVersion:ACL 的版本号</p>\n<p>ephemeralOwner: 如果节点为临时节点，ephemeralOwner 值表示与该节点绑定的 session id。如果不是，ephemeralOwner 值为 0</p>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/21/Platform-construction/Zookeeper/course-1/Zookeeper%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/",
            "url": "https://methiony.work/2020/11/21/Platform-construction/Zookeeper/course-1/Zookeeper%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/",
            "title": "Zookeeper快速搭建",
            "date_published": "2020-11-21T09:40:19.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记和习题整理<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"zookeeper快速搭建\"><a class=\"anchor\" href=\"#zookeeper快速搭建\">#</a> ZooKeeper 快速搭建</h1>\n<h2 id=\"1-zookeeper的安装部署\"><a class=\"anchor\" href=\"#1-zookeeper的安装部署\">#</a> 1、Zookeeper 的安装部署</h2>\n<h3 id=\"拷贝zookeeper安装包到linux系统下\"><a class=\"anchor\" href=\"#拷贝zookeeper安装包到linux系统下\">#</a> 拷贝 Zookeeper 安装包到 Linux 系统下</h3>\n<h3 id=\"解压到指定目录\"><a class=\"anchor\" href=\"#解压到指定目录\">#</a> 解压到指定目录</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master /]</span><span class=\"token comment\"># tar -zxvf zookeeper-3.6.2.tar.gz -C /opt/bigdata/</span></pre></td></tr></table></figure><h3 id=\"配置修改\"><a class=\"anchor\" href=\"#配置修改\">#</a> 配置修改</h3>\n<h4 id=\"optbigdatazookeeper-362conf这个路径下的zoo_samplecfg修改为zoocfg如果存在zoocfg文件则不需要拷贝zoo_samplecfg\"><a class=\"anchor\" href=\"#optbigdatazookeeper-362conf这个路径下的zoo_samplecfg修改为zoocfg如果存在zoocfg文件则不需要拷贝zoo_samplecfg\">#</a> /opt/bigdata/zookeeper-3.6.2/conf 这个路径下的 zoo_sample.cfg 修改为 zoo.cfg (如果存在 zoo.cfg 文件则不需要拷贝 zoo_sample.cfg)</h4>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master /]</span><span class=\"token comment\"># cp zoo_sample.cfg zoo.cfg</span></pre></td></tr></table></figure><p>打开 zoo.cfg 文件，修改 dataDir 路径，文件内容末尾添加内容</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dataDir=/opt/bigdata/zookeeper-3.6.2/zkData</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>server.1=master:2888:3888</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>server.2=node1:2888:3888</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>server.3=node2:2888:3888</pre></td></tr></table></figure><p>创建 zkData 文件夹</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token comment\"># mkdir /opt/bigdata/zookeeper-3.6.2/zkData</span></pre></td></tr></table></figure><p>在 /opt/bigdata/zookeeper-3.6.2/zkData 这个目录上创建 myid 文件</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zkData]</span><span class=\"token comment\"># touch myid</span></pre></td></tr></table></figure><p>编辑 myid 文件 (其他机器上修改对应的 server 的数字)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zkData]</span><span class=\"token comment\"># vi myid</span></pre></td></tr></table></figure><pre><code>1\n</code></pre>\n<p>拷贝分发到 node1、node2</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master bigdata]</span><span class=\"token comment\"># scp -r zookeeper-3.6.2 node1:$PWD</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@master bigdata]</span><span class=\"token comment\"># scp -r zookeeper-3.6.2 node2:$PWD</span></pre></td></tr></table></figure><p>在 node1、node2 修改 myid 文件</p>\n<h2 id=\"2-zookeeper启动与操作\"><a class=\"anchor\" href=\"#2-zookeeper启动与操作\">#</a> 2、 Zookeeper 启动与操作</h2>\n<h3 id=\"启动zookeeper\"><a class=\"anchor\" href=\"#启动zookeeper\">#</a> 启动 Zookeeper</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token comment\">#bin/zkServer.sh start</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ZooKeeper JMX enabled by default</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">Using</span> config: <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>2<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>conf<span class=\"token operator\">/</span>zoo<span class=\"token punctuation\">.</span>cfg</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Starting zookeeper <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> STARTED     <span class=\"token comment\"># 这时，一般就启动成功了</span></pre></td></tr></table></figure><h3 id=\"查看进程是否启动\"><a class=\"anchor\" href=\"#查看进程是否启动\">#</a> 查看进程是否启动</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token comment\">#jps</span></pre></td></tr></table></figure><h3 id=\"查看状态\"><a class=\"anchor\" href=\"#查看状态\">#</a> 查看状态</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token comment\">#bin/zkServer.sh status</span></pre></td></tr></table></figure><h3 id=\"启动客户端\"><a class=\"anchor\" href=\"#启动客户端\">#</a> 启动客户端</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token comment\">#bin/zkCli.sh</span></pre></td></tr></table></figure><h3 id=\"退出客户端\"><a class=\"anchor\" href=\"#退出客户端\">#</a> 退出客户端</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[zk: localhost:2181(CONNECTED) 0]</span> quit</pre></td></tr></table></figure><h3 id=\"停用zookeeper\"><a class=\"anchor\" href=\"#停用zookeeper\">#</a> 停用 Zookeeper</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token comment\">#bin/zkServer.sh stop</span></pre></td></tr></table></figure>",
            "tags": []
        }
    ]
}