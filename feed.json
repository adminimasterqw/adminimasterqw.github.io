{
    "version": "https://jsonfeed.org/version/1",
    "title": "Andrésen",
    "description": "",
    "home_page_url": "https://methiony.work",
    "items": [
        {
            "id": "https://methiony.work/2020/12/04/Platform-construction/Hadoop/course-2/Hdaoop%E7%9A%84%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/",
            "url": "https://methiony.work/2020/12/04/Platform-construction/Hadoop/course-2/Hdaoop%E7%9A%84%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/",
            "title": "Hdaoop的伪分布式集群搭建",
            "date_published": "2020-12-04T03:40:16.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/",
            "url": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/",
            "title": "Hive的基本概念",
            "date_published": "2020-12-04T01:23:45.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"1hive的基本概念\"><a class=\"anchor\" href=\"#1hive的基本概念\">#</a> 1.Hive 的基本概念</h1>\n<h2 id=\"11hive简介\"><a class=\"anchor\" href=\"#11hive简介\">#</a> 1.1.Hive 简介</h2>\n<h3 id=\"hive的概念\"><a class=\"anchor\" href=\"#hive的概念\">#</a> Hive 的概念</h3>\n<p>Hve 是基于 Hadoop 的一个数据仓库工具，可以将结构化的数据文件映射为一张数据库表，并提供类 SQL 查询功能<br />\n其本质是将 SQL 转换为 MapReduce 的任务进行运算，底层由 HDFS 来提供数据的存储，说白了 hive 可以理解为一个将 SQL 转换为 MapReduce 的任务的工具，甚至更进一步可以说 hive 就是一个 Map Reduce 的客户端</p>\n<h3 id=\"hive的优点\"><a class=\"anchor\" href=\"#hive的优点\">#</a> Hive 的优点</h3>\n<p>1、采用类 SQL 语法去操作数据，提供快速开发的能力<br />\n 2、避免了去写 MapReduce, 减少开发人员的学习成本<br />\n 3、功能扩展很方便</p>\n<p>4、用户接口：包括 CLI、JDBC/ODBC、 WebGUI, 其中，CLI (command line interface) 为 shell 命令行；JDBC/ODBC 是 Hive 的 JAVA 实现，与传统数据库 JDBC 类似；WebGUI 是通过浏览器访问 Hive<br />\n5、元数据存储：通常是存储在关系数据库如 mysql/derby 中。Hve 将元数据存储在数据库中。Hive 中的元数据包括表的名字，表的列和分区及其属性，表的属性 (是否为外部表等), 表的数据所在目录等<br />\n 6、解释器、编译器、优化器、执行嚣：完成 HQL 査询语句从词法分析、语法分析、编译、优化以及查询计划的生成。生成的查询计划存储在 HDFS 中，并在随后有 MapReduce 调用执行</p>\n<h2 id=\"12hive与-hadoop的关系\"><a class=\"anchor\" href=\"#12hive与-hadoop的关系\">#</a> 1.2.Hive 与 Hadoop 的关系</h2>\n<p>Hive 利用 HDFS 存储数据利用 MapReduce 查询分析数据</p>\n<h2 id=\"13hive与传统数据库对比\"><a class=\"anchor\" href=\"#13hive与传统数据库对比\">#</a> 1.3.Hive 与传统数据库对比</h2>\n<p>hive 用于海量数据的离线数据分析</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>Hive</th>\n<th>RDBMS</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>查询语言</td>\n<td>HQL</td>\n<td>SQL</td>\n</tr>\n<tr>\n<td>数据存储</td>\n<td>HDFS</td>\n<td>Raw Device or Local FS</td>\n</tr>\n<tr>\n<td>执行</td>\n<td>MapReduce</td>\n<td>Excutor</td>\n</tr>\n<tr>\n<td>执行延迟</td>\n<td>高</td>\n<td>低</td>\n</tr>\n<tr>\n<td>处理数据规模</td>\n<td>大</td>\n<td>小</td>\n</tr>\n<tr>\n<td>索引</td>\n<td>0.8 版本后加入位图索引</td>\n<td>复杂的索引</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"14hive的安装\"><a class=\"anchor\" href=\"#14hive的安装\">#</a> 1.4.Hive 的安装</h2>\n<p>下载地址为:http:/archive.apache.org/dist/<br />\n 下载之后，将我们的安装包上传到第三台机器的 /usr/local/src 目录下面去</p>\n<h3 id=\"第一步上传并解压安装包\"><a class=\"anchor\" href=\"#第一步上传并解压安装包\">#</a> 第一步：上传并解压安装包</h3>\n<p>将我们的 hive 的安装包上传到第三台服务器的 /usr/local/src 路径下，然后进行解压</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/src </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">tar</span> -zxvf apache-hive-1.1.0-bin.tar.gz</pre></td></tr></table></figure><h3 id=\"第二步修改hive的配置文件\"><a class=\"anchor\" href=\"#第二步修改hive的配置文件\">#</a> 第二步：修改 hive 的配置文件</h3>\n<p>修改 <span class=\"exturl\" data-url=\"aHR0cDovL2hpdmUtZW55LnNo\">hive-eny.sh</span></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/src/apache-hive-1.1.0-bin/conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">cp</span> hive-env.sh.template hive-env.sh</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">HADOOP_HOME</span><span class=\"token operator\">=</span>/usr/local/src/hadoop-2.6.0</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">HIVE_CONF_DIR</span><span class=\"token operator\">=</span>/usr/local/src/apache-hive-1.1.0</pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vi</span> hive-site.xml</pre></td></tr></table></figure><figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1. 0\" encoding=\"UTF-8 standalone=\"no\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token prolog\">&lt;?xml-stylesheet type=\"text/xsl\"href=\"configuration. xsl\"?></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>avax.jdo.option.ConnectionUserName<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>root<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>javax.jdo.option.ConnectionPassword<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>123456<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>javax.jdo.option.ConnectionURL<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>jdbc:mysql://node01:3306/hive?</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>createDatabaseIfNotExist=true<span class=\"token entity named-entity\" title=\"&amp;\">&amp;amp;</span>useSSL-false<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>javax.jdo.option.ConnectionDriverName<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>com.mysql.jdbc.Driver<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">&lt;!-- 以下配置可省略 --></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>hive.metastore.schema.verification<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>false<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>propertv</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>datanucleus.schema.autoCreateAll<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>hive.server2.thrift.bind.host<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node03<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h3 id=\"第三步配置hive的环境变量可省略\"><a class=\"anchor\" href=\"#第三步配置hive的环境变量可省略\">#</a> 第三步：配置 hive 的环境变量（可省略）</h3>\n<p>node03 服务器执行以下命令配置 hⅳve 的环境变量</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vi</span> /etc/profile</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">HIVE_HOME</span><span class=\"token operator\">=</span>/usr/local/src/apache-hive-1.1.1-bin</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span>:<span class=\"token variable\">$SHIVE_HOME</span>/bin: SPATH</pre></td></tr></table></figure><h3 id=\"第四步添加mysql的连接驱动包\"><a class=\"anchor\" href=\"#第四步添加mysql的连接驱动包\">#</a> 第四步：添加 mysql 的连接驱动包</h3>\n<p>hive 使用 mysql 作为元数据存储，必然需要连接 mysql 数据库，所以我们添加一个 mysql 的连接驱动包到 hive 的安装目录下，然后就可以准备启动 hive 了</p>\n<p>将我们准备好的 mysql-connector-java-5.1.38.jar 这个 jar 包直接上传到<br />\n /usr/local/src/ apache-hive1.1.0-bin/1ib 这个目录下即可<br />\n至此，hive 的安装部署已经完成。</p>\n<h2 id=\"15hve的交互方式\"><a class=\"anchor\" href=\"#15hve的交互方式\">#</a> 1.5.Hve 的交互方式</h2>\n<h3 id=\"客户端操作\"><a class=\"anchor\" href=\"#客户端操作\">#</a> 客户端操作</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/src/apache-hive-1.1.1-bin/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>bin/hive</pre></td></tr></table></figure><p>创建一个数据库</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create database <span class=\"token keyword\">if</span> not exists mytest<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"非客户端操作\"><a class=\"anchor\" href=\"#非客户端操作\">#</a> 非客户端操作</h3>\n<p>使用 sq1 语句或者 sq1 脚本进行交互不进入 hive 的客户端直接执行 hive 的 hql 语句</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/src/apache-hive-1.1.1-bin/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>bin/hive -e <span class=\"token string\">\"create database if not exists mytest;\"</span></pre></td></tr></table></figure><p>或者将我们的 hql 语句写成一个 sql 脚本然后执行</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/src</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vi</span> hive.sql</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>create database <span class=\"token keyword\">if</span> not exists mytest<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>use mytest</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>create table stu<span class=\"token punctuation\">(</span>id int, name string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>通过 hive-f 来执行我们的 sql 脚本</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bin/hive -f /usr/local/src/hive.sql</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E8%B0%83%E4%BC%98/",
            "url": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E8%B0%83%E4%BC%98/",
            "title": "Hive的调优",
            "date_published": "2020-12-04T00:48:12.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F/",
            "url": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F/",
            "title": "Hive的数据存储格式",
            "date_published": "2020-12-04T00:47:45.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8E%8B%E7%BC%A9/",
            "url": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8E%8B%E7%BC%A9/",
            "title": "Hive的数据压缩",
            "date_published": "2020-12-04T00:47:27.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E5%87%BD%E6%95%B0/",
            "url": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E5%87%BD%E6%95%B0/",
            "title": "Hive的函数",
            "date_published": "2020-12-04T00:47:10.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hive的函数\"><a class=\"anchor\" href=\"#hive的函数\">#</a> Hive 的函数</h1>\n<h2 id=\"1-常用函数\"><a class=\"anchor\" href=\"#1-常用函数\">#</a> 1、常用函数</h2>\n<p>求总行数 (count)</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> count<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> from score<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>求分数的最大值 (max</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> max<span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span> from score<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>求分数的最小值 (min)</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> min<span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span> from score<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>求分数的总和 (sum)</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> sum<span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span> from score<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>求分数的平均值 (avg)</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> avg<span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span> from score<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"2-limit语句\"><a class=\"anchor\" href=\"#2-limit语句\">#</a> 2、LIMIT 语句</h2>\n<p>典型的查询会返回多行数据。LIMIT 子句用于限制返回的行数。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score limit <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"3-where语句\"><a class=\"anchor\" href=\"#3-where语句\">#</a> 3、where 语句</h2>\n<p>查询分数等于 80 的所有的数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where s_score <span class=\"token operator\">=</span> <span class=\"token number\">80</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查询分数在 80 到 100 的所有数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where s_score between <span class=\"token number\">80</span> and <span class=\"token number\">100</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查询成绩空的所有数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where s_score is null<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查询成绩是 80 和 90 的数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where s_score in<span class=\"token punctuation\">(</span><span class=\"token number\">80</span>, <span class=\"token number\">90</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"4-lke和rlke\"><a class=\"anchor\" href=\"#4-lke和rlke\">#</a> 4、LKE 和 RLKE</h2>\n<p>1. 使用 LIKE 运算选择类似的值<br />\n 2. 选择条件可以包含字符或数字</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>% 代表零个或多个字符(任意个字符)。</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>_代表一个字符。</pre></td></tr></table></figure><p>3.RLKE 子句是 Hive 中这个功能的一个扩展，其可以通过 Java 的正则表达式这个更强大的语言来指定匹配条件。</p>\n<p>4. 案例实操<br />\n查找以 8 开头的所有成绩</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where s_score like <span class=\"token string\">'8%'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查找第二个数值为 9 的所有成绩数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where s_score like <span class=\"token string\">'_9%'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查找 sid 中含 1 的数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where s_id rlike <span class=\"token string\">'[1]'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\"># like '%1%'</span></pre></td></tr></table></figure><h2 id=\"5-逻辑运算符\"><a class=\"anchor\" href=\"#5-逻辑运算符\">#</a> 5、逻辑运算符</h2>\n<table>\n<thead>\n<tr>\n<th>操作符</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>AND</td>\n<td>逻辑并</td>\n</tr>\n<tr>\n<td>OR</td>\n<td>逻辑或</td>\n</tr>\n<tr>\n<td>NOT</td>\n<td>逻辑否</td>\n</tr>\n</tbody>\n</table>\n<p>查询成绩大于 80, 并且 s_id 是 01 的数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where s_score <span class=\"token operator\">></span><span class=\"token number\">80</span> and s_id <span class=\"token operator\">=</span> <span class=\"token string\">'01'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查询成绩大于 80, 或者 sid 是 01 的数</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where s_score <span class=\"token operator\">></span><span class=\"token number\">80</span> or s_id <span class=\"token operator\">=</span><span class=\"token string\">'01'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查询 s_id 不是 01 和 02 的学生</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where s_id not <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'01'</span>,<span class=\"token string\">'02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive-Shell%E5%8F%82%E6%95%B0/",
            "url": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive-Shell%E5%8F%82%E6%95%B0/",
            "title": "Hive Shell参数",
            "date_published": "2020-12-04T00:46:47.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95/",
            "url": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95/",
            "title": "Hive的查询语法",
            "date_published": "2020-12-04T00:46:24.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hive查询语法\"><a class=\"anchor\" href=\"#hive查询语法\">#</a> Hive 查询语法</h1>\n<h2 id=\"1-selec\"><a class=\"anchor\" href=\"#1-selec\">#</a> 1、SELEC</h2>\n<pre><code>SELECT [ALL | DISTINCT] select_expr, select_expr,...\nFROM table_reference\n[WHERE where_condition]\n[GROUP BY col_list [HAVING condition]]\n[CLUSTER BY col_list | [DISTRIBUTE BY col_list] [ SORT BY | ORDER BY col_list]]\n[LIMIT number]\n</code></pre>\n<p>order by 会对输入做全局排序，因此只有一个 reducer, 会导致当输入规模较大时，需要较长的计算时间。</p>\n<p>sort by 不是全局排序，其在数据进入 reducer 前完成排序。因此，如果用 sort by 进行排序，并且设置 mapred.reduce.tasks&gt;1, 则 sort by 只保证每个 reduce 的输出有序，不保证全局有序。</p>\n<p>distribute by (字段) 根据指定的字段将数据分到不同的 reducer, 且分发算法是 hash 散列.</p>\n<p>cluster by (字段) 除了具有 distribute by 的功能外，还会对该字段进行排序<br />\n因此，如果 distribute 和 sort 字段是同一个时，此时，cluster by= distribute by  + sort by</p>\n<h2 id=\"2-分组\"><a class=\"anchor\" href=\"#2-分组\">#</a> 2、分组</h2>\n<h3 id=\"21group-by语句\"><a class=\"anchor\" href=\"#21group-by语句\">#</a> 2.1.GROUP BY 语句</h3>\n<p>GROUP BY 语句通常会和聚合函数一起使用，按照一个或者多个列队结果进行分组，然后对每个组执行聚合操作。</p>\n<p>案例实操<br />\n计算每个学生的平均分数</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> s_id, avg<span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span> from score group by s_id<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>计算每个学生最高成绩</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> s_id ,max<span class=\"token punctuation\">(</span>s.score<span class=\"token punctuation\">)</span> from score group by s_id<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"22having语句\"><a class=\"anchor\" href=\"#22having语句\">#</a> 2.2.HAVING 语句</h3>\n<h4 id=\"having与-where不同点\"><a class=\"anchor\" href=\"#having与-where不同点\">#</a> having 与 where 不同点</h4>\n<p>where 针对表中的列发挥作用，查询数据；having 针对查询结果中的列发挥作用，筛<br />\n选数据。<br />\nwhere 后面不能写分组函数，而 hang 后面可以使用分组函数 having 只用于 group by 分组统计语句</p>\n<h4 id=\"案例实操\"><a class=\"anchor\" href=\"#案例实操\">#</a> 案例实操:</h4>\n<p>求每个学生的平均分数</p>\n<pre><code>select s_id, avg(s_score) from score group by s_id;\n</code></pre>\n<p>求每个学生平均分数大于 85 的人</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> s_id ,avg<span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span> avgscore from score group by s_id having avgscore <span class=\"token operator\">></span><span class=\"token number\">85</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"23join语句\"><a class=\"anchor\" href=\"#23join语句\">#</a> 2.3.JOIN 语句</h3>\n<p>等值 JOIN<br />\nHⅳve 支持通常的 SQL JOIN 语句，但是只支持等值连接，不支持非等值连接。<br />\n案例操作:</p>\n<p>查询分数对应的姓名</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> s.s_id, s.s_score, stu.s_name, stu.s_birth from score s <span class=\"token function\">join</span> student stu on s.s_id <span class=\"token operator\">=</span> stu s_id<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"24表的别名\"><a class=\"anchor\" href=\"#24表的别名\">#</a> 2.4. 表的别名</h3>\n<p>好处<br />\n使用别名可以简化查询。<br />\n使用表名前缀可以提高执行效率</p>\n<p>案例实操<br />\n合并老师与课程表</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from techer t <span class=\"token function\">join</span> course c on t.t_id <span class=\"token operator\">=</span> c.t_id<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"25内连接\"><a class=\"anchor\" href=\"#25内连接\">#</a> 2.5. 内连接</h3>\n<p>内连接：只有进行连接的两个表中都存在与连接条件相匹配的数据才会被保留下来。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from techer t inner <span class=\"token function\">join</span> course c on t.t_id <span class=\"token operator\">=</span> c.t_id<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"26左外连接\"><a class=\"anchor\" href=\"#26左外连接\">#</a> 2.6. 左外连接</h3>\n<p>左外连接：JOIN 操作符左边表中符合 WHERE 子句的所有记录将会被返回。</p>\n<p>查询老师对应的课程</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from techer t left <span class=\"token function\">join</span> course c on t.t_id <span class=\"token operator\">=</span> c.t_id<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"27右外连接\"><a class=\"anchor\" href=\"#27右外连接\">#</a> 2.7. 右外连接</h3>\n<p>右外连接：JOIN 操作符右边表中符合 WHERE 子句的所有记录将会被返回。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from techer t right <span class=\"token function\">join</span> course c on t.t_id <span class=\"token operator\">=</span> c.t_id<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"28多表连接\"><a class=\"anchor\" href=\"#28多表连接\">#</a> 2.8. 多表连接</h3>\n<p>注意：连接 n 个表，至少需要 n-1 个连接条件。例如：连接三个表，至少需要两个连接条件。<br />\n多表连接査询，查询老师对应的课程，以及对应的分数，对应的学生</p>\n<pre><code>select * from teacher\nleft join course c\non t.t_id = c.t_id\nleft join score s\non s.c_id = c.c_id\nleft join student stu\non s.s_id =  stu.s_id;\n</code></pre>\n<p>大多数情况下，Hive 会对每对 JOIN 连接对象启动一个 MapReduce 任务。本例中会首先启动一个 MapReduce job 对表 techer 和表 course 进行连接操作，然后会再启动一个 MapReduce job 将第<br />\n个 MapReduce job 的输出和表 score; 进行连接操作。</p>\n<h2 id=\"3-排序\"><a class=\"anchor\" href=\"#3-排序\">#</a> 3、排序</h2>\n<h3 id=\"31全局排序\"><a class=\"anchor\" href=\"#31全局排序\">#</a> 3.1. 全局排序</h3>\n<p>Order By：全局排序，一个 reduce</p>\n<p>使用 ORDER BY 子句排序</p>\n<p>ASC (ascend): 升序 (默认)</p>\n<p>DESC (descend): 降序</p>\n<p>ORDER BY 子句在 SELECT 语句的结尾</p>\n<p>案例实操<br />\n查询学生的成绩，并按照分数降序排列</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>SELECT * FROM student s LEFT JOIN score sco ON s.s_id <span class=\"token operator\">=</span> sco.s_id ORDER BY sco.s_score DESC<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查询学生的成绩，并按照分数升序排列</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>SELECT * FROM student s LEFT JOIN score sco ON s.s_id <span class=\"token operator\">=</span> sco.s_id ORDER BY sco.s_score asc<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"32别名排序\"><a class=\"anchor\" href=\"#32别名排序\">#</a> 3.2. 别名排序</h3>\n<p>按照分数的平均值排序</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> s_id, avg<span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span> avg from score group by s_id order by avg<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"33多个列排序\"><a class=\"anchor\" href=\"#33多个列排序\">#</a> 3.3. 多个列排序</h3>\n<p>按照学生 id 和平均成绩进行排序</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> s_id, avg<span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span> avg from score group by s_id order by s_id,avg<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"34局部排序\"><a class=\"anchor\" href=\"#34局部排序\">#</a> 3.4. 局部排序</h3>\n<p>每个 MapReduce 内部排序 (Sort By) 局部排序<br />\n Sort By：每个 MapReduce 内部进行排序，对全局结果集来说不是排序<br />\n设置 reduce 个数</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">set</span> mapreduce.job.reduces<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查看设置 reduce 个数</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">set</span> mapreduce.job.reduces<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查询成绩按照成绩降序排列</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score <span class=\"token function\">sort</span> by s_score<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>将查询结果导入到文件中 (按照成绩降序排列)</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>insert overwrite <span class=\"token builtin class-name\">local</span> directory <span class=\"token string\">'/usr/local/src/hivedatas/sort'</span> <span class=\"token keyword\">select</span> * from score <span class=\"token function\">sort</span> by s_score<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"4-分区排序-distribute-by\"><a class=\"anchor\" href=\"#4-分区排序-distribute-by\">#</a> 4、分区排序 (DISTRIBUTE BY)</h2>\n<h3 id=\"41distribute-by\"><a class=\"anchor\" href=\"#41distribute-by\">#</a> 4.1.Distribute By</h3>\n<p>类似 MR 中 partition, 进行分区，结合 sort by 使用</p>\n<p>注意，Hive 要求 D| STRIBUTE BY 语句要写在 SORT BY 语句之前。</p>\n<p>对于 distribute by 进行测试，一定要分配多 reduce 进行处理，否则无法看到 distribute by 的效果</p>\n<p>案例实操:</p>\n<p>先按照学生 id 进行分区，再按照学生成绩进行排序。<br />\n设置 reduce 的个数，将我们对应的 s_id 划分到对应的 reduce 当中去</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">set</span> mapreduce.job.reduces<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>通过 distribute by 进行数据的分区</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>insert overwrite <span class=\"token builtin class-name\">local</span> directory <span class=\"token string\">'/export/servers/hivedatas/sort'</span> <span class=\"token keyword\">select</span> * from score distribute by s_id <span class=\"token function\">sort</span> by s_score<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"42-cluster-by\"><a class=\"anchor\" href=\"#42-cluster-by\">#</a> 4.2. CLUSTER BY</h3>\n<p>当 distribute by 和 sort by 字段相同时，可以使用 cluster by 方式。</p>\n<p>cluster by 除了具有 distribute by 的功能外还兼具 sort by 的功能。但是排序只能是倒序排序，不能指定排序规则为 ASC 或者 DESC</p>\n<p>以下两种写法等价</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score cluster by s_id<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">select</span> * from score distribute by s_id <span class=\"token function\">sort</span> by s_id<span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/",
            "url": "https://methiony.work/2020/12/04/Platform-construction/Hive/course-5/Hive%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/",
            "title": "Hive的基本操作",
            "date_published": "2020-12-04T00:46:02.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"1hive的基本操作\"><a class=\"anchor\" href=\"#1hive的基本操作\">#</a> 1.Hive 的基本操作</h1>\n<h2 id=\"11数据库操作\"><a class=\"anchor\" href=\"#11数据库操作\">#</a> 1.1 数据库操作</h2>\n<h3 id=\"111创建数据库\"><a class=\"anchor\" href=\"#111创建数据库\">#</a> 1.1.1 创建数据库</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create database <span class=\"token keyword\">if</span> not exists myhive<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>use myhive<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>说明:hive 的表存放位置模式是由 hive-site.xml 当中的一个属性指定的</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>hive.metastore.warehouse.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/user/hive/warehouse<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h3 id=\"112刨建数据库并指定位置\"><a class=\"anchor\" href=\"#112刨建数据库并指定位置\">#</a> 1.1.2 刨建数据库并指定位置</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create database myhive2 location <span class=\"token string\">'/myhive2'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"113设置数据库键值对信息\"><a class=\"anchor\" href=\"#113设置数据库键值对信息\">#</a> 1.1.3 设置数据库键值对信息</h3>\n<p>数据库可以有一些描述性的键值对信息，在创建时添加:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create database foo with dbproperties <span class=\"token punctuation\">(</span><span class=\"token string\">'owner'</span><span class=\"token operator\">=</span><span class=\"token string\">'itcast'</span>,</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token string\">'date'</span><span class=\"token operator\">=</span><span class=\"token string\">'28198128'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查看数据库的键值对信息</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>describe database extended foo<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>修改数据库的键值对信息</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>alter database foo <span class=\"token builtin class-name\">set</span> dbproperties <span class=\"token punctuation\">(</span><span class=\"token string\">'owner'</span><span class=\"token operator\">=</span><span class=\"token string\">'itheima'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"114查看数据库更多详细信息\"><a class=\"anchor\" href=\"#114查看数据库更多详细信息\">#</a> 1.1.4 查看数据库更多详细信息</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>desc database extended myhive2<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"115删除数据库\"><a class=\"anchor\" href=\"#115删除数据库\">#</a> 1.1.5 删除数据库</h3>\n<p>删除一个空数据库，如果数据库下面有数据表，那么就会报错</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>drop database myhive2<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>强制删除数据库，包含数据库下面的表一起删除</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>drop database myhive cascade<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"12数据库表操作\"><a class=\"anchor\" href=\"#12数据库表操作\">#</a> 1.2 数据库表操作</h2>\n<h3 id=\"121创建表的语法\"><a class=\"anchor\" href=\"#121创建表的语法\">#</a> 1.2.1 创建表的语法</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token punctuation\">[</span>external<span class=\"token punctuation\">]</span> table <span class=\"token punctuation\">[</span>if not exists<span class=\"token punctuation\">]</span> table_name<span class=\"token punctuation\">(</span>col_name data_type<span class=\"token punctuation\">[</span>comment <span class=\"token string\">'字段描述信息'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>col_name data_type<span class=\"token punctuation\">[</span>comment <span class=\"token string\">'字段描述信息'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>comment <span class=\"token string\">'表的描述信息'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>partitioned by <span class=\"token punctuation\">(</span>col_name data-type,<span class=\"token punctuation\">..</span>.<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>clustered by <span class=\"token punctuation\">(</span>col_name,col_name,<span class=\"token punctuation\">..</span>.<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>sorted by <span class=\"token punctuation\">(</span>col_name <span class=\"token punctuation\">[</span>asc<span class=\"token operator\">|</span>desc<span class=\"token punctuation\">]</span><span class=\"token punctuation\">..</span>.<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>into num_buckets buckets<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">[</span>row <span class=\"token function\">format</span> row_format<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span>stored as <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">[</span>location <span class=\"token string\">'指定表的路径'</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>说明</p>\n<p>1、create table<br />\n 创建一个指定名字的表。如果相同名字的表已经存在，则抛出异常；用户可以用 IF NOT EXISTS 选项来忽略这个异常。</p>\n<p>2、external<br />\n 可以让用户创建一个外部表，在建表的同时指定一个指向实际数据的路径<br />\n (LOCATION),Hive 创建内部表时，会将数据移动到数据仓库指向的路径；若创建外部表，仅记录数据所在的路径，不对数据的位置做任何改变。在删除表的时候，内部表的元数据和数据会被一起删除，而外部表只删除元数据，不删除数据</p>\n<p>3、comment<br />\n 表示释，默认不能使用中文</p>\n<p>4、partitioned by<br />\n 表示使用表分区，一个表可以拥有一个或者多个分区，每一个分区单独存在一个目录下</p>\n<p>5、clustered by 对于每一个表分文件，Hive 可以进一步组织成桶，也就是说桶是更为细粒度的数据范围划分。Hive 也是针对某一列进行桶的组织。</p>\n<p>6、sorted by<br />\n 指定排序字段和排序规则</p>\n<p>7、row format<br />\n 指定表文件字段分隔符</p>\n<p>8、stored as 指定表文件的存储格式，常用格式 SEQUENCEFILE,,TEXTFILE, RCFILE, 如果文件数据是纯文本，可以使用 STORED AS TEXTFILE。如果数据需要压缩，使用 stored as<br />\nSEQUENCEFILE。</p>\n<p>9、location<br />\n 指定表文件的存储路径</p>\n<h3 id=\"122建表入门\"><a class=\"anchor\" href=\"#122建表入门\">#</a> 1.2.2 建表入门</h3>\n<p>建表入门</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>use myhive<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>create table stu<span class=\"token punctuation\">(</span>id int,name string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>insert into stu values<span class=\"token punctuation\">(</span><span class=\"token number\">1</span>,<span class=\"token string\">\"zhangsan\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">#插入数据</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">select</span> * from stu<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>创建表并指定字段之间的分隔符</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create table <span class=\"token keyword\">if</span> not exists stu2<span class=\"token punctuation\">(</span>id int,name string<span class=\"token punctuation\">)</span> row <span class=\"token function\">format</span> delimited fields terminated by <span class=\"token string\">'it'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>创建表并指定表文件的存放路径</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create table <span class=\"token keyword\">if</span> not exists stu2<span class=\"token punctuation\">(</span>id int,name string<span class=\"token punctuation\">)</span> row <span class=\"token function\">format</span> delimited fields terminated by <span class=\"token string\">'<span class=\"token entity\" title=\"\\t\">\\t</span>'</span> location <span class=\"token string\">'/user/stu2'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>根据查询结果创建表</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create table stu3 as <span class=\"token keyword\">select</span> * from stu2<span class=\"token punctuation\">;</span> <span class=\"token comment\">#通过复制表结构和表内容创建新表</span></pre></td></tr></table></figure><p>根据已经存在的表结构创建表</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create table stu4 like stu<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>重询表的详细信息</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>desc formatted stu2<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>删除表</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>drop table stu4<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>加载数据到多分区表中</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>load data <span class=\"token builtin class-name\">local</span> inpath <span class=\"token string\">'/usr/local/src/hivedatas/score.csv'</span> into table</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>score2 partition<span class=\"token punctuation\">(</span>year<span class=\"token operator\">=</span><span class=\"token string\">'2018'</span>, <span class=\"token assign-left variable\">month</span><span class=\"token operator\">=</span><span class=\"token string\">'06'</span>, <span class=\"token assign-left variable\">day</span><span class=\"token operator\">=</span><span class=\"token string\">'01'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>多分区表联合查询使用 (union a11)</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from score where month <span class=\"token operator\">=</span> <span class=\"token string\">'201806'</span> union all <span class=\"token keyword\">select</span> * from score where month <span class=\"token operator\">=</span> <span class=\"token string\">'201806'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>查看分区</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>show partitions score<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>添加一个分区</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>alter table score <span class=\"token function\">add</span> partition<span class=\"token punctuation\">(</span>month<span class=\"token operator\">=</span><span class=\"token string\">'201805'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>删除分区</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>alter table score drop partition <span class=\"token punctuation\">(</span>month <span class=\"token operator\">=</span><span class=\"token string\">'201806'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>加载数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>load data <span class=\"token builtin class-name\">local</span> inpath <span class=\"token string\">'/export/servers/hivedatas/student. csv'</span> into table student<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>加载数据并覆盖已有数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>load data <span class=\"token builtin class-name\">local</span> inpath <span class=\"token string\">'/export/servers/hivedatas/student. csv'</span> overwrite into table student<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>从 hdfs 文件系统向表中加载数据 (需要提前将数据上传到 hdfs 文件系统)</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/src/hivedatas</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hdfs dfs -mkdir -p/hivedatas</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hdfs dfs -put techer.csv /hivedatas/</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>load data inpath<span class=\"token string\">'/hivedatas/techer.csv'</span> into table teacher<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"13分区表的操作\"><a class=\"anchor\" href=\"#13分区表的操作\">#</a> 1.3. 分区表的操作</h2>\n<p>概念</p>\n<p>在大数据中，最常用的种思想就是分治，可以把大的文件切割划分成一个一个的小的文件，这样每次操作一个小的文件就会很容易了，同样的道理，在 hive 当中也是支持这种思想的，就是我们可以把大的数据，按照每月，或者每天进行切分成一个个的小的文件存放在不同的文件夹中</p>\n<p>创建分区表语法</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create table score<span class=\"token punctuation\">(</span>s_id string,c-id string,s_score int<span class=\"token punctuation\">)</span> partitioned by <span class=\"token punctuation\">(</span>month string<span class=\"token punctuation\">)</span> row <span class=\"token function\">format</span> delimited fields terminated by <span class=\"token string\">'<span class=\"token entity\" title=\"\\t\">\\t</span>'</span></pre></td></tr></table></figure><p>创建一个表带多个分区</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create table score2<span class=\"token punctuation\">(</span>s_id string,c_id string, s_score int<span class=\"token punctuation\">)</span> partitioned by</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>year string, month string, day string<span class=\"token punctuation\">)</span> row <span class=\"token function\">format</span> delimited fields terminated by <span class=\"token string\">'<span class=\"token entity\" title=\"\\t\">\\t</span>'</span></pre></td></tr></table></figure><p>加载数据到分区表中</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>load data <span class=\"token builtin class-name\">local</span> inpath <span class=\"token string\">'/export/servers/hivedatas/score.csv'</span> into table</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>score partition<span class=\"token punctuation\">(</span>month<span class=\"token operator\">=</span><span class=\"token string\">'201806'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"14分桶表操作\"><a class=\"anchor\" href=\"#14分桶表操作\">#</a> 1.4. 分桶表操作</h2>\n<p>概念</p>\n<p>分桶，就是将数据按照指定的字段进行划分到多个文件当中去，分桶就是 MapReduce 中的分区</p>\n<p>开启 Hive 的分桶功能</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">set</span> hive.enforce.bucketing<span class=\"token operator\">=</span>true<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>设置 Reduce 个数</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">set</span> mapreduce.job.reduces<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>创建分桶表</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create table course <span class=\"token punctuation\">(</span>c_id string, c_name string, t_id string<span class=\"token punctuation\">)</span> clustered by<span class=\"token punctuation\">(</span>c_id<span class=\"token punctuation\">)</span> into <span class=\"token number\">3</span> buckets row <span class=\"token function\">format</span> delimited fields terminated by <span class=\"token string\">'<span class=\"token entity\" title=\"\\t\">\\t</span>'</span></pre></td></tr></table></figure><p>桶表的数据加载，由于通标的数据加载通过 hdfs dfs-put 文件或者通过 load data 均不好使，只能通过 insert overwrite 创建普通表，并通过 insert overwrite 的方式将普通表的数据通过査询的方式加载到桶表当中去</p>\n<p>创建普通表</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create table course_common<span class=\"token punctuation\">(</span>c_id string, c_name string, t_id string<span class=\"token punctuation\">)</span> row <span class=\"token function\">format</span> delimited fields terminated by <span class=\"token string\">'<span class=\"token entity\" title=\"\\t\">\\t</span>'</span></pre></td></tr></table></figure><p>普通表中加载数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>load data <span class=\"token builtin class-name\">local</span> inpath <span class=\"token string\">'/usr/local/src/hivedatas/course.csv'</span> into table</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>course_common<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>通过 insert overwrite 给桶表中加载数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>insert overwrite table course <span class=\"token keyword\">select</span> * from course_common cluster by<span class=\"token punctuation\">(</span>c_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"15修改表结构\"><a class=\"anchor\" href=\"#15修改表结构\">#</a> 1.5. 修改表结构</h2>\n<p>重命名</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>alter table old_table_name <span class=\"token function\">rename</span> to new_table_name<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>把表 scoe4 修改成 score5</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>alter table score4 <span class=\"token function\">rename</span> to score5<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>增加 / 修改列信息<br />\n查询表结构</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>desc score5<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>添加列</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>alter table score5 <span class=\"token function\">add</span> columns<span class=\"token punctuation\">(</span>mycol string, mysco int<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>更新列</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>alter table score5 change <span class=\"token function\">column</span> mysco mysconew int<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>删除表</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>drop table score5<span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/28/Platform-construction/MySQL/course-6/Centos7%E4%B8%8BLinux%E7%B3%BB%E7%BB%9FMySQL%E5%AE%89%E8%A3%85/",
            "url": "https://methiony.work/2020/11/28/Platform-construction/MySQL/course-6/Centos7%E4%B8%8BLinux%E7%B3%BB%E7%BB%9FMySQL%E5%AE%89%E8%A3%85/",
            "title": "Centos7下Linux系统MySQL安装",
            "date_published": "2020-11-28T04:32:27.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程：Linux 下安装 mysql-5.7.24@<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vdS8yMGVjN2U5OWY5MDA=\">开心跳蚤</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8yNzZkNTljYmM1Mjk=\">https://www.jianshu.com/p/276d59cbc529</span></p>\n</div>\n<h1 id=\"centos7下linux系统mysql-5724安装\"><a class=\"anchor\" href=\"#centos7下linux系统mysql-5724安装\">#</a> Centos7 下 Linux 系统 Mysql-5.7.24 安装</h1>\n<h2 id=\"一-检查\"><a class=\"anchor\" href=\"#一-检查\">#</a> 一、检查</h2>\n<p>检查是否已经安装过 mysql</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># rpm -qa | grep mysql</span></pre></td></tr></table></figure><p>如果存在 mysql, 执行删除命令</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># rpm -e --nodeps 相关 MySQL 版本</span></pre></td></tr></table></figure><p>执行查询命令，查看是否删除</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># rpm -qa | grep mysql</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># whereis mysql</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># find / -name mysql</span></pre></td></tr></table></figure><p>删除相关目录或文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#  rm -rf 相关文件</span></pre></td></tr></table></figure><p>执行查询命令，查看是否删除</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># whereis mysql</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># find / -name mysql</span></pre></td></tr></table></figure><p>检查 mysql 用户组和用户是否存在，如果没有，则创建</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/group | grep mysql</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/passwd |grep mysql</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># groupadd mysql</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd -r -g mysql mysql</span></pre></td></tr></table></figure><h2 id=\"二-解压linux的mysql安装包\"><a class=\"anchor\" href=\"#二-解压linux的mysql安装包\">#</a> 二、解压 Linux 的 Mysql 安装包</h2>\n<p>解压并拷贝到 /usr/local/ 目录下</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#  tar xzvf mysql-5.7.24-linux-glibc2.12-x86_64.tar.gz -C /usr/local</span></pre></td></tr></table></figure><p>重命名</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># mv mysql-5.7.24-linux-glibc2.12-x86_64 mysql</span></pre></td></tr></table></figure><p>创建 data 目录</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir /usr/local/mysql/data</span></pre></td></tr></table></figure><p>更改 mysql 目录下所有的目录及文件夹所属的用户组和用户，以及权限</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># chown -R mysql:mysql /usr/local/mysql</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod -R 755 /usr/local/mysql</span></pre></td></tr></table></figure><p>创建 /var/log/mariadb/mariadb.log 路径并给与权限</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#mkdir /var/log/mariadb </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#touch /var/log/mariadb/mariadb.log</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#chown -R mysql:mysql /var/log/mariadb/</span></pre></td></tr></table></figure><p>创建 var/lib/mysql 目录并给与权限</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#mkdir /var/lib/mysql</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#chmod 777  /var/lib/mysql</span></pre></td></tr></table></figure><h2 id=\"三-配置mysql\"><a class=\"anchor\" href=\"#三-配置mysql\">#</a> 三、配置 Mysql</h2>\n<p>编译安装并初始化 mysql,<strong> 记住初始化输出日志末尾的密码</strong>（数据库管理员临时密码）</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd /usr/local/mysql/bin</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost bin<span class=\"token punctuation\">]</span><span class=\"token comment\"># ./mysqld --initialize --user=mysql --datadir=/usr/local/mysql/data --basedir=/usr/local/mysql</span></pre></td></tr></table></figure><p>编辑配置文件 my.cnf</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost bin<span class=\"token punctuation\">]</span><span class=\"token comment\">#  vi /etc/my.cnf</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token assign-left variable\">datadir</span><span class=\"token operator\">=</span>/usr/local/mysql/data</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token assign-left variable\">socket</span><span class=\"token operator\">=</span>/var/lib/mysql/mysql.sock</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">port</span><span class=\"token operator\">=</span><span class=\"token number\">3306</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">sql_mode</span><span class=\"token operator\">=</span>NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token assign-left variable\">max_connections</span><span class=\"token operator\">=</span><span class=\"token number\">600</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">innodb_file_per_table</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token assign-left variable\">lower_case_table_names</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token assign-left variable\">character_set_server</span><span class=\"token operator\">=</span>utf8</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>symbolic-links<span class=\"token operator\">=</span><span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">[</span>client<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token assign-left variable\">port</span><span class=\"token operator\">=</span><span class=\"token number\">3306</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token assign-left variable\">socket</span><span class=\"token operator\">=</span>/var/lib/mysql/mysql.sock</pre></td></tr></table></figure><p>测试启动 mysql 服务器</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># /usr/local/mysql/support-files/mysql.server start</span></pre></td></tr></table></figure><p>添加软连接，并重启 mysql 服务</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#  ln -s /usr/local/src/mysql/support-files/mysql.server /etc/init.d/mysql </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#  ln -s /usr/local/src/mysql/bin/mysql /usr/bin/mysql</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#  service mysql restart</span></pre></td></tr></table></figure><p>登录 mysql，修改密码 (密码为生成的临时密码)</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\">#  mysql -u root -p 密码</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#提示：-u 后面可以紧跟用户名，也可以加个空格，但密码后面一定不能加空格</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>mysql<span class=\"token operator\">></span>set password <span class=\"token keyword\">for</span> root@localhost <span class=\"token operator\">=</span> password<span class=\"token punctuation\">(</span><span class=\"token string\">'yourpass'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>开放远程连接</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mysql<span class=\"token operator\">></span>use mysql<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>msyql<span class=\"token operator\">></span>update user <span class=\"token builtin class-name\">set</span> user.Host<span class=\"token operator\">=</span><span class=\"token string\">'%'</span> where user.User<span class=\"token operator\">=</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>mysql<span class=\"token operator\">></span>flush privileges<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"四-设置开机自动启动\"><a class=\"anchor\" href=\"#四-设置开机自动启动\">#</a> 四、设置开机自动启动</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span>、将服务文件拷贝到init.d下，并重命名为mysql</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">2</span>、赋予可执行权限</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod +x /etc/init.d/mysqld</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">3</span>、添加服务</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># chkconfig --add mysqld</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">4</span>、显示服务列表</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost /<span class=\"token punctuation\">]</span><span class=\"token comment\"># chkconfig --list</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/28/Platform-construction/Yarn/course-4/Yarn%E7%9A%84%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE/",
            "url": "https://methiony.work/2020/11/28/Platform-construction/Yarn/course-4/Yarn%E7%9A%84%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE/",
            "title": "Yarn的参数设置",
            "date_published": "2020-11-28T02:20:28.000Z",
            "content_html": "<h1 id=\"1-yarn的调度器\"><a class=\"anchor\" href=\"#1-yarn的调度器\">#</a> 1、yarn 的调度器</h1>\n<p>yarn 我们都知道主要是用于做资源调度，任务分配等功能的，hadoop 支持好几种任务的调度方式，不同的场景需要使用不同的任务调度器.</p>\n<h2 id=\"fif0-scheduler队列调度\"><a class=\"anchor\" href=\"#fif0-scheduler队列调度\">#</a> FIF0 Scheduler (队列调度)</h2>\n<p>把任务按提交的顺序排成一个队列，这是一个先进先出队列，在进行资源分配的时候，先给队列中最头上的任务进行分配资源，待最头上任务需求满足后再给下一个分配，以此类推</p>\n<p>FIFO Scheduler 是最简单也是最容易理解的调度器，也不需要任何配置，但它并不适用于共享集群。大的任务可能会占用所有集群资源，这就导致其它任务被阻塞</p>\n<h2 id=\"capacity-scheduler容量调度器-apache版本默认使用的调度器\"><a class=\"anchor\" href=\"#capacity-scheduler容量调度器-apache版本默认使用的调度器\">#</a> Capacity Scheduler (容量调度器，apache 版本默认使用的调度器)</h2>\n<p>Capacity 调度器允许多个组织共享整个集群，每个组织可以获得集群的部分计算能力。通过为每个组织分配专门的队列，然后再为毎个队列分配一定的集群资源，这样整个集群就可以通过设置多个队列的方式给多个组织提供服务了。</p>\n<p>除此之外，对列内部又可以垂直划分，这样一个组织内部的多个成员就可以共享这个队列资源了，在一个队列内部，资源的调度是采用的是先进先出 (FIFO) 策略。</p>\n<h2 id=\"fair-scheduler公平调度器cdh版本的-hadoop默认使用的调度器\"><a class=\"anchor\" href=\"#fair-scheduler公平调度器cdh版本的-hadoop默认使用的调度器\">#</a> Fair Scheduler (公平调度器，CDH 版本的 hadoop 默认使用的调度器)</h2>\n<p>Fair 调度器的设计目标是为所有的应用分配公平的资源 (对公平的定义可以通过参数来设置)。公平调度在也可以在多个队列间工作。</p>\n<p>举个例子，假设有两个用户 A 和 B, 他们分别拥有一个队列。当 A 启动一个 job 而 B 没有任务时，A 会获得全部集群资源；当 B 启动一个 job 后，A 的 job 会继续运行，不过一会儿之后两个任务会各自获得一半的集群资源。如果此时 B 再启动第二个 job 并且其它 job 还在运行，则它将会和 B 的第一个 job 共享 B 这个队列的资源，也就是 B 的两个 job 会用于四分之一的集群资源，而 A 的 job 仍然用于集群一半的资源，结果就是资源最终在两个用户之间平等的共享</p>\n<h1 id=\"2-yarn常用参数设置\"><a class=\"anchor\" href=\"#2-yarn常用参数设置\">#</a> 2、yarn 常用参数设置</h1>\n<h2 id=\"设置-container分配最小内存\"><a class=\"anchor\" href=\"#设置-container分配最小内存\">#</a> 设置 container 分配最小内存</h2>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yarn.scheduler.minimum-allocation-mb 1024</pre></td></tr></table></figure><p>给应用程序 container 分配的最小内存</p>\n<h2 id=\"设置-container分配最大内存\"><a class=\"anchor\" href=\"#设置-container分配最大内存\">#</a> 设置 container 分配最大内存</h2>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yarn.scheduler.maximum-allocation-mb 8192</pre></td></tr></table></figure><p>给应用程序 container 分配的最大内存</p>\n<h2 id=\"设置每个-container的最小虚拟内核个数\"><a class=\"anchor\" href=\"#设置每个-container的最小虚拟内核个数\">#</a> 设置每个 container 的最小虚拟内核个数</h2>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yarn.scheduler.minimum-allocation-vcores 1</pre></td></tr></table></figure><p>每个 container 默认给分配的最小的虚拟内核个数</p>\n<h2 id=\"设置每个-container的最大虚拟内核个数\"><a class=\"anchor\" href=\"#设置每个-container的最大虚拟内核个数\">#</a> 设置每个 container 的最大虚拟内核个数</h2>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yarn.scheduler.maximum-allocation-vcores 32</pre></td></tr></table></figure><p>每个 container 可以分配的最大的虚拟内核的个数</p>\n<h2 id=\"设置-nodemanager可以分配的内存大小\"><a class=\"anchor\" href=\"#设置-nodemanager可以分配的内存大小\">#</a> 设置 NodeManager 可以分配的内存大小</h2>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yarn.nodemanager.resource.memory-mb 8192 nodemanager</pre></td></tr></table></figure><p>可以分配的最大内存大小，默认 8192Mb</p>\n<h2 id=\"定义每台机器的内存使用大小\"><a class=\"anchor\" href=\"#定义每台机器的内存使用大小\">#</a> 定义每台机器的内存使用大小</h2>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yarn.nodemanager.resource.memory-mb 8192</pre></td></tr></table></figure><h2 id=\"定义交换区空间可以使用的大小\"><a class=\"anchor\" href=\"#定义交换区空间可以使用的大小\">#</a> 定义交换区空间可以使用的大小</h2>\n<p>交换区空间就是讲一块硬盘拿出来做内存使用这里指定的是 nodemanager 的 2.1 倍</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yarn.nodemanager.vmem-pmem-ratio 2.1</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/27/Platform-construction/Hive/course-5/Hive%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0/",
            "url": "https://methiony.work/2020/11/27/Platform-construction/Hive/course-5/Hive%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0/",
            "title": "Hive基本概述",
            "date_published": "2020-11-27T14:30:30.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hive基本概述\"><a class=\"anchor\" href=\"#hive基本概述\">#</a> Hive 基本概述</h1>\n<h2 id=\"1数据仓库\"><a class=\"anchor\" href=\"#1数据仓库\">#</a> 1. 数据仓库</h2>\n<h3 id=\"11基本概念\"><a class=\"anchor\" href=\"#11基本概念\">#</a> 1.1 基本概念</h3>\n<p>英文名称为 Data Warehouse, 可简写为 DW 或 DWH。数据仓库的目的是构建面向分析的集成化数据环境，为企业提供决策支持 (Decision Support)。</p>\n<p>数据仓库是存数据的，主要目的是为了分析有效数据，后续会基于它产出供分析挖掘的数据，或者数据应用需要的数据，如企业的分析性报告和各类报表等。<br />\n可以理解为：面向分析的存储系统。</p>\n<h2 id=\"12主要特征\"><a class=\"anchor\" href=\"#12主要特征\">#</a> 1.2 主要特征</h2>\n<p>数据仓库是面向主题的 (Subject-Oriented)、集成的 ( integrated)、非易失的 (Non<br />\nVolatile) 和时变的 (Time-Variant) 数据集合，用以支持管理决策.</p>\n<h3 id=\"121面向主题\"><a class=\"anchor\" href=\"#121面向主题\">#</a> 1.2.1 面向主题</h3>\n<p>数据仓库是面向主题的，数据仓库通过一个个主题域将多个业务系统的数据加载到一起，为了各个主题 (如：用户、订单、商品等) 进行分析而建，操作型数据库是为了支撑各种业务而建立</p>\n<h3 id=\"122集成性\"><a class=\"anchor\" href=\"#122集成性\">#</a> 1.2.2 集成性</h3>\n<p>数据仓库会将不同源数据库中的数据汇总到起，数据仓库中的综合数据不能从原有的数据库<br />\n系统直接得到。因此在数据进入数据仓库之前，必然要经过统一与整合，这一步是据仓库建设中最关键、最复杂的一步 (ET 凵，要统一源数据中所有矛盾之处，如字段的同名义、异名同义、单位不统一、字长不一致，等等</p>\n<h3 id=\"123非易失性\"><a class=\"anchor\" href=\"#123非易失性\">#</a> 1.2.3 非易失性</h3>\n<p>操作型数据库主要服务于日常的业务操作，使得数据库需要不断地对数据实时更新，以便迅速获得当前最新数据，不至于影响正常的业务运作。</p>\n<p>在数据仓库中只要保存过去的业务数据，不需要每一笔业务都实时更新数据仓库，而是根据商业需要毎隔一段时间把一批较新的数据导入数据仓库。数据仓库的数据反映的是一段相当长的时间内历史数据的内容，是不同时点的数据库的集合，以及基于这些快照进行统计、综合和重组的导出数据工数据仓库中的数据一般仅执行査询操作，很少会有删除和更新。但是需定期加载和刷新数据</p>\n<h3 id=\"124时变性\"><a class=\"anchor\" href=\"#124时变性\">#</a> 1.2.4 时变性</h3>\n<p>数据仓库包含各种粒度的历史数据。数据仓库中的数据可能与某个特定日期、星期、月份、季度或者年份有关。数据仓库的目的是通过分析企业过去一段时间业务的经营状况，挖掘其中隐藏的模式。虽然数据仓库的用户不能修改数据，但并不是说数据仓库的数据是永远不变的。分析的结果只能反映过去的情况，当业务变化后，挖掘出的模式会失去时效性。因此数据仓库的数据需要定时更新，以适应决策的需要.</p>\n<h2 id=\"13数据库与数据仓库的区别\"><a class=\"anchor\" href=\"#13数据库与数据仓库的区别\">#</a> 1.3 数据库与数据仓库的区别</h2>\n<p>数据库与数据仓库的区别实际讲的是 0TP 与 OLAP 的区别。</p>\n<p>0TP</p>\n<p>操作型处理，叫联机事务处理 OLTP (On-Line Transaction Processing,), 也可以称面向交易的处理系统，它是针对具体业务在数据库联机的日常操作，通常对少数记录进行査询、修改。用户较为关心操作的响应时间、数据的安全性、完整性和并发支持的用户数等问题。传统的数据库系统作为数据管理的主要手段，主要用于操作型处理。</p>\n<p>OLAP</p>\n<p>分析型处理，叫联机分析处理 OLAP (On-Line Analytical Processing)- 般针对某些主题的历史数据进行分析，支持管理决策。<br />\n首先要明白，数据仓库的出现，并不是要取代数据库<br />\n・数据库是面向事务的设计，数据仓库是面向主题设计的。<br />\n・数据库一般存储业务数据，数据仓库存储的一般是历史数据<br />\n・数据库设计是尽量避免冗余，一般针对某一业务应用进行设计，比如一张简单的 User 表<br />\n记录用户名、密码等简单数据即可，符合业务应用，但是不符合分析。数据仓库在设计是有意引入冗余，依照分析需求，分析维度、分析指标进行设计。<br />\n・数据库是为捕获数据而设计，数据仓库是为分析数据而设计。</p>\n<p>数据仓库，是在数据库已经大量存在的情况下，为了进一步挖掘数据资源、为了决策需要而产生的，它决不是所谓的 “大型数据库”。</p>\n<h2 id=\"14数仓的分层架构\"><a class=\"anchor\" href=\"#14数仓的分层架构\">#</a> 1.4 数仓的分层架构</h2>\n<p>按照数据流入流岀的过程，数据仓库架构可分为三层 -- 源数据、数据仓库、数据应用。</p>\n<p>数据仓库的数据来源于不同的源数据，并提供多样的数据应用，数据自下而上流入数据仓库后向上层开放应用，而数据仓库只是中间集成化数据管理的一个平台。</p>\n<p>源数据层 (DS): 此层数据无任何更改，直接沿用外围系统数据结构和数据，不对外开<br />\n放；为临时存储层，是接口数据的临时存储区域，为后一步的数据处理做准备。</p>\n<p>数据仓库层 (DW): 也称为细节层，DW 层的数据应该是一致的、准确的、干净的数据<br />\n即对源系统数据进行了清洗 (去除了杂质) 后的数据</p>\n<p>数据应用层 (DA 或 APP): 前端应用直接读取的数据源；根据报表、专题分析需求而计算生成的数据。</p>\n<p>数据仓库从各数据源获取数据及在数据仓库内的数据转换和流动都可以认为是 ETL (抽取 Extra, 转化 Transfer, 装载 Load) 的过程，ETL 是数据仓库的流水线，也可以认为是数据仓库的血液，它维系着数据仓库中数据的新陈代谢，而数据仓库曰常的管理和维护工作的大部分精力就是保持 ETL 的正常和稳定</p>\n<h2 id=\"15数仓的元数据管理\"><a class=\"anchor\" href=\"#15数仓的元数据管理\">#</a> 1.5 数仓的元数据管理</h2>\n<p>元数据 (Meta Date), 主要记录数据仓库中模型的定义、各层级间的映射关系、监控数据仓库的数据状态及 ETL 的任务运行状态。一般会通过元数据资料库 ( Metadata Repository) 来统一地存储和管理元数据，其主要目的是使数据仓库的议计、部署、操作和管理能达成协同和一致</p>\n<p>元数据是数据仓库管理系统的重要组成部分，元数据管理是企业级数据仓库中的关键组件，贯穿数据仓库构建的整个过程，直接影响着数据仓库的构建、使用和维护。</p>\n<p>a、构建数据仓库的主要步骤之一是 ETL。这时元数据将发挥重要的作用，它定义了源数据系统到数据仓库的映射、数据转换的规则、数据仓库的逻辑结构、数据更新的规则、数据导入历史记录以及装载周期等相关内容。数据抽取和转换的专家以及数据仓库管理员正是通过元数据高效地构建数据仓库<br />\n b、用户在使用数据仓库时，通过元数据访问数据，明确数据项的含义以及定制报表<br />\n c、数据仓库的规模及其复杂性离不开正确的元数据管理，包括増加或移除外部数据源，改变数据清洗方法，控制岀错的査询以及安排备份等。</p>\n<p>元数据可分为技术元数据和业务元数据</p>\n<h3 id=\"技术元数据\"><a class=\"anchor\" href=\"#技术元数据\">#</a> 技术元数据</h3>\n<p>为开发和管理数据仓库的 T 人员使用，它描述了与数据仓库开发、管理和维护相关的数据，包括数据源信息、数据转换描述、数据仓库模型、数据凊洗与更新规则、数据映射和访问权限等。</p>\n<h3 id=\"业务元数据\"><a class=\"anchor\" href=\"#业务元数据\">#</a> 业务元数据</h3>\n<p>为管理层和业务分析人员服务，从业务角度描述数据，包括商务术语、数据仓库中有什么数据、数据的位置和数据的可用性等，帮助业务人员更好地理解数据仓库中哪些数据是可用的以及如何使用。</p>\n<p>由上可见，元数据不仅定义了数据仓库中数据的模式、来源、抽取和转换规则等，而且是整个数据仓库系统运行的基础，元数据把数据仓库系统中各个松散的组件联系起来，组成了一个有机的整体</p>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/27/Platform-construction/Yarn/course-4/Yarn%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0/",
            "url": "https://methiony.work/2020/11/27/Platform-construction/Yarn/course-4/Yarn%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0/",
            "title": "Yarn的基本概述",
            "date_published": "2020-11-27T13:56:16.000Z",
            "content_html": "<h1 id=\"1-yarn的介绍\"><a class=\"anchor\" href=\"#1-yarn的介绍\">#</a> 1、yarn 的介绍</h1>\n<p>yarn 是 hadoop 集群当中的资源管理系统模块，从 hadoop2.0 始引入 yarn 模块 yarn 可为各类计算框架提供资源的管理和调度，主要用于管理集群当中的资源 (主要是服务器的各种硬件资源，包括 CPU, 内存，磁盘，网络 1o 等) 以及调度运行在 yarn 上面的各种任务</p>\n<p>yarn 核心出发点是为了分离资源管理与作业监控，实现分离的做法是拥有一个全局的资源管理 (ResourceManager,RM), 以及每个应用程序对应一个的应用管理器 (Application Master, AM)</p>\n<p>yam 主要就是为了调度资源，管理任务等<br />\n其调度分为两个层级来说:<br />\n 一级调度管理<br />\n计算资源管理 (CPU, 内存，网络 IO, 磁盘)<br />\n 二级调度管理<br />\n任务内部的计算模型管理 (AppMaster 的任务精细化管理)</p>\n<h1 id=\"2-yarn的主要组件介绍与作用\"><a class=\"anchor\" href=\"#2-yarn的主要组件介绍与作用\">#</a> 2、Yarn 的主要组件介绍与作用</h1>\n<p>YARN 总体上是 Master/ Slave 结构，主要由 ResourceManager、NodeManager、Application Master 和 Container 等几个组件构成</p>\n<h2 id=\"1-resource-managerrm\"><a class=\"anchor\" href=\"#1-resource-managerrm\">#</a> 1、Resource Manager(RM)</h2>\n<p>负责处理客户端请求对各 NM 上的资源进行统一管理和调度。给 Application Master 分配空闲的 Container 运行并监控其运行状态。主要由两个组件构成：调度器和应用程序管理器</p>\n<h3 id=\"调度器scheduler\"><a class=\"anchor\" href=\"#调度器scheduler\">#</a> 调度器（scheduler）</h3>\n<p>调度器根据容量、队列等限制条件，将系统中的资源分配给各个正在运行的应用程序。调度器仅根据各个应用程序的资源需求进行资源分配，而资源分配单位是 Container。 Scheduler. 不负责监控或者跟踪应用程序的状态。总之，调度器根据应用程序的资源要求，以及集群机器的资源情况，为应用程序分配封装在 Container 中的资源</p>\n<h3 id=\"应用程序管理器-applications-manager\"><a class=\"anchor\" href=\"#应用程序管理器-applications-manager\">#</a> 应用程序管理器 (Applications Manager)</h3>\n<p>应用程序管理器负责管理整个系统中所有应用程序，包括应用程序提交、与调度器协商资源以启动 Application Master、监控 Application Master, 运行状态并在失败时重新启动等，跟踪分给的 Container 的进度、状态也是其职责。</p>\n<h2 id=\"2-nodemanagernm\"><a class=\"anchor\" href=\"#2-nodemanagernm\">#</a> 2、NodeManager(NM)</h2>\n<p>NodeManager 是每个节点上的资源和任务管理器。它会定时地向 ResourceManager 汇报本节点上的资源使用情况和各个 Container 的运行状态；同时会接收并处理来自 ApplicationMaster 的 Container 启动停止等请求。</p>\n<h2 id=\"3-applicationmasteram\"><a class=\"anchor\" href=\"#3-applicationmasteram\">#</a> 3、ApplicationMaster(AM)</h2>\n<p>用户提交的应用程序均包含一个 Application Master, 负责应用的监控，跟踪应用执行状态，重启失败任务等。 Application Master 是应用框架，它负责向 ResourceManager 协调资源，并且与 Node Manager 协同工作完成 Task 的执行和监控</p>\n<h2 id=\"4-container\"><a class=\"anchor\" href=\"#4-container\">#</a> 4、Container</h2>\n<p>Container 是 YARN 中的资源抽象，它封装了某个节点上的多维度资源，如内存、CPU、磁盘、网络等，当 ApplicationMaster 向 ResourceManager 申请资源时，ResourceManager 为 ApplicationMaster 返回的资源便是用 Container 表示的。</p>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/27/Platform-construction/Mapreduce/course-3/MapReduce%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/",
            "url": "https://methiony.work/2020/11/27/Platform-construction/Mapreduce/course-3/MapReduce%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/",
            "title": "MapReduce基本概念",
            "date_published": "2020-11-27T09:56:36.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"1-mapreduce介绍\"><a class=\"anchor\" href=\"#1-mapreduce介绍\">#</a> 1、MapReduce 介绍</h1>\n<p>MapReduce 思想在生活中处处可见。或多或少都曾接触过这种思想。 MapReduce 的思想核心<br />\n是 &quot; 分而治之”, 适用于大量复杂的任务处理场景 (大规模数据处理场景)</p>\n<p>1、Map 负责 “分”, 即把复杂的任务分解为若干个 “简单的任务” 来并行处理。可以进行拆分的<br />\n前提是这些小任务可以并行计算，彼此间几乎没有依赖关系<br />\n 2、Reduce 负责 “合”, 即对 map 阶段的结果进行全局汇总<br />\n 3、MapReduce 运行在 yarn 集群</p>\n<p>ResourceManage</p>\n<p>NodeManager<br />\n 这两个阶段合起来正是 MapReduce 思想的体现</p>\n<p>4、还有一个比较形象的语言解释 MapReduce<br />\n 我们要数图书馆中的所有书。你数 1 号书架，我数 2 号卡架。这就是 Map&quot;。我们人越多，数书<br />\n就更快。<br />\n现在我们到一起，把所有人的统计数加在一起。这就是 “Reduce”。</p>\n<h1 id=\"2-mapreduce设计构思\"><a class=\"anchor\" href=\"#2-mapreduce设计构思\">#</a> 2、MapReduce 设计构思</h1>\n<h2 id=\"1-编程框架\"><a class=\"anchor\" href=\"#1-编程框架\">#</a> 1、编程框架</h2>\n<p>MapReduce 是一个分布式运算程序的编程框架，核心功能是将用户编写的业务逻辑代码和自带默认组件整合成一个完整的分布式运算程序，并发运行在 Hadoop 集群上。<br />\nMapReduce 设计并提供了统一的计算框架，隐藏了绝大多数系统层面的处理细节，提供一个抽象和高层的编程接口和框架。</p>\n<h2 id=\"2-处理方式\"><a class=\"anchor\" href=\"#2-处理方式\">#</a> 2、处理方式</h2>\n<p>程序员仅需要关心其应用层的具体计算问题，仅需编写少量的处理应用本身计算问题的程序代码。如何具体完成这个并行计算任务所相关的诸多系统层细节被隐藏起来交给计算框架去处理</p>\n<h2 id=\"3-编程接口\"><a class=\"anchor\" href=\"#3-编程接口\">#</a> 3、编程接口</h2>\n<p>Map 和 Reduce 为程序员提供了一个清晰的操作接口抽象描述。 MapReduce 中定义了如下的 Map 和 Reduce 两个抽象的编程接口，由用户去编程实现 Map 和 Reduce</p>\n<h2 id=\"4-数据类型\"><a class=\"anchor\" href=\"#4-数据类型\">#</a> 4、 数据类型</h2>\n<p>MapReduce 处理的数据类型是 &lt;key,value&gt; 键值对<br />\n・Map: (k1; v1)→[ ( k2; V2) ]<br />\n·Reduce: ( k2; [v2] )-[ (k3;  v3) ]</p>\n<p>一个完整的 mapreduce 程序在分布式运行时有三类实例进程</p>\n<ol>\n<li>MRAppMaster 负责整个程序的过程调度及状态协调</li>\n<li>MapTask 负责 map 阶段的整个数据处理流程</li>\n<li>ReduceTask 负责 reduce 阶段的整个数据处理流程</li>\n</ol>\n<h1 id=\"3-mapreduce分区\"><a class=\"anchor\" href=\"#3-mapreduce分区\">#</a> 3、MapReduce 分区</h1>\n<h2 id=\"1-分区概述\"><a class=\"anchor\" href=\"#1-分区概述\">#</a> 1、分区概述</h2>\n<p>在 MapReduce 中，通过我们指定分区，会将同一个分区的数据发送到同一个 Reduce 当中进行处理<br />\n例如：为了数据的统计，可以把一批类似的数据发送到同一个 Reduce 当中，在同一个 Reduce 当中统计相同类型的数据，就可以实现类似的数据分区和统计等<br />\n其实就是相同类型的数据，有共性的数据，送到一起去处理 Reduce 当中默认的分区只有一个</p>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/26/Platform-construction/Hadoop/course-2/Hadoop%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/",
            "url": "https://methiony.work/2020/11/26/Platform-construction/Hadoop/course-2/Hadoop%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/",
            "title": "Hadoop高可用集群搭建",
            "date_published": "2020-11-26T07:42:16.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hadoop高可用集群搭建\"><a class=\"anchor\" href=\"#hadoop高可用集群搭建\">#</a> Hadoop 高可用集群搭建</h1>\n<h2 id=\"1-环境准备\"><a class=\"anchor\" href=\"#1-环境准备\">#</a> 1、环境准备</h2>\n<p>用其他工具将 hadoop-2.6.0、zookeeper-3.4.5、jdk1.8.0_271 放入 node01 主机 /usr/local/src 目录下</p>\n<h3 id=\"主机配置环境如下表\"><a class=\"anchor\" href=\"#主机配置环境如下表\">#</a> 主机配置环境如下表</h3>\n<table>\n<thead>\n<tr>\n<th>主机名</th>\n<th>IP</th>\n<th>系统</th>\n<th>软件版本</th>\n<th>安装目录</th>\n<th>数据目录</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>node01</td>\n<td>192.168.2.131</td>\n<td>Centos 7</td>\n<td>hadoop-2.6.0、jdk1.8、zookeeper-3.4.5</td>\n<td>/usr/local/src/hadoop</td>\n<td>/data/hadoop</td>\n</tr>\n<tr>\n<td>node02</td>\n<td>192.168.2.132</td>\n<td>Centos 7</td>\n<td>hadoop-2.6.0、jdk1.8、zookeeper-3.4.5</td>\n<td>/usr/local/src/hadoop</td>\n<td>/data/hadoop</td>\n</tr>\n<tr>\n<td>node03</td>\n<td>192.168.2.133</td>\n<td>Centos 7</td>\n<td>hadoop-2.6.0、jdk1.8、zookeeper-3.4.5</td>\n<td>/usr/local/src/hadoop</td>\n<td>/data/hadoop</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"集群规划\"><a class=\"anchor\" href=\"#集群规划\">#</a> 集群规划</h3>\n<table>\n<thead>\n<tr>\n<th>node01</th>\n<th>node02</th>\n<th>node03</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>NodeManager</td>\n<td>NodeManager</td>\n<td>NodeManager</td>\n</tr>\n<tr>\n<td>NameNode</td>\n<td>NameNode</td>\n<td></td>\n</tr>\n<tr>\n<td>DataNode</td>\n<td>DataNode</td>\n<td>DataNode</td>\n</tr>\n<tr>\n<td>DFSZKFailoverController</td>\n<td>DFSZKFailoverController</td>\n<td></td>\n</tr>\n<tr>\n<td>JournalNode</td>\n<td>JournalNode</td>\n<td>JournalNode</td>\n</tr>\n<tr>\n<td>ResourceManager</td>\n<td>ResourceManager</td>\n<td></td>\n</tr>\n<tr>\n<td>QuorumPeerMain</td>\n<td>QuorumPeerMain</td>\n<td>QuorumPeerMain</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"配置主机名以及解析3台\"><a class=\"anchor\" href=\"#配置主机名以及解析3台\">#</a> 配置主机名以及解析（3 台）</h3>\n<p>配置主机名</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># hostnamectl set-hostname node01</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token comment\"># hostnamectl set-hostname node02</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token comment\"># hostnamectl set-hostname node03</span></pre></td></tr></table></figure><p>配置域名解析（主机配置然后复制到其他机器上）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># vi /etc/hosts</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>127<span class=\"token punctuation\">.</span>0<span class=\"token punctuation\">.</span>0<span class=\"token punctuation\">.</span>1   localhost localhost<span class=\"token punctuation\">.</span>localdomain localhost4 localhost4<span class=\"token punctuation\">.</span>localdomain4</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>::1         localhost localhost<span class=\"token punctuation\">.</span>localdomain localhost6 localhost6<span class=\"token punctuation\">.</span>localdomain6</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>131 node01</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>132 node02</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>133 node03</pre></td></tr></table></figure><h3 id=\"配置主机ip地址我的网卡是ifcfg-ens33\"><a class=\"anchor\" href=\"#配置主机ip地址我的网卡是ifcfg-ens33\">#</a> 配置主机 IP 地址（我的网卡是 ifcfg-ens33）</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># vi /etc/sysconfig/network-scripts/ifcfg-ens33</span></pre></td></tr></table></figure><p>node01 配置信息</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>BOOTPROTO=static</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ONBOOT=yes</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>文件末尾追加</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>IPADDR=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>131</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>GATEWAY=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>2</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>NETMASK=255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>0</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>DNS1=8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8</pre></td></tr></table></figure><p>node02 配置信息</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>BOOTPROTO=static</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ONBOOT=yes</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>文件末尾追加</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>IPADDR=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>132</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>GATEWAY=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>2</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>NETMASK=255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>0</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>DNS1=8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8</pre></td></tr></table></figure><p>node02 配置信息</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>BOOTPROTO=static</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ONBOOT=yes</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>文件末尾追加</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>IPADDR=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>133</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>GATEWAY=192<span class=\"token punctuation\">.</span>168<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>2</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>NETMASK=255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>255<span class=\"token punctuation\">.</span>0</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>DNS1=8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>8</pre></td></tr></table></figure><h3 id=\"关闭防火墙\"><a class=\"anchor\" href=\"#关闭防火墙\">#</a> 关闭防火墙</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># systemctl stop firewalld.service </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#关闭防火墙</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># systemctl disable firewalld.service </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#禁止开机启动</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># firewall-cmd --state </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#查看防火墙状态</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>not running</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token comment\"># systemctl stop firewalld.service </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#关闭防火墙</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token comment\"># systemctl disable firewalld.service </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#禁止开机启动</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># firewall-cmd --state </span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">#查看防火墙状态</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>not running</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token comment\"># systemctl stop firewalld.service </span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">#关闭防火墙</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token comment\"># systemctl disable firewalld.service </span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#禁止开机启动</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># firewall-cmd --state </span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">#查看防火墙状态</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>not running</pre></td></tr></table></figure><h3 id=\"关闭selinux\"><a class=\"anchor\" href=\"#关闭selinux\">#</a> 关闭 selinux</h3>\n<p>进入到 /etc/selinux/config 文件，将 SELINUX=enforcing 改为 SELINUX=disabled。</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#  vi  /etc/selinux/config</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token comment\">#  vi  /etc/selinux/config</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token comment\">#  vi  /etc/selinux/config</span></pre></td></tr></table></figure><p>重启</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@node03 ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr></table></figure><h3 id=\"设置免密登录\"><a class=\"anchor\" href=\"#设置免密登录\">#</a> 设置免密登录</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#第一步，ssh-keygen -t rsa 生成密钥对</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh-keygen -t rsa</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 连续三次回车，即在本地生成了公钥和私钥，不设置密码，默认存储在～/.ssh 目录下</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#第二步，用 ssh-copy-id 拷贝将公钥复制到远程机器中</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh-copy-id -i .ssh/id_rsa.pub root@node01</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh-copy-id -i .ssh/id_rsa.pub  root@node02</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh-copy-id -i .ssh/id_rsa.pub  root@node03</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#第三步，测试免密码登陆</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh node02</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\"># ssh node03</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">#第四步，在其他机器重复操作</span></pre></td></tr></table></figure><h2 id=\"2-搭建环境\"><a class=\"anchor\" href=\"#2-搭建环境\">#</a> 2、搭建环境</h2>\n<h3 id=\"1-安装jdk已安装可以跳过\"><a class=\"anchor\" href=\"#1-安装jdk已安装可以跳过\">#</a> 1、安装 jdk（已安装可以跳过）</h3>\n<p>解压 jdk</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#tar -zxvf jdk-8u271-linux-x64.tar.gz</span></pre></td></tr></table></figure><p>配置环境变量 (/etc/profile)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#vi /etc/profile</span></pre></td></tr></table></figure><p>添加</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export JAVA_HOME=<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>jdk1<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0_271 </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export PATH=:<span class=\"token variable\">$JAVA_HOME</span><span class=\"token operator\">/</span>bin:<span class=\"token variable\">$PATH</span></pre></td></tr></table></figure><p>执行下面命令，让环境变量生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><p>验证 jdk 安装是否成功</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#java -version</span></pre></td></tr></table></figure><p>拷贝分发到 node1、node2</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#scp -r jdk1.8.0_271 node2:$PWD</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#scp -r jdk1.8.0_271 node3:$PWD</span></pre></td></tr></table></figure><h3 id=\"2-安装zookeeper已安装可以跳过\"><a class=\"anchor\" href=\"#2-安装zookeeper已安装可以跳过\">#</a> 2、安装 zookeeper（已安装可以跳过）</h3>\n<p>解压</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\"># tar -zxvf zookeeper-3.4.5.tar.gz</span></pre></td></tr></table></figure><p>配置修改</p>\n<p>/usr/local/src/zookeeper-3.4.5/conf 这个路径下的 zoo_sample.cfg 修改为 zoo.cfg (如果存在 zoo.cfg 文件则不需要拷贝 zoo_sample.cfg)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 conf]</span><span class=\"token comment\"># mv zoo_sample.cfg zoo.cfg</span></pre></td></tr></table></figure><p>打开 zoo.cfg 文件，修改 dataDir 路径，添加主机</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dataDir=<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>4<span class=\"token punctuation\">.</span>5<span class=\"token operator\">/</span>zkData</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>文件内容末尾添加内容</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>server<span class=\"token punctuation\">.</span>1=master:2888:3888</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>server<span class=\"token punctuation\">.</span>2=node1:2888:3888</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>server<span class=\"token punctuation\">.</span>3=node2:2888:3888</pre></td></tr></table></figure><p>在 /usr/local/src/zookeeper-3.4.5 / 这个目录上创建 zkData 文件夹</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 zookeeper-3.4.5]</span><span class=\"token comment\"># mkdir zkData</span></pre></td></tr></table></figure><p>在 /usr/local/src/zookeeper-3.4.5/zkData 这个目录上创建 myid 文件</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 zkData]</span><span class=\"token comment\"># touch myid</span></pre></td></tr></table></figure><p>编辑 myid 文件 (其他机器上修改对应的 server 的数字)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 zkData]</span><span class=\"token comment\"># vi myid</span></pre></td></tr></table></figure><pre><code>1\n</code></pre>\n<p>拷贝分发到 node1、node2</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\"># scp -r zookeeper-3.4.5 node2:$PWD</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\"># scp -r zookeeper-3.4.5 node3:$PWD</span></pre></td></tr></table></figure><p>修改 node02、node03 的 myid 文件</p>\n<h3 id=\"3-安装hadoop\"><a class=\"anchor\" href=\"#3-安装hadoop\">#</a> 3、安装 Hadoop</h3>\n<h4 id=\"1-解压hadoop\"><a class=\"anchor\" href=\"#1-解压hadoop\">#</a> 1、解压 hadoop</h4>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#tar -zxvf hadoop-2.6.0.tar.gz</span></pre></td></tr></table></figure><p>配置环境变量 (/etc/profile)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#vi /etc/profile</span></pre></td></tr></table></figure><p>添加</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export HADOOP_HOME=<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>2<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>0</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export PATH=:<span class=\"token variable\">$HADOOP_HOME</span><span class=\"token operator\">/</span>bin:<span class=\"token variable\">$HADOOP_HOME</span><span class=\"token operator\">/</span>sbin:<span class=\"token variable\">$PATH</span></pre></td></tr></table></figure><p>执行下面命令，让环境变量生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 /]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><h4 id=\"2-修改hadoop的配置文件\"><a class=\"anchor\" href=\"#2-修改hadoop的配置文件\">#</a> 2、修改 hadoop 的配置文件</h4>\n<p>进入需改文件的目录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01~]</span><span class=\"token comment\">#cd /usr/local/src/hadoop-2.6.0/etc/hadoop</span></pre></td></tr></table></figure><p>需要修改的文件</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>core<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\thadoop<span class=\"token operator\">-</span>env<span class=\"token punctuation\">.</span>sh\thdfs<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\t</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mapred<span class=\"token operator\">-</span>env<span class=\"token punctuation\">.</span>sh\tmapred<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\tyarn<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml</pre></td></tr></table></figure><h5 id=\"core-sitexml\"><a class=\"anchor\" href=\"#core-sitexml\">#</a> core-site.xml</h5>\n<p>修改 core-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 hdfs 连接地址，集群模式（高可用）--></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>fs.defaultFS<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>hdfs://cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 ZooKeeper 集群的地址和端口。注意，数量一定是奇数，且不少于三个节点 --></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>ha.zookeeper.quorum<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node01:2181,node02:2181,node03:2181<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"hdfs-sitexml\"><a class=\"anchor\" href=\"#hdfs-sitexml\">#</a> hdfs-site.xml</h5>\n<p>修改 hdfs-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 HDFS 副本的数量，不能超过机器节点数 --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.replication<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 为 namenode 集群定义一个 services name --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.nameservices<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- nameservice 包含哪些 namenode，为各个 namenode 起名 --></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.ha.namenodes.cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>nn01,nn02<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre> \t<span class=\"token comment\">&lt;!-- 名为 nn01 的 namenode 的 rpc 地址和端口号，rpc 用来和 datanode 通讯 --></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.rpc-address.cluster.nn01<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node01:9000<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre> \t<span class=\"token comment\">&lt;!-- 名为 nn01 的 namenode 的 http 地址和端口号，用来和 web 客户端通讯 --></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.http-address.cluster.nn01<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node01:50070<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre> \t<span class=\"token comment\">&lt;!-- 名为 nn02 的 namenode 的 rpc 地址和端口号，rpc 用来和 datanode 通讯 --></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.rpc-address.cluster.nn02<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node02:9000<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre> \t<span class=\"token comment\">&lt;!-- 名为 nn02 的 namenode 的 http 地址和端口号，用来和 web 客户端通讯 --></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.http-address.cluster.nn02<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node02:50070<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  \t<span class=\"token comment\">&lt;!-- namenode 间用于共享编辑日志的 journal 节点列表 --></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.shared.edits.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>qjournal://node01:8485;node02:8485;node03:8485/cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token comment\">&lt;!-- journalnode 上用于存放 edits 日志的目录 --></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.journalnode.edits.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/data/hadoop/journaldata<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  \t<span class=\"token comment\">&lt;!-- 指定该集群出现故障时，是否自动切换到另一台 namenode --></span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.ha.automatic-failover.enabled.cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 配置失败自动切换实现方式 --></span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.client.failover.proxy.provider.cluster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre> \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  \t<span class=\"token comment\">&lt;!-- 一旦需要 NameNode 切换，使用 ssh 方式进行操作 --></span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.ha.fencing.methods<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>sshfence(root:9431)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>  \t<span class=\"token comment\">&lt;!-- 如果使用 ssh 进行故障切换，使用 ssh 通信时用的密钥存储的位置 --></span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.ha.fencing.ssh.private-key-files<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>  \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/root/.ssh/id_rsa<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- connect-timeout 超时时间 --></span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.ha.fencing.ssh.connect-timeout<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>30000<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>   \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.name.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>   \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/data/hadoop/tmp/dfs/name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>   \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>   \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>   \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.data.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>   \t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/data/hadoop/tmp/dfs/data<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>   \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"yarn-sitexml\"><a class=\"anchor\" href=\"#yarn-sitexml\">#</a> yarn-site.xml</h5>\n<p>修改 yarn-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 启用 Resource Manager HA 高可用性 --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.ha.enabled<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 resourcemanager 的名字 --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.cluster-id<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>yrc<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 使用了 2 个 resourcemanager, 分别指定 Resourcemanager 的地址 --></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.ha.rm-ids<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>rm1,rm2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 rm1 的地址 --></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.hostname.rm1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node01<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 rm2 的地址  --></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.hostname.rm2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node02<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 zookeeper 集群机器 --></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.zk-address<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>node01:2181,node02:2181,node03:2181<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- NodeManager 上运行的附属服务，默认是 mapreduce_shuffle --></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.nodemanager.aux-services<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>mapreduce_shuffle<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"mapred-sitexml\"><a class=\"anchor\" href=\"#mapred-sitexml\">#</a> mapred-site.xml</h5>\n<p>修改 mapred-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 采用 yarn 作为 mapreduce 的资源调度框架 --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>mapreduce.framework.name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>yarn<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"hadoop-envsh\"><a class=\"anchor\" href=\"#hadoop-envsh\">#</a> <span class=\"exturl\" data-url=\"aHR0cDovL2hhZG9vcC1lbnYuc2g=\">hadoop-env.sh</span>、<span class=\"exturl\" data-url=\"aHR0cDovL21hcHJlZC1lbnYuc2g=\">mapred-env.sh</span></h5>\n<p>然后，<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1oYWRvb3AtZW52LXl1NnA1NHIwbmE1NjF0LnNo\">分别修改 hadoop-env.sh</span>、mapred-env.sh 文件，添加 Java 环境变量</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2hhZG9vcC1lbnYuc2g=\">hadoop-env.sh</span></p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># The java implementation to use.</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export JAVA_HOME=/usr/local/src/jdk1.8.0_271</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre># 指定hadoop相关的pid存放位置</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>export HADOOP_PID_DIR=/usr/local/src/hadoop-/pids</pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cDovL21hcHJlZC1lbnYuc2g=\">mapred-env.sh</span></p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># The java implementation to use.</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export JAVA_HOME=/usr/local/src/jdk1.8.0_271</pre></td></tr></table></figure><h5 id=\"配置hadoop环境变量\"><a class=\"anchor\" href=\"#配置hadoop环境变量\">#</a> 配置 hadoop 环境变量</h5>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#vi /etc/profile.d/hadoop.sh</span></pre></td></tr></table></figure><figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export HADOOP_HOME=/usr/local/src/hadoop-2.6.0</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export LD_LIBRARY_PATH=$HADOOP_HOME/lib/native</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>export HADOOP_COMMON_LIB_NATIVE_DIR=/usr/local/src/hadoop-2.6.0/lib/native</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>export HADOOP_OPTS=\"-Djava.library.path=/usr/local/src/hadoop-2.6.0/lib\"</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>export PATH=$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH</pre></td></tr></table></figure><figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#source /etc/profile.d/hadoop.sh</span></pre></td></tr></table></figure><p>修改集群配置文件 slaves（没有则新建）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#vi slaves</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>node01</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>node02</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>node03</pre></td></tr></table></figure><p>最后创建需要的相关目录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#mkdir -p data/hadoop</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#cd data/hadoop</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#mkdir journaldata</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#mkdir -p tmp/dfs/name</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop]</span><span class=\"token comment\">#mkdir -p tmp/dfs/data</span></pre></td></tr></table></figure><h4 id=\"3-拷贝复制到其它机器\"><a class=\"anchor\" href=\"#3-拷贝复制到其它机器\">#</a> 3、拷贝复制到其它机器</h4>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r hadoop-2.6.0 node02:$PWD</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r hadoop-2.6.0 node03:$PWD</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r /etc/profile root@node02:/etc/profile</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r /etc/profile root@node03:/etc/profile</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r /etc/profile.d/hadoop.sh root@node02:/etc/profile.d/hadoop.sh</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token namespace\">[root@node01 src]</span><span class=\"token comment\">#scp -r /etc/profile.d/hadoop.sh root@node03:/etc/profile.d/hadoop.sh</span></pre></td></tr></table></figure><p>生效环境变量</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop]</span><span class=\"token comment\">#source /etc/profile.d/hadoop.sh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop]</span><span class=\"token comment\">#source /etc/profile.d/hadoop.sh</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token namespace\">[root@node02 /]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@node03 /]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><h4 id=\"4-启动hadoop\"><a class=\"anchor\" href=\"#4-启动hadoop\">#</a> 4、启动 hadoop</h4>\n<h5 id=\"执行格式化操作\"><a class=\"anchor\" href=\"#执行格式化操作\">#</a> 执行格式化操作</h5>\n<p>1、启动 journalnode，三台机器都要这一步操作（仅第一次启动 hadoop 时，需要这一步操作，之后不再需要手动启动 journalnode）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 ~]</span><span class=\"token comment\">#cd /usr/local/src/hadoop-2.6.0/sbin</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 sbin]</span><span class=\"token comment\">#sh hadoop-daemon.sh start journalnode</span></pre></td></tr></table></figure><p>2、在 node01 上执行格式化操作，格式化 namenode 和 zkfc</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#hdfs namenode -format</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#hdfs zkfc -formatZK</span></pre></td></tr></table></figure><p>3、namenode 主从信息同步，在 node02 节点上执行同步命令</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#bin/hdfs namenode -bootstrapStandby</span></pre></td></tr></table></figure><p>上述步骤完成后，接下来我们就可以启动 hadoop 了</p>\n<h5 id=\"启动命令\"><a class=\"anchor\" href=\"#启动命令\">#</a> 启动命令</h5>\n<p>在 node01 机器上执行下面的命令</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/start-all.sh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/hadoop-daemon.sh start zkfc</span></pre></td></tr></table></figure><p>在 node02 机器上执行下面的命令</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/yarn-daemon.sh start resourcemanager</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/hadoop-daemon.sh start zkfc</span></pre></td></tr></table></figure><h5 id=\"停止命令\"><a class=\"anchor\" href=\"#停止命令\">#</a> 停止命令</h5>\n<p>在 node01 机器上执行下面的命令</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/stop-all.sh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/hadoop-daemon.sh stop zkfc</span></pre></td></tr></table></figure><p>在 node02 机器上执行下面的命令</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/yarn-daemon.sh stop resourcemanager</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop-2.6.0]</span><span class=\"token comment\">#sbin/hadoop-daemon.sh stop zkfc</span></pre></td></tr></table></figure><h5 id=\"查看每台节点的进程\"><a class=\"anchor\" href=\"#查看每台节点的进程\">#</a> 查看每台节点的进程</h5>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01 hadoop-2.6.0]</span><span class=\"token comment\">#jps</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> NodeManager</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> QuorumPeerMain</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> DFSZKFailoverController</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> DataNode</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> JournalNode</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> NameNode</pre></td></tr><tr><td data-num=\"8\"></td><td><pre> ResourceManager</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token namespace\">[root@node02 hadoop-2.6.0]</span><span class=\"token comment\">#jps</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> JournalNode</pre></td></tr><tr><td data-num=\"12\"></td><td><pre> NameNode</pre></td></tr><tr><td data-num=\"13\"></td><td><pre> QuorumPeerMain</pre></td></tr><tr><td data-num=\"14\"></td><td><pre> DFSZKFailoverController</pre></td></tr><tr><td data-num=\"15\"></td><td><pre> ResourceManager</pre></td></tr><tr><td data-num=\"16\"></td><td><pre> DataNode</pre></td></tr><tr><td data-num=\"17\"></td><td><pre> NodeManager</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token namespace\">[root@node03 hadoop-2.6.0]</span><span class=\"token comment\">#jps</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre> QuorumPeerMain</pre></td></tr><tr><td data-num=\"21\"></td><td><pre> NodeManager</pre></td></tr><tr><td data-num=\"22\"></td><td><pre> DataNode</pre></td></tr><tr><td data-num=\"23\"></td><td><pre> JournalNode</pre></td></tr></table></figure><h2 id=\"3-通过web界面查看hadoop信息\"><a class=\"anchor\" href=\"#3-通过web界面查看hadoop信息\">#</a> 3、通过 Web 界面查看 hadoop 信息</h2>\n<p>1、浏览器访问 http://192.168.2.131:50070\t(active 节点，即 namenode 主节点)</p>\n<p>2、浏览器访问 http://192.168.2.132:50070\t(standby 节点，即 namenode 备节点)</p>\n<p>3、查看 yarn 的 web 控制台，浏览器访问 http://192.168.2.131:8088</p>\n<h2 id=\"4-测试namenode高可用\"><a class=\"anchor\" href=\"#4-测试namenode高可用\">#</a> 4、测试 namenode 高可用</h2>\n<p>1、在 node01 上 kill 掉 namenode 进程，然后通过浏览器查看 node02 的状态，发现状态变为 active，说明高可用测试成功</p>\n<p>2、重新启动 node01 的 namenode 进程，sh <span class=\"exturl\" data-url=\"aHR0cDovL3N0YXJ0LWRmcy5zaA==\">start-dfs.sh</span>, 浏览器访问 node01，此时 node01 的状态为 standby</p>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/25/Platform-construction/Hadoop/course-2/HDFS%E7%9A%84API%E6%93%8D%E4%BD%9C/",
            "url": "https://methiony.work/2020/11/25/Platform-construction/Hadoop/course-2/HDFS%E7%9A%84API%E6%93%8D%E4%BD%9C/",
            "title": "HDFS的API操作",
            "date_published": "2020-11-25T13:00:10.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/25/Platform-construction/Hadoop/course-2/HDFS%E7%9A%84%E6%96%87%E4%BB%B6%E5%8F%8A%E5%85%83%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/",
            "url": "https://methiony.work/2020/11/25/Platform-construction/Hadoop/course-2/HDFS%E7%9A%84%E6%96%87%E4%BB%B6%E5%8F%8A%E5%85%83%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/",
            "title": "HDFS的文件及元数据管理",
            "date_published": "2020-11-25T10:55:15.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hdfs的文件及元数据管理\"><a class=\"anchor\" href=\"#hdfs的文件及元数据管理\">#</a> HDFS 的文件及元数据管理</h1>\n<h2 id=\"1-hdfs的文件操作过程\"><a class=\"anchor\" href=\"#1-hdfs的文件操作过程\">#</a> 1、HDFS 的文件操作过程</h2>\n<h3 id=\"文件写入过程\"><a class=\"anchor\" href=\"#文件写入过程\">#</a> 文件写入过程</h3>\n<p><img data-src=\"hdfs%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E8%BF%87%E7%A8%8B.png\" alt=\"屏幕截图 2020-11-25 191055\" /></p>\n<p>1、 client 发起文件上传请求，通过 RPC 与 NameNode 建立通讯，NameNode 检查目标文件是否已存在，父目录是否存在，返回是否可以上传；<br />\n2、 client 请求第一个 block 该传输到哪些 DataNode 服务器上；<br />\n3、 NameNode 根据配置文件中指定的备份数量及机架感知原理进行文件分配，返回可用的 DataNode 的地址如：A，B，C；<br />\n注：Hadoop 在设计时考虑到数据的安全与高效，数据文件默认在 HDFS 上存放三份，存储策略为本地一份，同机架内其它某一节点上一份，不同机架的某一节点上一份。<br />\n4、 client 请求 3 台 DataNode 中的一台 A 上传数据（本质上是一个 RPC 调用，建立 pipeline），A 收到请求会继续调用 B，然后 B 调用 C，将整个 pipeline 建立完成，后逐级返回 client；<br />\n5、 client 开始往 A 上传第一个 block（先从磁盘读取数据放到一个本地内存缓存），以 packet 为单位（默认 64K），A 收到一个 packet 就会传给 B，B 传给 C；A 每传一个 packet 会放入一个应答队列等待应答。<br />\n6、 数据被分割成一个个 packet 数据包在 pipeline 上依次传输，在 pipeline 反方向上，逐个发送 ack（命令正确应答），最终由 pipeline 中第一个 DataNode 节点 A 将 pipelineack 发送给 client;<br />\n7、 当一个 block 传输完成之后，client 再次请求 NameNode 上传第二个 block 到服务器。</p>\n<h3 id=\"文件读取过程\"><a class=\"anchor\" href=\"#文件读取过程\">#</a> 文件读取过程</h3>\n<p><img data-src=\"C:%5CUsers%5CMethiony%5CPictures%5Chdfs%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96.png\" alt=\"hdfs文件读取\" /></p>\n<p>1、 Client 向 NameNode 发起 RPC 请求，来确定请求文件 block 所在的位置；<br />\n2、 NameNode 会视情况返回文件的部分或者全部 block 列表，对于每个 block，NameNode 都会返回含有该 block 副本的 DataNode 地址； 这些返回的 DN 地址，会按照集群拓扑结构得出 DataNode 与客户端的距离，然后进行排序，排序两个规则：网络拓扑结构中距离 Client 近的排靠前；心跳机制中超时汇报的 DN 状态为 STALE，这样的排靠后；<br />\n3、 Client 选取排序靠前的 DataNode 来读取 block，如果客户端本身就是 DataNode, 那么将从本地直接获取数据 (短路读取特性)；<br />\n4、 底层上本质是建立 Socket Stream（FSDataInputStream），重复的调用父类 DataInputStream 的 read 方法，直到这个块上的数据读取完毕；<br />\n5、 当读完列表的 block 后，若文件读取还没有结束，客户端会继续向 NameNode 获取下一批的 block 列表；<br />\n6、 读取完一个 block 都会进行 checksum 验证，如果读取 DataNode 时出现错误，客户端会通知 NameNode，然后再从下一个拥有该 block 副本的 DataNode 继续读。<br />\n7、 read 方法是并行的读取 block 信息，不是一块一块的读取；NameNode 只是返回 Client 请求包含块的 DataNode 地址，并不是返回请求块的数据；<br />\n8、 最终读取来所有的 block 会合并成一个完整的最终文件。</p>\n<h2 id=\"2-hdfs的元数据管理\"><a class=\"anchor\" href=\"#2-hdfs的元数据管理\">#</a> 2、HDFS 的元数据管理</h2>\n<p>在 Hadoop 集群中，NameNode 所有元数据信息保存在 Fslmage 和 Eidts 文件中，元数据信息的保存目录在 hdfs-site.xml 中配置</p>\n<p>fsimage：NameNode 中元数据的镜像，存放了一份比较完整的元数据信息</p>\n<p>edits：存放客户端最近一段时间的操作日志</p>\n<p>SecondaryNameNode 辅助管理 fsimage 和 edits 文件</p>\n<h3 id=\"fsimage中的文件信息查看\"><a class=\"anchor\" href=\"#fsimage中的文件信息查看\">#</a> fsimage 中的文件信息查看</h3>\n<p>使用 hdfs oiv</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cd <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>namenodeDatas<span class=\"token operator\">/</span>current<span class=\"token operator\">/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hdfs oiv <span class=\"token operator\">-</span>i fsimage_0000000000000000010</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">-</span>p XML <span class=\"token operator\">-</span>o my_fsimage<span class=\"token punctuation\">.</span>xml</pre></td></tr></table></figure><h3 id=\"edits中的文件信息查看\"><a class=\"anchor\" href=\"#edits中的文件信息查看\">#</a> edits 中的文件信息查看</h3>\n<p>使用 hdfs oev</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cd <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>nn<span class=\"token operator\">/</span>edits<span class=\"token operator\">/</span>current<span class=\"token operator\">/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hdfs oev <span class=\"token operator\">-</span>i edits_0000000000000000001<span class=\"token operator\">-</span>0000000000000000009</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">-</span>p XML <span class=\"token operator\">-</span>o myedit<span class=\"token punctuation\">.</span>xml</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/24/Platform-construction/Hadoop/course-2/Hadoop%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/",
            "url": "https://methiony.work/2020/11/24/Platform-construction/Hadoop/course-2/Hadoop%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/",
            "title": "Hadoop基本介绍及相关知识",
            "date_published": "2020-11-24T03:28:23.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hadoop的介绍及相关知识\"><a class=\"anchor\" href=\"#hadoop的介绍及相关知识\">#</a> Hadoop 的介绍及相关知识</h1>\n<p>狭义上，Hadoop 就是单独指代 Hadoop 这个软件</p>\n<p>HDFS：分布式文件系统</p>\n<p>MapReduce：分布式计算系统</p>\n<p>Yarn：分布式样集群资源管理</p>\n<p>广义上，Hadoop 指代大数据的一个生态圈，包括其他</p>\n<h2 id=\"1-hadoop核心-hdfs\"><a class=\"anchor\" href=\"#1-hadoop核心-hdfs\">#</a> 1、Hadoop 核心 - HDFS</h2>\n<h3 id=\"1-介绍\"><a class=\"anchor\" href=\"#1-介绍\">#</a> 1、介绍：</h3>\n<p>大量数据跨机器存储，统一管理分布在集群上的文件系统，也就是分布式文件系统</p>\n<h3 id=\"2-架构\"><a class=\"anchor\" href=\"#2-架构\">#</a> 2、架构</h3>\n<p>HDFS 是一个主 / 从（Mater/Slave）体系结构</p>\n<p>HDFS 由四部分组成，HDFS Client、NameNode、DataNode 和 Secondary NameNode</p>\n<h3 id=\"3-namenode作用\"><a class=\"anchor\" href=\"#3-namenode作用\">#</a> 3、NameNode 作用</h3>\n<p>NameNode 在内存中保存着整个文件系统的名称空间和文件数据块的地址映射，整个 HDFS 可存储的文件受限于 NameNode 的内存大小</p>\n<p>1、NameNode 元数据信息：文件名，文件目录结构，文件属性，每个文件的块列表，列表中块于块所在 DataNode 之间的地址映射关系；内存加载文件系统中文件于数据块的引用关系，会定期保存到本地磁盘（fsimage 文件和 edits 文件）</p>\n<p>2、NameNode 文件操作：负责文件元数据的操作，Datanode 负责文件的读写请求，数据流不经过 NameNode，但会询问于 datanode 的联系</p>\n<p>3、Namenode 副本：文件数据块由 NameNode 决定放在某个 DataNode 上，根据全局情况放置副本决定</p>\n<p>4、心跳机制：NameNode 与 DataNode 之间存在心跳信息，NameNode 周期性接收心跳和块的状态报告信息，若接收到信息，则认为正常，反之，对已经宕机的 datanode 上的数据块重新复制</p>\n<h3 id=\"4-datanode作用\"><a class=\"anchor\" href=\"#4-datanode作用\">#</a> 4、Datanode 作用</h3>\n<p>提供真实文件数据的存储服务</p>\n<p>1、Data Node 以数据块的形式存储 HDFS 文件</p>\n<p>2、响应 HDFS 客户端读写请求</p>\n<p>3、周期性向 NameNode 汇报心跳、数据块、缓存数据块信息</p>\n<h3 id=\"5-hdfs的副本机制和机架感知\"><a class=\"anchor\" href=\"#5-hdfs的副本机制和机架感知\">#</a> 5、HDFS 的副本机制和机架感知</h3>\n<p>副本机制：所有文件都以 block 块的方式存放在 HDFS 文件系统当中</p>\n<p>机架感知：把文件切分成副本放在不同机架中，保证数据容错能力</p>\n<h3 id=\"6-hdfs的命令行使用\"><a class=\"anchor\" href=\"#6-hdfs的命令行使用\">#</a> 6、HDFS 的命令行使用</h3>\n<h4 id=\"基础命令\"><a class=\"anchor\" href=\"#基础命令\">#</a> 基础命令</h4>\n<table>\n<thead>\n<tr>\n<th>序号</th>\n<th>命令</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>-help</td>\n<td>输出这个命令参数</td>\n</tr>\n<tr>\n<td>2</td>\n<td>-ls</td>\n<td>显示目录信息</td>\n</tr>\n<tr>\n<td>3</td>\n<td>-mkdir</td>\n<td>在 HDFS 上创建目录</td>\n</tr>\n<tr>\n<td>4</td>\n<td>-moveFromLocal</td>\n<td>从本地剪切粘贴到 HDFS</td>\n</tr>\n<tr>\n<td>5</td>\n<td>-appendToFile</td>\n<td>追加一个文件到已经存在的文件末尾</td>\n</tr>\n<tr>\n<td>6</td>\n<td>-cat</td>\n<td>显示文件内容</td>\n</tr>\n<tr>\n<td>7</td>\n<td>-chgrp 、-chmod、-chown</td>\n<td>Linux 文件系统中的用法一样，修改文件所属权限</td>\n</tr>\n<tr>\n<td>8</td>\n<td>-copyFromLocal</td>\n<td>从本地文件系统中拷贝文件到 HDFS 路径去</td>\n</tr>\n<tr>\n<td>9</td>\n<td>-copyToLocal</td>\n<td>从 HDFS 拷贝到本地</td>\n</tr>\n<tr>\n<td>10</td>\n<td>-cp</td>\n<td>从 HDFS 的一个路径拷贝到 HDFS 的另一个路径</td>\n</tr>\n<tr>\n<td>11</td>\n<td>-mv</td>\n<td>在 HDFS 目录中移动文件</td>\n</tr>\n<tr>\n<td>12</td>\n<td>-get</td>\n<td>等同于 copyToLocal，就是从 HDFS 下载文件到本地</td>\n</tr>\n<tr>\n<td>13</td>\n<td>-getmerge</td>\n<td>合并下载多个文件</td>\n</tr>\n<tr>\n<td>14</td>\n<td>-put</td>\n<td>等同于 copyFromLocal</td>\n</tr>\n<tr>\n<td>15</td>\n<td>-tail</td>\n<td>显示一个文件的末尾</td>\n</tr>\n<tr>\n<td>16</td>\n<td>-rm</td>\n<td>删除文件或文件夹</td>\n</tr>\n<tr>\n<td>17</td>\n<td>-rmdir</td>\n<td>删除空目录</td>\n</tr>\n<tr>\n<td>18</td>\n<td>-du</td>\n<td>统计文件夹的大小信息</td>\n</tr>\n<tr>\n<td>19</td>\n<td>-setrep</td>\n<td>设置 HDFS 中文件的副本数量</td>\n</tr>\n<tr>\n<td>20</td>\n<td>- expunge</td>\n<td>清空 HDFS 垃圾桶</td>\n</tr>\n</tbody>\n</table>\n<p>格式：</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfs 命令行 path</pre></td></tr></table></figure><h4 id=\"高级命令\"><a class=\"anchor\" href=\"#高级命令\">#</a> 高级命令</h4>\n<h5 id=\"1-hdfs的文件限额配置\"><a class=\"anchor\" href=\"#1-hdfs的文件限额配置\">#</a> 1、HDFS 的文件限额配置</h5>\n<p>HDFS 的配额指定针对的是目录，而非账号，可以让每个账号仅操作某一个目录，然后对目录进行配置</p>\n<p>HDFS 限额配置允许以文件大小、文件个数来限制我们在某个目录下上传文件数量或文件内容总量</p>\n<p>查看配额信息，path 指代文件路径</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfs <span class=\"token operator\">-</span>count <span class=\"token operator\">-</span>q <span class=\"token operator\">-</span>h path</pre></td></tr></table></figure><h6 id=\"数量限额\"><a class=\"anchor\" href=\"#数量限额\">#</a> 数量限额</h6>\n<p>设置最大上传文件个数为 2, 注意自身也包括一个，所以只能上传一个</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>setQuota 2 path</pre></td></tr></table></figure><p>清楚文件数量限额配置</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>clrQuota path</pre></td></tr></table></figure><h6 id=\"空间大小限额\"><a class=\"anchor\" href=\"#空间大小限额\">#</a> 空间大小限额</h6>\n<p>设置空间配额时，设置空间大小至少为 block_size*3 大小</p>\n<p>限制空间大小为 4kb</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>setSpaceQuota 4k path</pre></td></tr></table></figure><p>生成任意大小文件命令</p>\n<p>生成一个 2M 的文件（bs*count）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dd <span class=\"token keyword\">if</span>=<span class=\"token operator\">/</span>dev<span class=\"token operator\">/</span>zero of=1<span class=\"token punctuation\">.</span>txt bs=2M count=1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>dd <span class=\"token keyword\">if</span>=<span class=\"token operator\">/</span>dev<span class=\"token operator\">/</span>zero of=1<span class=\"token punctuation\">.</span>txt bs=1M count=2</pre></td></tr></table></figure><p>清除配置</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>clrSpaceQuota path</pre></td></tr></table></figure><h5 id=\"2-hdfs的安全模式\"><a class=\"anchor\" href=\"#2-hdfs的安全模式\">#</a> 2、hdfs 的安全模式</h5>\n<p>安全模式是 Hadoop 的一种保护机制，用于保证集群中的数据块的安全性</p>\n<p>在安全模式状态下，文件系统只接受读数据请求，而不接受删除、修改等变更请求当整个系统达到安全标准，hdfs 自动离开安全模式</p>\n<p>安全模式操作命令</p>\n<p>查看安全模式状态</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>safemode get</pre></td></tr></table></figure><p>进入安全模式</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>safemode enter</pre></td></tr></table></figure><p>离开安全模式</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfsadmin <span class=\"token operator\">-</span>safemode leave</pre></td></tr></table></figure><h2 id=\"2-hdfs的基准测试\"><a class=\"anchor\" href=\"#2-hdfs的基准测试\">#</a> 2、Hdfs 的基准测试</h2>\n<p>1、测试写入速度</p>\n<p>向 HDFS 文件系统中写入数据，10 个文件，每个文件 10MB，文件存放到 /benchmarks/TestDFSIO 中</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hadoop jar <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>share<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">/</span>mapreduce<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>mapreduce<span class=\"token operator\">-</span>client<span class=\"token operator\">-</span>jobclient<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token punctuation\">.</span>jar  TestDFSIO <span class=\"token operator\">-</span><span class=\"token function\">write</span> <span class=\"token operator\">-</span>nrFiles 10 <span class=\"token operator\">-</span>fileSize 10MB</pre></td></tr></table></figure><p>完成之后查看写入速度结果</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfs <span class=\"token operator\">-</span>text <span class=\"token operator\">/</span>benchmarks<span class=\"token operator\">/</span>TestDFSIO<span class=\"token operator\">/</span>io_write<span class=\"token operator\">/</span>part<span class=\"token operator\">-</span>00000</pre></td></tr></table></figure><p>2、测试读取速度</p>\n<p>测试 hdfs 的读取文件性能，在 hdfs 文件系统中读入 10 个文件，每个 10MB</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hadoop jar <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>share<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">/</span>mapreduce<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>mapreduce<span class=\"token operator\">-</span>client<span class=\"token operator\">-</span>jobclient<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token punctuation\">.</span>jar  TestDFSIO <span class=\"token operator\">-</span>read <span class=\"token operator\">-</span>nrFiles 10 <span class=\"token operator\">-</span>fileSize 10MB</pre></td></tr></table></figure><p>查看读取结果</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hdfs dfs <span class=\"token operator\">-</span>text <span class=\"token operator\">/</span>benchmarks<span class=\"token operator\">/</span>TestDFSIO<span class=\"token operator\">/</span>io_write<span class=\"token operator\">/</span>part<span class=\"token operator\">-</span>00000</pre></td></tr></table></figure><p>3、清楚测试数据</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hadoop jar <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>share<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">/</span>mapreduce<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>mapreduce<span class=\"token operator\">-</span>client<span class=\"token operator\">-</span>jobclient<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token punctuation\">.</span>jar  TestDFSIO <span class=\"token operator\">-</span>clean</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E7%9A%84API%E6%93%8D%E4%BD%9C/",
            "url": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E7%9A%84API%E6%93%8D%E4%BD%9C/",
            "title": "Zookeeper的API操作",
            "date_published": "2020-11-23T11:33:46.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记和习题整理<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"zookeeper的javaapi操作\"><a class=\"anchor\" href=\"#zookeeper的javaapi操作\">#</a> Zookeeper 的 javaAPI 操作</h1>\n<p>这里操作 Zookeeper 的 JavaAPI 使用的是 Zookeeper 客户端框架 Curator</p>\n<p>Curator 包含：</p>\n<p>curator-framework：对 zookeeper 的底层 api 的一些封装</p>\n<p>curator-recipes：封装了一些高级特性，如：Cache 事件监听、选举、分布式锁、分布式计数器等</p>\n<h2 id=\"1-创建java工程导入jar包\"><a class=\"anchor\" href=\"#1-创建java工程导入jar包\">#</a> 1、创建 Java 工程，导入 jar 包</h2>\n<p>创建 maven Java 工程，导入 jar 包</p>\n<h3 id=\"添加porn文件\"><a class=\"anchor\" href=\"#添加porn文件\">#</a> 添加 Porn 文件</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependencies<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>curator<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>curator<span class=\"token operator\">-</span>framework<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span><span class=\"token number\">2.12</span><span class=\"token number\">.0</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>curator<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>curator<span class=\"token operator\">-</span>recipes<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span><span class=\"token number\">2.12</span><span class=\"token number\">.0</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>com<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>collections<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>google<span class=\"token operator\">-</span>collections<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span><span class=\"token number\">1.0</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>junit<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>junit<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span>RELEASE<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>org<span class=\"token punctuation\">.</span>slf4j<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>slf4j<span class=\"token operator\">-</span>simple<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span><span class=\"token number\">1.7</span><span class=\"token number\">.25</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependencies<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>build<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>plugins<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>plugin<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">></span></span>org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>maven<span class=\"token punctuation\">.</span>plugins<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">></span></span>maven<span class=\"token operator\">-</span>compiler<span class=\"token operator\">-</span>plugin<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">></span></span><span class=\"token number\">3.2</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>configuration<span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>source<span class=\"token punctuation\">></span></span><span class=\"token number\">1.8</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>source<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>target<span class=\"token punctuation\">></span></span><span class=\"token number\">1.8</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>target<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>encoding<span class=\"token punctuation\">></span></span>UTF<span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>encoding<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>configuration<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>plugin<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>plugins<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>build<span class=\"token operator\">></span></pre></td></tr></table></figure><p>在 Java 工程的 src 目录下创建一个 Java 类</p>\n<h2 id=\"2-创建永久节点\"><a class=\"anchor\" href=\"#2-创建永久节点\">#</a> 2、创建永久节点</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">createZnode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 创建节点</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">creatingParentsIfNeeded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">withMode</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CreateMode</span><span class=\"token punctuation\">.</span>PERSISTENT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello2\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"world\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 关闭客户端</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"3-创建临时节点\"><a class=\"anchor\" href=\"#3-创建临时节点\">#</a> 3、创建临时节点</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">createtmpZnode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 创建节点</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">creatingParentsIfNeeded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">withMode</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CreateMode</span><span class=\"token punctuation\">.</span>EPHEMERAL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello3\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"world\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 休眠时间 5s</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">// 关闭客户端</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"4-修改节点数据\"><a class=\"anchor\" href=\"#4-修改节点数据\">#</a> 4、修改节点数据</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setZnodeData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 修改节点数据</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            client<span class=\"token punctuation\">.</span><span class=\"token function\">setData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"zookeeper\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">// 关闭客户端</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"5-查看节点数据\"><a class=\"anchor\" href=\"#5-查看节点数据\">#</a> 5、查看节点数据</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">getZnodeData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 获取节点数据</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> bytes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            bytes <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token comment\">// 关闭客户端</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"6-删除节点\"><a class=\"anchor\" href=\"#6-删除节点\">#</a> 6、删除节点</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">delZnode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 删除节点</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            client<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">// 关闭客户端</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"7-设置watch机制\"><a class=\"anchor\" href=\"#7-设置watch机制\">#</a> 7、设置 watch 机制</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">watchZnode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 定制一个重试策略</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">RetryPolicy</span> retryPolicy <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 获取一个客户端对象</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> connectionStr <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.2.128:2181,192.168.2.129:2181,192.168.2.130:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> client <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">newClient</span><span class=\"token punctuation\">(</span>connectionStr<span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> retryPolicy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 开启客户端</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        client<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 设置节点的 cache, 指定监控的节点</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token class-name\">TreeCache</span> treeCache <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TreeCache</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 自定义一个监听器</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        treeCache<span class=\"token punctuation\">.</span><span class=\"token function\">getListenable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">TreeCacheListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">childEvent</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CuratorFramework</span> curatorFramework<span class=\"token punctuation\">,</span> <span class=\"token class-name\">TreeCacheEvent</span> treeCacheEvent<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token class-name\">ChildData</span> data <span class=\"token operator\">=</span> treeCacheEvent<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>data <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>treeCacheEvent<span class=\"token punctuation\">.</span><span class=\"token function\">getType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                        <span class=\"token keyword\">case</span> NODE_ADDED<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"监控到有新增节点\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                        <span class=\"token keyword\">case</span> NODE_REMOVED<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"监控到节点被移除\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                        <span class=\"token keyword\">case</span> NODE_UPDATED<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"监控到节点被更新\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token comment\">// 开始监听</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            treeCache<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token comment\">// 设置延时</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">500000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E7%9A%84watch%E6%9C%BA%E5%88%B6/",
            "url": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E7%9A%84watch%E6%9C%BA%E5%88%B6/",
            "title": "Zookeeper的watch和选举机制",
            "date_published": "2020-11-23T10:50:38.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记和习题整理<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"zookeeper的watch和选举机制\"><a class=\"anchor\" href=\"#zookeeper的watch和选举机制\">#</a> Zookeeper 的 watch 和选举机制</h1>\n<h2 id=\"1-选举机制\"><a class=\"anchor\" href=\"#1-选举机制\">#</a> 1、选举机制</h2>\n<p>半数机制：集群中半数以上机器存活，集群可用。所以 zookeeper 适合安装奇数台服务器。Zookeeper 工作时，是有一个节点为 Leader，其他则为 Follower，Leader 是通过内部的选举机制临时产生的。</p>\n<p>假设有五台服务器组成的 Zookeeper 集群，它们的 id 为 1-5，没有历史数据，在存放数据量这一点上，都是一样的。假设这些服务器依序启动，它们之间会通过选举机制选出 Leader</p>\n<h3 id=\"过程详解\"><a class=\"anchor\" href=\"#过程详解\">#</a> 过程详解：</h3>\n<p><em>服务器 1 启动</em>，发起一次选举。服务器 1 投自己一票。此时服务器 1, 票数一票，不够半数以上（3 票），选举无法完成，服务器 1 状态保持为 LOOKING；</p>\n<p><em>服务器 2 启动</em>，再发起一次选举。服务器 1 和 2 分别投自己一票并交换选票信息：此时服务器 1 发现服务器 2 的 ID 比自己目前投票推举的（服务器 1）大，更改选票为推举服务器 2。此时服务器 1 票数 0 票，服务器 2 票数 2 票，没有半数以上结果，选举无法完成，服务器 1，2 状态保持 LOOKING</p>\n<p><em>服务器 3 启动</em>，发起一次选举。此时服务器 1 和 2 都会更改选票为服务器 3。此次投票结果：服务器 1 为 0 票，服务器 2 为 0 票，服务器 3 为 3 票。此时服务器 3 的票数已经超过半数，服务器 3 当选 Leader。服务器 1，2 更改状态为 FOLLOWING，服务器 3 更改状态为 LEADING；</p>\n<p><em>服务器 4 启动</em>，发起一次选举。此时服务器 1，2，3 已经不是 LOOKING 状态，不会更改选票信息。交换选票信息结果：服务器 3 为 3 票，服务器 4 为 1 票。此时服务器 4 服从多数，更改选票信息为服务器 3，并更改状态为 FOLLOWING；</p>\n<p><em>服务器 5 启动</em>，同服务器 4 一样。</p>\n<h2 id=\"1-watch机制\"><a class=\"anchor\" href=\"#1-watch机制\">#</a> 1、watch 机制</h2>\n<p>类似于数据库中的触发器，对某个 Znode 设置 Watcher, 当 Znode 发生变化的时候，WatchManager 会调用对应的 Watcher</p>\n<p>当 Znode 发生删除、修改、创建，子节点发生改变的时候，对应的 Watcher 会得到通知</p>\n<h3 id=\"watcher的特点\"><a class=\"anchor\" href=\"#watcher的特点\">#</a> watcher 的特点</h3>\n<p><strong>一次性触发</strong>：一个 watcher 只会被触发一次，如果需要继续监听，则需要再次添加 watcher</p>\n<p><strong>事件封装</strong>：watcher 得到的事件是被封装过的，包括三个内容 keeperState,evenType,path</p>\n<h4 id=\"常见的监听\"><a class=\"anchor\" href=\"#常见的监听\">#</a> 常见的监听：</h4>\n<p>监听节点数据的变化： <code>get path [watch]</code></p>\n<p>监听子节点增减的变化： <code>ls path [watch]</code></p>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
            "url": "https://methiony.work/2020/11/23/Platform-construction/Zookeeper/course-1/Zookeeper%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
            "title": "Zookeeper基础知识",
            "date_published": "2020-11-23T06:50:40.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记和习题整理<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"zookeeper基础知识\"><a class=\"anchor\" href=\"#zookeeper基础知识\">#</a> Zookeeper 基础知识</h1>\n<h2 id=\"1-zookeepr的数据类型\"><a class=\"anchor\" href=\"#1-zookeepr的数据类型\">#</a> 1、zookeepr 的数据类型</h2>\n<h3 id=\"与标准文件系统相同之处\"><a class=\"anchor\" href=\"#与标准文件系统相同之处\">#</a> 与标准文件系统相同之处</h3>\n<p>Zookeeper 的数据类型，在结构上拥有一个层次的命名空间，和标准文件系统非常相似，都是采用树形层次结构</p>\n<p>Zookeeper 树中的每个节点称为一个 Znode, 每个节点可以拥有子节点</p>\n<h3 id=\"与标准文件系统不同之处\"><a class=\"anchor\" href=\"#与标准文件系统不同之处\">#</a> 与标准文件系统不同之处</h3>\n<p>Znode 具有文件和目录两种特点。既有文件的数据功能，又有目录作为路径标识的功能，并可以具有子 Znode。znode 具有增、删、改、查等操作</p>\n<p>Znode 存储数据大小有限制。它用来管理调度数据，数据通常以 kb 为单位，数据大小至多 1M，通常小于此值</p>\n<p>Znode 通过路径引用，且为绝对路径，因此为 &quot;/&quot; 开头</p>\n<p>Znode 由 3 部分组成。stat: 状态信息，描述版本、权限等信息\tdata：与该 znode 关联的数据\tchildren：该 znode 下的子节点</p>\n<h2 id=\"znode节点类型\"><a class=\"anchor\" href=\"#znode节点类型\">#</a> Znode 节点类型</h2>\n<p>节点类型在创建时被确定，不能改变</p>\n<p>1、临时节点：在使用期间存在，会话结束后自动删除。不允许拥有子节点</p>\n<p>2、永久节点：只能手动删除，允许拥有子节点</p>\n<p>3、节点具有序列化特性，如果在创建时指定，该 znode 后面会自动追加一个 10 位数字的序列号</p>\n<p>四种类型的 Znode 节点</p>\n<table>\n<thead>\n<tr>\n<th>PERSISTENT:</th>\n<th>永久节点</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>EPHEMERAL:</td>\n<td>临时节点</td>\n</tr>\n<tr>\n<td>PERSISTENT_SEQUENTIAL</td>\n<td>永久节点、序列化</td>\n</tr>\n<tr>\n<td>EPHEMERAL_SEQUENTIAL</td>\n<td>临时节点、序列化</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"zookeeper的shell客户端操作\"><a class=\"anchor\" href=\"#zookeeper的shell客户端操作\">#</a> Zookeeper 的 Shell 客户端操作</h2>\n<h3 id=\"登录zookeeper客户端\"><a class=\"anchor\" href=\"#登录zookeeper客户端\">#</a> 登录 Zookeeper 客户端</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bin<span class=\"token operator\">/</span>zkCli<span class=\"token punctuation\">.</span>sh <span class=\"token operator\">-</span>server master:2181</pre></td></tr></table></figure><h3 id=\"操作实例\"><a class=\"anchor\" href=\"#操作实例\">#</a> 操作实例</h3>\n<p>列出 Path 下的所有 Znode</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token operator\">/</span></pre></td></tr></table></figure><p>创建永久节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">/</span>hello world</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>create <span class=\"token operator\">/</span>hello<span class=\"token operator\">/</span>hello1 world</pre></td></tr></table></figure><p>创建临时节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">-</span>e <span class=\"token operator\">/</span>hello world</pre></td></tr></table></figure><p>创建永久序列化节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">-</span>s <span class=\"token operator\">/</span>hello world</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>create <span class=\"token operator\">-</span>s <span class=\"token operator\">/</span>hello<span class=\"token operator\">/</span>hello1 world</pre></td></tr></table></figure><p>创建临时序列化节点</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token operator\">-</span>e <span class=\"token operator\">-</span>s <span class=\"token operator\">/</span>hello world</pre></td></tr></table></figure><p>修改节点数据</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">set</span> <span class=\"token operator\">/</span>hello zookeeper</pre></td></tr></table></figure><p>删除节点，如果有子 znode 则该命令无效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>delete <span class=\"token operator\">/</span>hello</pre></td></tr></table></figure><p>删除节点，如果有子 znode 则递归删除</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>rmr <span class=\"token operator\">/</span>hello</pre></td></tr></table></figure><p>列出历史记录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>histroy</pre></td></tr></table></figure><h3 id=\"操作命令\"><a class=\"anchor\" href=\"#操作命令\">#</a> 操作命令</h3>\n<p>path: 指 / Znode、data:znode 数据、acl: 权限、watch: 观察</p>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>说明</th>\n<th>参数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>create [-s] [-e] path data acl</td>\n<td>创建 znode</td>\n<td>-s 指顺序节点，-e 指临时节点</td>\n</tr>\n<tr>\n<td>ls  path  [watch]</td>\n<td>列出 path 下所有子 znode</td>\n<td></td>\n</tr>\n<tr>\n<td>get  path  [watch]</td>\n<td>获取 path 对应的 znode 的数据和属性</td>\n<td></td>\n</tr>\n<tr>\n<td>ls2  path  [watch]</td>\n<td>查看 path 所有子 znode 和子 znode 属性</td>\n<td></td>\n</tr>\n<tr>\n<td>set  path  data</td>\n<td>更新节点</td>\n<td></td>\n</tr>\n<tr>\n<td>delete  path</td>\n<td>删除节点，如果有子 znode 则该命令无效</td>\n<td></td>\n</tr>\n<tr>\n<td>rmr  path</td>\n<td>删除节点，如果有子 znode 则递归删除</td>\n<td></td>\n</tr>\n<tr>\n<td>setquota  -n|-b  val  path</td>\n<td>修改 znode 配额</td>\n<td>-n 设置子节点最大个数，-b 设置节点数据最大长度</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"节点属性\"><a class=\"anchor\" href=\"#节点属性\">#</a> 节点属性</h3>\n<p><img data-src=\"%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7.png\" alt=\"\" /></p>\n<p>cZxid:znode 创建的事务 id</p>\n<p>ctime: 节点创建时的时间戳</p>\n<p>mZxid:Znode 被修改的事务 id, 每次对 znode 的修改都会更新 mZxid, 可以确定更新操作的顺序，如果 zxid1 小于 zxid2，说明 zxid1 操作先于 zxid2 发生，zxid 对于整个 zookeeper 都是唯一的</p>\n<p>mtime: 节点最新一次更新发生时的时间戳</p>\n<p>cversion: 子节点的版本号。当 znode 子节点有变化时，值会增加 1</p>\n<p>dataVersion: 数据版本号，每次对节点进行 set 操作，值会增加 1，避免了数据更新的顺序问题</p>\n<p>aclVersion:ACL 的版本号</p>\n<p>ephemeralOwner: 如果节点为临时节点，ephemeralOwner 值表示与该节点绑定的 session id。如果不是，ephemeralOwner 值为 0</p>\n<h2 id=\"\"><a class=\"anchor\" href=\"#\">#</a> </h2>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/21/Platform-construction/Hadoop/course-2/Hadoop%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/",
            "url": "https://methiony.work/2020/11/21/Platform-construction/Hadoop/course-2/Hadoop%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/",
            "title": "Hadoop分布式集群搭建",
            "date_published": "2020-11-21T11:19:50.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"hadoop分布式集群搭建\"><a class=\"anchor\" href=\"#hadoop分布式集群搭建\">#</a> Hadoop 分布式集群搭建</h1>\n<h2 id=\"1-环境准备\"><a class=\"anchor\" href=\"#1-环境准备\">#</a> 1、环境准备</h2>\n<p>首先准备了三台虚拟机（为了避免环境的干扰，都是新建的虚拟机），分别分配了 1G 内存、20G 硬盘、2 核 CPU，然后安装了 CentOS-7-x86_64-DVD-2009 操作系统，并配置了静态 IP 地址。</p>\n<p><strong>集群规划：</strong></p>\n<p>搭建的是 NameNode 与 ResourceManager 单节点架构。节点具体分别如下：</p>\n<table>\n<thead>\n<tr>\n<th>服务器名称</th>\n<th>IP 地址</th>\n<th>NameNode</th>\n<th>SecondaryNameNode</th>\n<th>dataNode</th>\n<th>ResourceManager</th>\n<th>NodeManager</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>master</td>\n<td>192.168.2.128</td>\n<td>是</td>\n<td>是</td>\n<td>是</td>\n<td>是</td>\n<td>是</td>\n</tr>\n<tr>\n<td>node01</td>\n<td>192.168.2.129</td>\n<td>否</td>\n<td>否</td>\n<td>是</td>\n<td>否</td>\n<td>是</td>\n</tr>\n<tr>\n<td>node02</td>\n<td>192.168.2.130</td>\n<td>否</td>\n<td>否</td>\n<td>是</td>\n<td>否</td>\n<td>是</td>\n</tr>\n</tbody>\n</table>\n<p><strong>文件系统核心模块：</strong><br />\nNameNode：集群当中的主节点，主要用于管理集群当中的各种数据<br />\n secondaryNameNode：主要能用于 hadoop 当中元数据信息的辅助管理<br />\n DataNode：集群当中的从节点，主要用于存储集群当中的各种数据<br />\n<strong>数据计算核心模块：</strong><br />\nResourceManager：接收用户的计算请求任务，并负责集群的资源分配<br />\n NodeManager：负责执行主节点 APPmaster 分配的任务</p>\n<h2 id=\"2-环境配置\"><a class=\"anchor\" href=\"#2-环境配置\">#</a> 2、环境配置</h2>\n<p>1、关闭防火墙</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token comment\"># systemctl stop firewalld.service </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#关闭防火墙</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token comment\"># systemctl disable firewalld.service </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#禁止开机启动</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># firewall-cmd --state </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#查看防火墙状态</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>not running</pre></td></tr></table></figure><p>2、设置主机名称</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#在 192.168.2.128 机器上执行 * </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># hostnamectl set-hostname  master</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token comment\">#在 192.168.2.129 机器上执行 * </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># hostnamectl set-hostname node01</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token comment\">#在 192.168.2.130 机器上执行 * </span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token operator\">*</span><span class=\"token comment\"># hostnamectl set-hostname node02</span></pre></td></tr></table></figure><p>3、三台虚拟机重启</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#在 192.168.2.128 机器上执行 * </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token comment\">#在 192.168.2.129 机器上执行 * </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token comment\">#在 192.168.2.130 机器上执行 * </span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token namespace\">[root@localhost ~]</span><span class=\"token comment\"># reboot</span></pre></td></tr></table></figure><p>4、关闭 selinux</p>\n<p>进入到 /etc/selinux/config 文件，将 SELINUX=enforcing 改为 SELINUX=disabled。</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master ~]</span><span class=\"token comment\">#  vi  /etc/selinux/config</span></pre></td></tr></table></figure><p>5、设置免密登录</p>\n<p>首先在 master 主机上使用 ssh-keygen 命令来生成秘钥，一路按回车键</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@master~<span class=\"token punctuation\">]</span><span class=\"token comment\">#ssh-keygen -t rsa</span></pre></td></tr></table></figure><p>通过 ssh-copy-id 命令设置免密钥登录<br />\n其中，master、node01、node02 表示需要设置免密登录的服务器地址。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ssh-copy-id -i ~/.ssh/id_rsa.pub root@master</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ssh-copy-id -i ~/.ssh/id_rsa.pub root@node01</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ssh-copy-id -i ~/.ssh/id_rsa.pub root@node02</pre></td></tr></table></figure><p>其他机器也必须进行设置</p>\n<h2 id=\"3-安装jdk\"><a class=\"anchor\" href=\"#3-安装jdk\">#</a> 3、安装 JDK</h2>\n<p>在 master 中新建目录 /opt/bigdata/, 此目录下存放 hadoop 大数据所需要的环境包 (jdk 和 hadoop).</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#mkdir /opt/bigdata</span></pre></td></tr></table></figure><p>1、把下载好的 jdk-8u271-linux-x64.tar.gz 包和 hadoop-3.1.4.tar.gz 上传至 master 主机中，JDK 是安装 Hadoop 的基础环境，所以需要优先安装好 JDK 环境</p>\n<p>2、解压 jdk 并复制到 /opt/bigdata 目录下</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#tar -zxvf jdk-8u271-linux-x64.tar.gz -C</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata</pre></td></tr></table></figure><p>3、配置环境变量 (/etc/profile)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#vi /etc/profile</span></pre></td></tr></table></figure><p>添加</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export JAVA_HOME=<span class=\"token operator\">/</span>export<span class=\"token operator\">/</span>servers<span class=\"token operator\">/</span>jdk1<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0_271 </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export PATH=:<span class=\"token variable\">$JAVA_HOME</span><span class=\"token operator\">/</span>bin:<span class=\"token variable\">$PATH</span></pre></td></tr></table></figure><p>执行下面命令，让环境变量生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><p>验证 jdk 安装是否成功</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#java -version</span></pre></td></tr></table></figure><h2 id=\"4-安装hadoop\"><a class=\"anchor\" href=\"#4-安装hadoop\">#</a> 4、安装 hadoop</h2>\n<p>1、解压 hadoop，并把解压文件复制到 /opt/bigdata 目录中</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#tar -zxvf hadoop-3.1.4.tar.gz -C /opt/bigdata</span></pre></td></tr></table></figure><p>2、配置环境变量 (/etc/profile)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#vi /etc/profile</span></pre></td></tr></table></figure><p>添加</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export HADOOP_HOME=<span class=\"token operator\">/</span>export<span class=\"token operator\">/</span>servers<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export PATH=:<span class=\"token variable\">$HADOOP_HOME</span><span class=\"token operator\">/</span>bin:<span class=\"token variable\">$HADOOP_HOME</span><span class=\"token operator\">/</span>sbin:<span class=\"token variable\">$PATH</span></pre></td></tr></table></figure><p>执行下面命令，让环境变量生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><p>3、修改 hadoop 的配置文件</p>\n<p>进入需改文件的目录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#cd /opt/bigdata/hadoop-3.1.4/etc/hadoop</span></pre></td></tr></table></figure><p>需要修改的文件</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>core<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\thadoop<span class=\"token operator\">-</span>env<span class=\"token punctuation\">.</span>sh\thdfs<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\t</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mapred<span class=\"token operator\">-</span>env<span class=\"token punctuation\">.</span>sh\tmapred<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml\tyarn<span class=\"token operator\">-</span>site<span class=\"token punctuation\">.</span>xml</pre></td></tr></table></figure><p>首先，修改 core-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span> \t</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!--  指定集群的文件系统类型：分布式文件系统 --></span> \t</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span> \t\t</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>fs.default.name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span> \t\t</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 因为前面已经配置了服务器名称映射 IP，所以这里可以使用服务器名称进行配置 --></span> \t\t</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>hdfs://master:8020<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span> \t</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token comment\">&lt;!--  指定临时文件存储目录 --></span> \t</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>hadoop.tmp.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span> \t\t\t\t\t     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>/opt/bigdata/hadoop3.1.4/hadoopDatas/tempDatas<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span> \t</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">&lt;!--  缓冲区大小，实际工作中根据服务器性能动态调整 --></span> \t</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span> \t\t</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>io.file.buffer.size<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span> \t\t</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>4096<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span> \t</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span>  \t</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">&lt;!--  开启 hdfs 的垃圾桶机制，删除掉的数据可以从垃圾桶中回收，单位分钟 --></span> \t</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span> </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>fs.trash.interval<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span> </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>10080<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span> \t</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span> </pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>其次，修改 hdfs-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.secondary.http-address<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>master:50090<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 namenode 的访问地址和端口 --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.http-address<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>master:50070<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 namenode 元数据的存放位置 --></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.name.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/namenodeDatas,file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/namenodeDatas2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">&lt;!--  定义 dataNode 数据存储的节点位置，实际工作中，一般先确定磁盘的挂载目录，然后多个目录用，进行分割  --></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.datanode.data.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/datanodeDatas,file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/datanodeDatas2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 指定 namenode 日志文件的存放目录 --></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.edits.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/nn/edits<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.checkpoint.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/snn/name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.namenode.checkpoint.edits.dir<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>file:///opt/bigdata/hadoop-3.1.4/hadoopDatas/dfs/snn/edits<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 文件切片的副本个数 --></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.replication<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置 HDFS 的文件权限 --></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.permissions<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置一个文件切片的大小：128M--></span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>dfs.blocksize<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>134217728<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>然后，修改 yarn-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 配置 yarn 主节点的位置 --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.resourcemanager.hostname<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>master<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.nodemanager.aux-services<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>mapreduce_shuffle<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 开启日志聚合功能 --></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.log-aggregation-enable<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置聚合日志在 hdfs 上的保存时间 --></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.log-aggregation.retain-seconds<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>604800<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置 yarn 集群的内存分配方案 --></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span>    </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.nodemanager.resource.memory-mb<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span>    </pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>20480<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        \t <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.scheduler.minimum-allocation-mb<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>         \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>2048<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>yarn.nodemanager.vmem-pmem-ratio<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>2.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>然后，修改 mapred-site.xml 文件，在 &lt;configuration&gt; 元素中添加相应的配置文件</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 开启 MapReduce 小任务模式 --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>mapreduce.job.ubertask.enable<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置历史任务的主机和端口 --></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>mapreduce.jobhistory.address<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>master:10020<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token comment\">&lt;!-- 设置网页访问历史任务的主机和端口 --></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>mapreduce.jobhistory.webapp.address<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>value</span><span class=\"token punctuation\">></span></span>master:19888<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>value</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>然后，<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1oYWRvb3AtZW52LXl1NnA1NHIwbmE1NjF0LnNo\">分别修改 hadoop-env.sh</span>、mapred-env.sh 文件</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master hadoop]</span><span class=\"token comment\">#vi hadoop-env.sh</span></pre></td></tr></table></figure><figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master hadoop]</span><span class=\"token comment\">#vi mapred-env.sh</span></pre></td></tr></table></figure><p>添加 Java 环境变量</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export JAVA_HOME=<span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>jdk1<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0_271</pre></td></tr></table></figure><p>最后，修改集群配置文件 slaves（没有则新建）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master hadoop]</span><span class=\"token comment\">#vi slaves</span></pre></td></tr></table></figure><p>添加</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>master</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>node01</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>node02</pre></td></tr></table></figure><p>4、创建 hadoop 需要的文件目录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>tempDatas</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>namenodeDatas</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>namenodeDatas2</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>datanodeDatas</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>datanodeDatas2 </pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>nn<span class=\"token operator\">/</span>edits</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>snn<span class=\"token operator\">/</span>name</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>mkdir <span class=\"token operator\">-</span>p <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span>hadoopDatas<span class=\"token operator\">/</span>dfs<span class=\"token operator\">/</span>snn<span class=\"token operator\">/</span>edits</pre></td></tr></table></figure><h2 id=\"5-分发jdk-hadoop到node01-node02\"><a class=\"anchor\" href=\"#5-分发jdk-hadoop到node01-node02\">#</a> 5、分发 jdk、hadoop 到 node01、node02</h2>\n<p>首先进入 jdk、hadoop 的安装目录</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master hadoop]</span><span class=\"token comment\">#cd /opt/bigdata</span></pre></td></tr></table></figure><p>然后分发 jdk，分别到 node01、node02</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>scp <span class=\"token operator\">-</span>r jdk1<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0_271 node01:<span class=\"token variable\">$PWD</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>scp <span class=\"token operator\">-</span>r jdk1<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0_271 node02:<span class=\"token variable\">$PWD</span></pre></td></tr></table></figure><p>分发 Hadoop，分别到 node01、node02</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>scp <span class=\"token operator\">-</span>r hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4 node01:<span class=\"token variable\">$PWD</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>scp <span class=\"token operator\">-</span>r hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4 node02:<span class=\"token variable\">$PWD</span></pre></td></tr></table></figure><p>分发 master 已经配置好的环境变量文件到 node01、node02 (需要进入到根目录)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>scp <span class=\"token operator\">-</span>r <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>profile root@node01:<span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>profile </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>scp <span class=\"token operator\">-</span>r <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>profile root@node02:<span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>profile</pre></td></tr></table></figure><p>执行下面命令，让环境变量生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01~]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02~]</span><span class=\"token comment\">#source/etc/profile</span></pre></td></tr></table></figure><p>检查是否生效</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@node01~]</span><span class=\"token comment\">#java -version</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@node02~]</span><span class=\"token comment\">#java -version</span></pre></td></tr></table></figure><h2 id=\"6-启动集群\"><a class=\"anchor\" href=\"#6-启动集群\">#</a> 6、启动集群</h2>\n<p>首先，在 master 主机进行格式化（首次需要执行）</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cd  <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>hadoop<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>4<span class=\"token operator\">/</span> <span class=\"token comment\">#首先进入 hadoop 根目录</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>bin<span class=\"token operator\">/</span>hdfs namenode <span class=\"token operator\">-</span>format <span class=\"token comment\">#执行格式化命令</span></pre></td></tr></table></figure><p>然后，启动 hdfs 集群</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sbin<span class=\"token operator\">/</span><span class=\"token function\">start-dfs</span><span class=\"token punctuation\">.</span>sh</pre></td></tr></table></figure><p>再启动 yarn 集群</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sbin<span class=\"token operator\">/</span><span class=\"token function\">start-yarn</span><span class=\"token punctuation\">.</span>sh</pre></td></tr></table></figure><p>最后，启动 historyserver，查看历史完成的任务</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sbin<span class=\"token operator\">/</span>mr<span class=\"token operator\">-</span>jobhistory<span class=\"token operator\">-</span>daemon<span class=\"token punctuation\">.</span>sh <span class=\"token function\">start</span> historyserver</pre></td></tr></table></figure><p>使用 jps 查看进程</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master~]</span><span class=\"token comment\">#jps</span></pre></td></tr></table></figure><h2 id=\"7-查看可视化界面验证启动是否成功\"><a class=\"anchor\" href=\"#7-查看可视化界面验证启动是否成功\">#</a> 7、查看可视化界面，验证启动是否成功</h2>\n<p>1、首先访问：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMi4xMjg6NTAwNzAvZXhwbG9yZXIuaHRtbCMvJUVGJUJDJThDJUU3JTk0JUE4JUU2JTlEJUE1JUU2JTlGJUE1JUU3JTlDJThCaGRmcw==\">http://192.168.2.128:50070/explorer.html#/，用来查看 hdfs</span></p>\n<p>2、然后访问：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMi4xMjg6ODA4OC9jbHVzdGVyJUVGJUJDJThDJUU2JTlGJUE1JUU3JTlDJThCeWFybiVFOSU5QiU4NiVFNyVCRSVBNA==\">http://192.168.2.128:8088/cluster，查看 yarn 集群</span></p>\n<p>3、最后访问：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMi4xMjg6MTk4ODgvam9iaGlzdG9yeSVFRiVCQyU4QyVFNiU5RiVBNSVFNyU5QyU4QiVFNSU4RSU4NiVFNSU4RiVCMiVFNSVBRSU4QyVFNiU4OCU5MCVFNyU5QSU4NCVFNCVCQiVCQiVFNSU4QSVBMQ==\">http://192.168.2.128:19888/jobhistory，查看历史完成的任务</span></p>\n<p>如果都有页面表示搭建成功！</p>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/21/Platform-construction/Zookeeper/course-1/Zookeeper%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/",
            "url": "https://methiony.work/2020/11/21/Platform-construction/Zookeeper/course-1/Zookeeper%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/",
            "title": "Zookeeper快速搭建",
            "date_published": "2020-11-21T09:40:19.000Z",
            "content_html": "<div class=\"note info\">\n<p>以下为个人学习笔记和习题整理<br />\n课程： 大数据自学教程 Hadoop 从零到精通完整版 @<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTg2Mzg5MDQ5\">黑马程序员大数据教程</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVrNHkxMTdZcQ==\"> https://www.bilibili.com/video/BV1ek4y117Yq</span></p>\n</div>\n<h1 id=\"zookeeper快速搭建\"><a class=\"anchor\" href=\"#zookeeper快速搭建\">#</a> ZooKeeper 快速搭建</h1>\n<h2 id=\"1-zookeeper的安装部署\"><a class=\"anchor\" href=\"#1-zookeeper的安装部署\">#</a> 1、Zookeeper 的安装部署</h2>\n<h3 id=\"拷贝zookeeper安装包到linux系统下\"><a class=\"anchor\" href=\"#拷贝zookeeper安装包到linux系统下\">#</a> 拷贝 Zookeeper 安装包到 Linux 系统下</h3>\n<h3 id=\"解压到指定目录\"><a class=\"anchor\" href=\"#解压到指定目录\">#</a> 解压到指定目录</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master]</span>$ tar <span class=\"token operator\">-</span>zxvf zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>2<span class=\"token punctuation\">.</span>tar<span class=\"token punctuation\">.</span>gz <span class=\"token operator\">-</span>C <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span></pre></td></tr></table></figure><h3 id=\"配置修改\"><a class=\"anchor\" href=\"#配置修改\">#</a> 配置修改</h3>\n<h4 id=\"optbigdatazookeeper-362conf这个路径下的zoo_samplecfg修改为zoocfg如果存在zoocfg文件则不需要拷贝zoo_samplecfg\"><a class=\"anchor\" href=\"#optbigdatazookeeper-362conf这个路径下的zoo_samplecfg修改为zoocfg如果存在zoocfg文件则不需要拷贝zoo_samplecfg\">#</a> /opt/bigdata/zookeeper-3.6.2/conf 这个路径下的 zoo_sample.cfg 修改为 zoo.cfg (如果存在 zoo.cfg 文件则不需要拷贝 zoo_sample.cfg)</h4>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master]</span>$ <span class=\"token function\">mv</span> zoo_sample<span class=\"token punctuation\">.</span>cfg zoo<span class=\"token punctuation\">.</span>cfg</pre></td></tr></table></figure><p>打开 zoo.cfg 文件，修改 dataDir 路径</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dataDir=<span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>2<span class=\"token operator\">/</span>zkData</pre></td></tr></table></figure><p>文件内容末尾添加内容</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>server<span class=\"token punctuation\">.</span>1=master:2888:3888</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>server<span class=\"token punctuation\">.</span>2=node1:2888:3888</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>server<span class=\"token punctuation\">.</span>3=node2:2888:3888</pre></td></tr></table></figure><p>在 /opt/bigdata/zookeeper-3.6.2 / 这个目录上创建 zkData 文件夹</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span>$ mkdir zkData</pre></td></tr></table></figure><p>在 /opt/bigdata/zookeeper-3.6.2/zkData 这个目录上创建 myid 文件</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zkData]</span>$ touch myid</pre></td></tr></table></figure><p>编辑 myid 文件 (其他机器上修改对应的 server 的数字)</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zkData]</span>$ vi myid</pre></td></tr></table></figure><pre><code>1\n</code></pre>\n<p>拷贝分发到 node1、node2</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master bigdata]</span>$ scp <span class=\"token operator\">-</span>r zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>2 node1:<span class=\"token variable\">$PWD</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token namespace\">[root@master bigdata]</span>$ scp <span class=\"token operator\">-</span>r zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>2 node2:<span class=\"token variable\">$PWD</span></pre></td></tr></table></figure><p>修改 myid 文件</p>\n<h2 id=\"2-zookeeper启动与操作\"><a class=\"anchor\" href=\"#2-zookeeper启动与操作\">#</a> 2、 Zookeeper 启动与操作</h2>\n<h3 id=\"启动zookeeper\"><a class=\"anchor\" href=\"#启动zookeeper\">#</a> 启动 Zookeeper</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token variable\">$bin</span><span class=\"token operator\">/</span>zkServer<span class=\"token punctuation\">.</span>sh <span class=\"token function\">start</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ZooKeeper JMX enabled by default</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">Using</span> config: <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>bigdata<span class=\"token operator\">/</span>zookeeper<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>2<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>conf<span class=\"token operator\">/</span>zoo<span class=\"token punctuation\">.</span>cfg</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Starting zookeeper <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> STARTED     <span class=\"token comment\"># 这时，一般就启动成功了</span></pre></td></tr></table></figure><h3 id=\"查看进程是否启动\"><a class=\"anchor\" href=\"#查看进程是否启动\">#</a> 查看进程是否启动</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token variable\">$jps</span></pre></td></tr></table></figure><h3 id=\"查看状态\"><a class=\"anchor\" href=\"#查看状态\">#</a> 查看状态</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token variable\">$bin</span><span class=\"token operator\">/</span>zkServer<span class=\"token punctuation\">.</span>sh status</pre></td></tr></table></figure><h3 id=\"启动客户端\"><a class=\"anchor\" href=\"#启动客户端\">#</a> 启动客户端</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token variable\">$bin</span><span class=\"token operator\">/</span>zkCli<span class=\"token punctuation\">.</span>sh</pre></td></tr></table></figure><h3 id=\"退出客户端\"><a class=\"anchor\" href=\"#退出客户端\">#</a> 退出客户端</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[zk: localhost:2181(CONNECTED) 0]</span> quit</pre></td></tr></table></figure><h3 id=\"停用zookeeper\"><a class=\"anchor\" href=\"#停用zookeeper\">#</a> 停用 Zookeeper</h3>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token namespace\">[root@master zookeeper-3.6.2]</span><span class=\"token variable\">$bin</span><span class=\"token operator\">/</span>zkServer<span class=\"token punctuation\">.</span>sh stop</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/19/Platform-construction/Hbase/Hbase/",
            "url": "https://methiony.work/2020/11/19/Platform-construction/Hbase/Hbase/",
            "title": "Hbase",
            "date_published": "2020-11-19T07:53:18.000Z",
            "content_html": "<h1 id=\"hbase基础系列1\"><a class=\"anchor\" href=\"#hbase基础系列1\">#</a> Hbase 基础系列（1）</h1>\n<h2 id=\"1-hbase定义\"><a class=\"anchor\" href=\"#1-hbase定义\">#</a> 1、 HBase 定义</h2>\n<p>HBase 是一种分布式、可扩展、支持海量数据存储的 NoSQL 数据库。</p>\n<h2 id=\"2-hbase特点\"><a class=\"anchor\" href=\"#2-hbase特点\">#</a> 2、HBase 特点</h2>\n<ul>\n<li>1. 海量存储</li>\n</ul>\n<p>Hbase 适合存储 PB 级别的海量数据，在 PB 级别的数据以及采用廉价 PC 存储的情况下，能在几十到百毫秒内返回数据。这与 Hbase 的极易扩展性息息相关。正式因为 Hbase 良好的扩展性，才为海量数据的存储提供了便利。</p>\n<ul>\n<li>2. 列式存储</li>\n</ul>\n<p>这里的列式存储其实说的是列族存储，Hbase 是根据列族来存储数据的。列族下面可以有非常多的列，列族在创建表的时候就必须指定。</p>\n<ul>\n<li>3. 极易扩展</li>\n</ul>\n<p>Hbase 的扩展性主要体现在两个方面，一个是基于上层处理能力（RegionServer）的扩展，一个是基于存储的扩展（HDFS）。<br />\n通过横向添加 RegionSever 的机器，进行水平扩展，提升 Hbase 上层的处理能力，提升 Hbsae 服务更多 Region 的能力。<br />\n  备注：RegionServer 的作用是管理 region、承接业务的访问，这个后面会详细的介绍通过横向添加 Datanode 的机器，进行存储层扩容，提升 Hbase 的数据存储能力和提升后端存储的读写能力。</p>\n<ul>\n<li>4. 高并发</li>\n</ul>\n<p>由于目前大部分使用 Hbase 的架构，都是采用的廉价 PC，因此单个 IO 的延迟其实并不小，一般在几十到上百 ms 之间。这里说的高并发，主要是在并发的情况下，Hbase 的单个 IO 延迟下降并不多。能获得高并发、低延迟的服务。</p>\n<ul>\n<li>5. 稀疏</li>\n</ul>\n<p>稀疏主要是针对 Hbase 列的灵活性，在列族中，你可以指定任意多的列，在列数据为空的情况下，是不会占用存储空间的。</p>\n<h2 id=\"3-hbase的数据模型\"><a class=\"anchor\" href=\"#3-hbase的数据模型\">#</a> 3、Hbase 的数据模型</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cDovLzEuTmFtZQ==\">1.Name</span> Space</li>\n</ul>\n<p>命名空间，类似于关系型数据库的 database 概念，每个命名空间下有多个表。HBase 两个自带的命名空间，分别是 hbase 和 default，hbase 中存放的是 HBase 内置的表，default 表是用户默认使用的命名空间。</p>\n<ul>\n<li>2.Table</li>\n</ul>\n<p>类似于关系型数据库的表概念。不同的是，HBase 定义表时只需要声明列族即可，不需要声明具体的列。这意味着，往 HBase 写入数据时，字段可以动态、按需指定。因此，和关系型数据库相比，HBase 能够轻松应对字段变更的场景。</p>\n<ul>\n<li>3.Row</li>\n</ul>\n<p>HBase 表中的每行数据都由一个 RowKey 和多个 Column（列）组成，数据是按照 RowKey 的字典顺序存储的，并且查询数据时只能根据 RowKey 进行检索，所以 RowKey 的设计十分重要。</p>\n<ul>\n<li>4.Column</li>\n</ul>\n<p>HBase 中的每个列都由 Column Family (列族) 和 Column Qualifier（列限定符）进行限定，例如 info：name，info：age。建表时，只需指明列族，而列限定符无需预先定义。</p>\n<ul>\n<li>5.Time Stamp</li>\n</ul>\n<p>用于标识数据的不同版本（version），每条数据写入时，系统会自动为其加上该字段，其值为写入 HBase 的时间。</p>\n<ul>\n<li>6.Cell</li>\n</ul>\n<p>由 {rowkey, column Family：column Qualifier, time Stamp} 唯一确定的单元。cell 中的数据是没有类型的，全部是字节码形式存贮。</p>\n<h2 id=\"4-hbase架构\"><a class=\"anchor\" href=\"#4-hbase架构\">#</a> 4、 HBase 架构</h2>\n<ul>\n<li>1.Client</li>\n</ul>\n<p>Client 包含了访问 Hbase 的接口，另外 Client 还维护了对应的 cache 来加速 Hbase 的访问，比如 cache 的.META. 元数据的信息。</p>\n<ul>\n<li>2.Zookeeper</li>\n</ul>\n<p>HBase 通过 Zookeeper 来做 master 的高可用、RegionServer 的监控、元数据的入口以及集群配置的维护等工作。具体工作如下：</p>\n<blockquote>\n<p>通过 Zoopkeeper 来保证集群中只有 1 个 master 在运行，如果 master 异常，会通过竞争机制产生新的 master 提供服务<br />\n通过 Zoopkeeper 来监控 RegionServer 的状态，当 RegionSevrer 有异常的时候，通过回调的形式通知 MasterRegionServer 上下线的信息<br />\n通过 Zoopkeeper 存储元数据的统一入口地址</p>\n</blockquote>\n<ul>\n<li>3.Hmaster</li>\n</ul>\n<p>master 节点的主要职责如下：</p>\n<blockquote>\n<p>为 RegionServer 分配 Region<br />\n 维护整个集群的负载均衡<br />\n维护集群的元数据信息<br />\n发现失效的 Region，并将失效的 Region 分配到正常的 RegionServer 上<br />\n当 RegionSever 失效的时候，协调对应 Hlog 的拆分</p>\n</blockquote>\n<ul>\n<li>4.HregionServer</li>\n</ul>\n<p>HregionServer 直接对接用户的读写请求，是真正的 “干活” 的节点。它的功能概括如下：</p>\n<blockquote>\n<p>管理 master 为其分配的 Region<br />\n 处理来自客户端的读写请求<br />\n负责和底层 HDFS 的交互，<br />\n存储数据到 HDFS<br />\n 负责 Region 变大以后的拆分<br />\n负责 Storefile 的合并工作</p>\n</blockquote>\n<ul>\n<li>5.HDFS</li>\n</ul>\n<p>HDFS 为 Hbase 提供最终的底层数据存储服务，同时为 HBase 提供高可用（Hlog 存储在 HDFS）的支持，具体功能概括如下：</p>\n<blockquote>\n<p>提供元数据和表数据的底层分布式存储服务<br />\n数据多副本，保证的高可靠和高可用性</p>\n</blockquote>\n<h2 id=\"5-hbase中的角色\"><a class=\"anchor\" href=\"#5-hbase中的角色\">#</a> 5、HBase 中的角色</h2>\n<h4 id=\"1-hmaster\"><a class=\"anchor\" href=\"#1-hmaster\">#</a> 1 HMaster</h4>\n<ul>\n<li>功能</li>\n<li>1．监控 RegionServer</li>\n<li>2．处理 RegionServer 故障转移</li>\n<li>3．处理元数据的变更</li>\n<li>4．处理 region 的分配或转移</li>\n<li>5．在空闲时间进行数据的负载均衡</li>\n<li>6．通过 Zookeeper 发布自己的位置给客户端</li>\n</ul>\n<h4 id=\"2-regionserver\"><a class=\"anchor\" href=\"#2-regionserver\">#</a> 2 RegionServer</h4>\n<ul>\n<li>功能</li>\n<li>1．负责存储 HBase 的实际数据</li>\n<li>2．处理分配给它的 Region</li>\n<li>3．刷新缓存到 HDFS</li>\n<li>4．维护 Hlog</li>\n<li>5．执行压缩</li>\n<li>6．负责处理 Region 分片</li>\n</ul>\n<h4 id=\"3-其他组件\"><a class=\"anchor\" href=\"#3-其他组件\">#</a> 3. 其他组件</h4>\n<ul>\n<li>1．Write-Ahead logs</li>\n</ul>\n<p>HBase 的修改记录，当对 HBase 读写数据的时候，数据不是直接写进磁盘，它会在内存中保留一段时间（时间以及数据量阈值可以设定）。但把数据保存在内存中可能有更高的概率引起数据丢失，为了解决这个问题，数据会先写在一个叫做 Write-Ahead logfile 的文件中，然后再写入内存中。所以在系统出现故障的时候，数据可以通过这个日志文件重建。</p>\n<ul>\n<li>2．Region</li>\n</ul>\n<p>Hbase 表的分片，HBase 表会根据 RowKey 值被切分成不同的 region 存储在 RegionServer 中，在一个 RegionServer 中可以有多个不同的 region。</p>\n<ul>\n<li>3．Store</li>\n</ul>\n<p>HFile 存储在 Store 中，一个 Store 对应 HBase 表中的一个列族。</p>\n<ul>\n<li>4．MemStore</li>\n</ul>\n<p>顾名思义，就是内存存储，位于内存中，用来保存当前的数据操作，所以当数据保存在 WAL 中之后，RegsionServer 会在内存中存储键值对。</p>\n<ul>\n<li>5．HFile</li>\n</ul>\n<p>这是在磁盘上保存原始数据的实际的物理文件，是实际的存储文件。StoreFile 是以 Hfile 的形式存储在 HDFS 的。</p>\n",
            "tags": []
        },
        {
            "id": "https://methiony.work/2020/11/15/MySQL/",
            "url": "https://methiony.work/2020/11/15/MySQL/",
            "title": "MySQL",
            "date_published": "2020-11-15T10:43:49.000Z",
            "content_html": "<h2 id=\"mysql服务的登录和退出\"><a class=\"anchor\" href=\"#mysql服务的登录和退出\">#</a> MySql 服务的登录和退出</h2>\n<p>​\t\t方式一：通过 mysql 自带的客户端：只限于 root 用户</p>\n<p>​\t\t方式二：通过 Windows 自带的客户端：1、登录：</p>\n<pre><code class=\"language-mysql\">mysql\t[-h主机名\t-p端口号]\t-u用户名\t-p 密码\n</code></pre>\n<p>​\t\t退出：</p>\n<pre><code class=\"language-mysql\">exit或ctrl + c\n</code></pre>\n<h2 id=\"mysql的常见命令\"><a class=\"anchor\" href=\"#mysql的常见命令\">#</a> MySql 的常见命令</h2>\n<p>​\t\t1、查看当前所有的数据库：</p>\n<pre><code class=\"language-mysql\">show\tdatabases;\n</code></pre>\n<p>​\t\t2、打开指定的库：</p>\n<pre><code class=\"language-mysql\">use\t库名\n</code></pre>\n<p>​\t\t3、查看当前库的所有表：</p>\n<pre><code class=\"language-mysql\">show\ttables;\n</code></pre>\n<p>​\t\t4、查看其他库的所有表：</p>\n<pre><code class=\"language-mysql\">show\ttables\tfrom\t库名;\n</code></pre>\n<p>​\t\t5、创建表：</p>\n<pre><code class=\"language-mysql\">create\ttable\t表名(\n\n​\t\t\t\t\t\t列名\t列类型,\n\n​\t\t\t\t\t\t列名\t列类型,\n\n​\t\t\t\t\t\t...\n\n​\t\t\t)\n</code></pre>\n<p>​\t\t6、查看表结构：</p>\n<pre><code class=\"language-mysql\">desc\t表名;\n</code></pre>\n<p>​\t\t7、查看服务器的版本</p>\n<p>​\t\t\t方式一、登录到 mysql 服务端:</p>\n<pre><code class=\"language-mysql\">select\tversion();\n</code></pre>\n<p>​\t\t\t方式二、没有登录到 mysql 服务端:</p>\n<pre><code class=\"language-mysql\">mysql\t--version或\tmysql\t--v\n</code></pre>\n<h3 id=\"进阶1基础查询\"><a class=\"anchor\" href=\"#进阶1基础查询\">#</a> 进阶 1：基础查询</h3>\n<p>语法：</p>\n<pre><code class=\"language-mysql\">select\t查询列表\tfrom\t表名;\n</code></pre>\n<p>特点：</p>\n<p>1、查询列表可以是：表中的字段、常量值、表达式、函数</p>\n<p>2、查询的结果是一个虚拟的表格</p>\n<p>a、查询表中的单个字段：</p>\n<pre><code class=\"language-mysql\">select\t查询列表\tfrom\t表名;\n</code></pre>\n<p>b、查询表中的多个字段：</p>\n<pre><code class=\"language-mysql\">select\t查询列表1,查询列表2,...\tfrom\t表名;\n</code></pre>\n<p>c、查询表中的所有字段：</p>\n<pre><code class=\"language-mysql\">select\t*\tfrom\t表名;\n</code></pre>\n<p>d、查询常量值：</p>\n<pre><code class=\"language-mysql\">select\t100;\tselect\t'john';\n</code></pre>\n<p>e、查询表达式：</p>\n<pre><code class=\"language-mysql\">select\t100%98;\n</code></pre>\n<p>f、查询函数：</p>\n<pre><code class=\"language-mysql\">select\tversion();\n</code></pre>\n<p>3、起别名：便于理解、如果查询的字段有重名的情况，使用别名区分</p>\n<p>a、使用 as</p>\n<pre><code class=\"language-mysql\">select\t100%98\tas\t结果;\n</code></pre>\n<pre><code class=\"language-mysql\">select\t查询列表1 as 别名,查询列表2 as 别名\tfrom\t表名;\n</code></pre>\n<p>b、使用空格</p>\n<pre><code class=\"language-mysql\">select\t查询列表1  别名,查询列表2  别名\tfrom\t表名;\n</code></pre>\n<p>4、去重</p>\n<pre><code class=\"language-mysql\">select\tdistinct\t查询列表\tfrom\t表名;\n</code></pre>\n<h3 id=\"进阶2条件查询\"><a class=\"anchor\" href=\"#进阶2条件查询\">#</a> 进阶 2：条件查询</h3>\n<p>语法：</p>\n<pre><code class=\"language-mysql\">select\t查询列表\tfrom\t表名\twhere\t筛选条件;\n</code></pre>\n<p>分类：</p>\n<p>一、按条件表达式筛选</p>\n<p>简单条件运算符：</p>\n<pre><code class=\"language-mysql\">&gt;\t&lt;\t=\t!=\t&lt;&gt;\t&gt;=\t&lt;=\n</code></pre>\n<p>二、按逻辑表达式筛选</p>\n<p>逻辑运算符：</p>\n<pre><code class=\"language-mysql\">&amp;&amp;\t||\t！\tand\tor\tnot\n</code></pre>\n<p>三、模糊查询</p>\n<pre><code class=\"language-mysql\">like\tbetween\tand\tin\tis\tnull\n</code></pre>\n<h2 id=\"mysql的语法规范\"><a class=\"anchor\" href=\"#mysql的语法规范\">#</a> Mysql 的语法规范</h2>\n<p>​\t\t\t1、不区分大小写，但建议关键词大写，表名、列名小写</p>\n<p>​\t\t\t2、每条命令最好用分号结尾</p>\n<p>​\t\t\t3、每条命令根据需要，可以进行缩进或换行</p>\n<p>​\t\t\t4、注释：a、单行注释：# 注释文字\tb、单行注释：-- 注释文字\tc、单行注释：/ *   注释文字   */</p>\n<p>​\t\t\t5、mysql 中的 + 号：只有作为运算符的功能</p>\n",
            "tags": []
        }
    ]
}